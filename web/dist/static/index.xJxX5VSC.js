var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,n=(e,n)=>{for(var i in n||(n={}))a.call(n,i)&&o(e,i,n[i]);if(l)for(var i of l(n))t.call(n,i)&&o(e,i,n[i]);return e};import{_ as i,d,A as r,i as s,e as u,M as c,j as p,k as m,l as f,U as g,u as y,m as h}from"./index.FQhv3U_5.js";import{r as _,ag as v,c as b,o as k,P as w,G as V,J as x,H as C,u as I,O as S,a6 as j,L,t as U,n as T,a as D,M as P,aq as M,I as R,h as F,W as E,C as O,k as B,a4 as $,V as q,i as G}from"./@vue.CQt2tj-6.js";import{P as H}from"./Pagination.8Er6hDxx.js";import{L as z}from"./dialog.Bsrh65Nu.js";import{l as N}from"./fileList.CCYZ4jbj.js";import{E as A,a as Y}from"./element-plus.C3E-FvSa.js";import"./crypto-js.BjUPrIIl.js";import"./js-cookie.Ch5AnFJE.js";import"./clipboard.BBhAuw9K.js";import{b as W}from"./batchOp.C8abNsmc.js";import{b as K}from"./vue-router.BmPBvlxi.js";import{l as J}from"./index.CLtx-Eae.js";import{_ as Z}from"./index.C8lU5NoS.js";import{s as Q}from"./softInfo.kcMLyEqL.js";import{l as X}from"./dialogTerminal.CVwBOSzI.js";import"./axios.BhTbhqQQ.js";import"./vue-clipboard3.c61pm64N.js";import"./pinia.CWB7oRTw.js";import"./@element-plus.CU4brdXH.js";import"./nprogress.Dzr5m2b3.js";import"./@xterm.C7qPmoRH.js";import"./pinia-plugin-persistedstate.DTf8V5gU.js";import"./destr.ZpApkS-1.js";import"./deep-pick-omit.DP_A4OSP.js";import"./lodash-es.CUM784Py.js";import"./@vueuse.7zPzjEtO.js";import"./@popperjs.DxP-MrnL.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.BpgH7LzR.js";import"./async-validator.BTKOuuO-.js";import"./memoize-one.Ds0C_khL.js";import"./normalize-wheel-es.BhHBPXsK.js";import"./@floating-ui.D1oRyyfp.js";import"./vue-codemirror.CkyLiK-7.js";import"./codemirror.Fbop2eii.js";import"./@codemirror.CIOe3mu6.js";import"./@lezer.CQ-BhAmV.js";import"./crelt.DSg10-ms.js";import"./@marijn.Df4efayV.js";import"./style-mod.Dj2YSJ7-.js";import"./w3c-keyname.f-y9tSbI.js";import"./index.BgdEdE50.js";const ee=i({__name:"moduleAdd",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=d(),o=a;let i=_(!1),u=_(!1),c=_("\u6dfb\u52a0\u7f51\u7ad9"),p=_({name:"",remark:"",path:t.sysConfig.wwwrootPath,group:0,type:0}),m=_([{id:0,name:"\u9ed8\u8ba4\u5206\u7ec4"}]),f=_(!1),g=_(null);let y=_({name:[{required:!0,trigger:"change",validator:function(e,l,a){const t=l.split("\n");let o=!0,n="";t.forEach(((e,l)=>{""!==e&&(function(e){return/^([\w\-\*]{1,150}\.){1,8}([\w\-]{1,30}|[\w\-]{1,30}\.[\w\-]{1,24})(?::\d{1,5})?$/.test(e)}(e)||function(e){return/^(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?::\d{1,5})?$/.test(e)}(e)||(o=!1,n=`\u7b2c${l+1}\u884c\u683c\u5f0f\u4e0d\u6b63\u786e: ${e}`))})),o?a():a(new Error(n))}}],path:[{required:!0,message:"\u8bf7\u9009\u62e9\u7f51\u7ad9\u6839\u76ee\u5f55",trigger:"blur"}],group:[{required:!0,message:"\u8bf7\u9009\u62e9\u7f51\u7ad9\u5206\u7ec4",trigger:"blur"}]});function h(){o("closed")}function D(e){const l=e.split("\n")[0];p.value.remark=l,p.value.path=l?t.sysConfig.wwwrootPath+"/"+l.replace(/:/g,"_"):t.sysConfig.wwwrootPath}function P(){f.value=!0,T((()=>{g.value.handleOpen({path:p.value.path,isDir:!0},"\u76ee\u5f55\u9009\u62e9")}))}function M(e){let l=s(e);p.value.path=l}let R=_(null);function F(){R.value.validate((e=>{if(e){u.value=!0;const e=p.value.name.split("\n");let l=n({},p.value);l.name=e[0].split(":")[0],l.domainList=e,l.action="save_static_site",r.sysGetSitesManage(l).then((e=>{u.value=!1,2e3==e.code?(A.success(e.msg),h(),o("refreshData")):A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){c.value=l,i.value=!0,r.sysSitegroup({page:1,limit:999}).then((e=>{2e3===e.code&&(m.value=e.data.data)}))}}),(e,l)=>{const a=v("el-input"),t=v("el-form-item"),o=v("el-button"),n=v("el-option"),d=v("el-select"),r=v("el-form");return k(),b("div",null,[w(z,{modelValue:I(i),"onUpdate:modelValue":l[4]||(l[4]=e=>U(i)?i.value=e:i=e),title:I(c),width:"680px","before-close":h},{footer:C((()=>[w(o,{onClick:h,loading:I(u)},{default:C((()=>l[6]||(l[6]=[L("\u53d6\u6d88")]))),_:1},8,["loading"]),w(o,{type:"primary",onClick:F,loading:I(u)},{default:C((()=>l[7]||(l[7]=[L("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:C((()=>[w(r,{inline:!1,model:I(p),rules:I(y),ref_key:"rulesForm",ref:R,"label-position":"right","label-width":"auto"},{default:C((()=>[w(t,{label:"\u57df\u540d\uff1a",prop:"name"},{default:C((()=>[w(a,{modelValue:I(p).name,"onUpdate:modelValue":l[0]||(l[0]=e=>I(p).name=e),autosize:{minRows:5,maxRows:8},type:"textarea",placeholder:"\u8bf7\u8f93\u5165\u7f51\u7ad9\u57df\u540d\uff0c\u652f\u6301\u591a\u4e2a\uff08\u57df\u540d\u3001IP)+\u7aef\u53e3\uff08\u9ed8\u8ba480\uff09\uff0c\u4e00\u884c\u4e00\u4e2a\n\u57df\u540d\u683c\u5f0f1\uff1awww.lybbn.cn\n\u57df\u540d\u683c\u5f0f2\uff1awww.lybbn.cn:8080\nIP\u683c\u5f0f\uff1a192.168.1.1:8080\n\u6cdb\u89e3\u6790\uff1a*.lybbn.cn",clearable:"",onInput:D},null,8,["modelValue"])])),_:1}),w(t,{label:"\u5907\u6ce8\uff1a",prop:"remark"},{default:C((()=>[w(a,{modelValue:I(p).remark,"onUpdate:modelValue":l[1]||(l[1]=e=>I(p).remark=e),placeholder:"\u5907\u6ce8",clearable:""},null,8,["modelValue"])])),_:1}),w(t,{label:"\u6839\u76ee\u5f55\uff1a",prop:"path"},{default:C((()=>[w(a,{modelValue:I(p).path,"onUpdate:modelValue":l[2]||(l[2]=e=>I(p).path=e),placeholder:"\u8bf7\u9009\u62e9\u7f51\u7ad9\u6839\u76ee\u5f55",class:"selectDirs"},{prepend:C((()=>[w(o,{onClick:P,icon:"Folder",type:"primary"})])),_:1},8,["modelValue"])])),_:1}),w(t,{label:"\u5206\u7ec4\uff1a",prop:"group"},{default:C((()=>[w(d,{modelValue:I(p).group,"onUpdate:modelValue":l[3]||(l[3]=e=>I(p).group=e),placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"},clearable:"",filterable:""},{default:C((()=>[(k(!0),b(S,null,j(I(m),(e=>(k(),V(n,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),I(f)?(k(),V(N,{key:0,ref_key:"chooseDirShowFlag",ref:g,onChange:M,onClosed:l[5]||(l[5]=e=>U(f)?f.value=!1:f=!1)},null,512)):x("",!0)])}}},[["__scopeId","data-v-440ec44c"]]),le={class:"handlegroupadd"},ae={key:1},te={style:{display:"flex","align-items":"center"}},oe=i({__name:"moduleGroup",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=a;let o=_(!1),n=_(!1),i=_(!1),d=_(""),s=_({name:"",is_default:!1}),u=_([]);function c(){t("closed")}function p(){n.value=!0,r.sysSitegroup({page:1,limit:999}).then((e=>{if(n.value=!1,2e3===e.code){let l=e.data.data;l.forEach((e=>{e.isEdit=!1})),u.value=l}}))}function m(){if(""==s.value.name)return void A.warning("\u8bf7\u586b\u5199\u7ad9\u70b9\u5206\u7ec4\u540d\u79f0");let e={name:s.value.name,is_default:!1};r.sysSitegroupAdd(e).then((e=>{i.value=!1,2e3==e.code?(A.success(e.msg),p(),s.value.name=""):A.warning(e.msg)}))}return l({handleOpen:function(e,l){d.value=l,o.value=!0,p()}}),(e,l)=>{const a=v("el-input"),t=v("el-button"),f=v("el-table-column"),g=v("el-table");return k(),b("div",null,[w(z,{modelValue:I(o),"onUpdate:modelValue":l[1]||(l[1]=e=>U(o)?o.value=e:o=e),title:I(d),width:"560px","before-close":c,loading:I(n)},{default:C((()=>[D("div",le,[w(a,{modelValue:I(s).name,"onUpdate:modelValue":l[0]||(l[0]=e=>I(s).name=e),clearable:"",placeholder:"\u8bf7\u586b\u5199\u7ad9\u70b9\u5206\u7ec4\u540d\u79f0"},null,8,["modelValue"]),w(t,{type:"primary",style:{"margin-left":"10px"},onClick:m,disabled:I(i)},{default:C((()=>l[2]||(l[2]=[L("\u6dfb\u52a0")]))),_:1},8,["disabled"])]),w(g,{border:"",data:I(u),height:"40vh"},{default:C((()=>[w(f,{prop:"name",label:"\u540d\u79f0","min-width":"200","show-overflow-tooltip":""},{default:C((e=>[e.row.isEdit?(k(),V(a,{key:0,modelValue:e.row.name,"onUpdate:modelValue":l=>e.row.name=l,clearable:""},null,8,["modelValue","onUpdate:modelValue"])):(k(),b("span",ae,P(e.row.name),1))])),_:1}),w(f,{label:"\u64cd\u4f5c",width:"100"},{default:C((e=>[D("div",te,[e.row.isEdit?x("",!0):(k(),V(t,{key:0,link:"",type:"primary",onClick:l=>{var a;(a=e.row).is_default?A.warning("\u9ed8\u8ba4\u5206\u7ec4\u7981\u6b62\u7f16\u8f91"):a.isEdit=!0}},{default:C((()=>l[3]||(l[3]=[L("\u7f16\u8f91")]))),_:2},1032,["onClick"])),e.row.isEdit?(k(),V(t,{key:1,link:"",type:"primary",onClick:l=>function(e){if(""==e.name)return void A.warning("\u8bf7\u586b\u5199\u7ad9\u70b9\u5206\u7ec4\u540d\u79f0");let l={id:e.id,name:e.name,is_default:!1};r.sysSitegroupEdit(l).then((e=>{i.value=!1,2e3==e.code?(A.success(e.msg),p()):A.warning(e.msg)}))}(e.row)},{default:C((()=>l[4]||(l[4]=[L("\u4fdd\u5b58")]))),_:2},1032,["onClick"])):x("",!0),e.row.isEdit?(k(),V(t,{key:2,link:"",type:"primary",onClick:l=>e.row.isEdit=!1},{default:C((()=>l[5]||(l[5]=[L("\u53d6\u6d88")]))),_:2},1032,["onClick"])):x("",!0),e.row.isEdit?x("",!0):(k(),V(t,{key:3,link:"",type:"primary",onClick:l=>{var a;(a=e.row).is_default?A.warning("\u9ed8\u8ba4\u5206\u7ec4\u7981\u6b62\u5220\u9664"):Y.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${a.name}\u3011\u64cd\u4f5c\u5417\uff1f`,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let l={id:a.id};r.sysSitegroupDelete(l).then((e=>{n.value=!1,2e3==e.code?(A.success(e.msg),p()):A.warning(e.msg)}))})).catch((()=>{}))}},{default:C((()=>l[6]||(l[6]=[L("\u5220\u9664")]))),_:2},1032,["onClick"]))])])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue","title","loading"])])}}},[["__scopeId","data-v-624b97c3"]]),ne={__name:"moduleEditEnd",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=d(),o=a;let n=_(!1),i=_(!1),u=_("\u521b\u5efa\u76ee\u5f55"),c=_({id:"",endTime:"",typechoice:1}),p=_([{required:!0,message:"\u8bf7\u9009\u62e9\u5230\u671f\u65f6\u95f4",trigger:"blur"}]);function m(){o("closed")}let f=_(null);function g(){f.value.validate((e=>{if(e){let e=null;1==c.value.typechoice&&(e=c.value.endTime),t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let l={action:"set_site_endtime",id:c.value.id,endTime:e};r.sysGetSitesManage(l).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),m(),o("refreshData")):A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){if(u.value=l,n.value=!0,e){let l=s(e);c.value.id=l.id,c.value.endTime=l.endTime,c.value.endTime||(c.value.typechoice=2)}}}),(e,l)=>{const a=v("el-radio-button"),t=v("el-radio-group"),o=v("el-form-item"),d=v("el-date-picker"),r=v("el-form"),s=v("el-button");return k(),b("div",null,[w(z,{modelValue:I(n),"onUpdate:modelValue":l[2]||(l[2]=e=>U(n)?n.value=e:n=e),title:I(u),width:"560px","before-close":m,showFullScreen:!1},{footer:C((()=>[w(s,{onClick:m,loading:I(i)},{default:C((()=>l[3]||(l[3]=[L("\u53d6\u6d88")]))),_:1},8,["loading"]),w(s,{type:"primary",onClick:g,loading:I(i)},{default:C((()=>l[4]||(l[4]=[L("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:C((()=>[w(r,{inline:!1,model:I(c),rules:e.rules,ref_key:"rulesForm",ref:f,"label-position":"right","label-width":"auto"},{default:C((()=>[w(o,{label:"\u5230\u671f\u7c7b\u578b\uff1a",required:""},{default:C((()=>[w(t,{modelValue:I(c).typechoice,"onUpdate:modelValue":l[0]||(l[0]=e=>I(c).typechoice=e)},{default:C((()=>[w(a,{label:"\u6307\u5b9a\u65f6\u95f4",value:1}),w(a,{label:"\u8bbe\u7f6e\u6c38\u4e45",value:2})])),_:1},8,["modelValue"])])),_:1}),1===I(c).typechoice?(k(),V(o,{key:0,label:"\u5230\u671f\u65f6\u95f4\uff1a",prop:"endTime",rules:1===I(c).typechoice?I(p):[]},{default:C((()=>[w(d,{style:{width:"100%"},modelValue:I(c).endTime,"onUpdate:modelValue":l[1]||(l[1]=e=>I(c).endTime=e),type:"datetime",placeholder:"\u8bf7\u9009\u62e9",format:"YYYY-MM-DD hh:mm:ss","value-format":"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue"])])),_:1},8,["rules"])):x("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},ie=i({__name:"moduleSetDefaultSite",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=d(),o=a;let n=_(!1),i=_(!1),s=_("\u8bbe\u7f6e\u9ed8\u8ba4\u7ad9\u70b9"),u=_({site_id:0}),c=_([]),p=_({site_id:[{required:!0,message:"\u8bf7\u9009\u62e9\u9ed8\u8ba4\u7ad9\u70b9",trigger:"blur"}]});function m(){o("closed")}let f=_(null);function g(){f.value.validate((e=>{if(e){1==u.value.typechoice&&u.value.endTime,t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_default",id:u.value.site_id};r.sysGetSitesManage(e).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),m(),o("refreshData")):A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){s.value=l,n.value=!0,function(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="";let e={module:0,page:1,limit:999};e.module=0,r.sysGetSitesList(e).then((e=>{t.loadingInfo.isLoading=!1,2e3===e.code&&(c.value=e.data.data,c.value.forEach((e=>{e.is_default&&(u.value.site_id=e.id)})))}))}()}}),(e,l)=>{const a=v("el-option"),t=v("el-select"),o=v("el-form-item"),d=v("el-form"),r=v("el-button");return k(),b("div",null,[w(z,{modelValue:I(n),"onUpdate:modelValue":l[1]||(l[1]=e=>U(n)?n.value=e:n=e),title:I(s),width:"560px","before-close":m,showFullScreen:!1},{footer:C((()=>[w(r,{onClick:m,loading:I(i)},{default:C((()=>l[3]||(l[3]=[L("\u53d6\u6d88")]))),_:1},8,["loading"]),w(r,{type:"primary",onClick:g,loading:I(i)},{default:C((()=>l[4]||(l[4]=[L("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:C((()=>[w(d,{inline:!1,model:I(u),rules:I(p),ref_key:"rulesForm",ref:f,"label-position":"right","label-width":"auto"},{default:C((()=>[w(o,{label:"\u9ed8\u8ba4\u7ad9\u70b9\uff1a",prop:"site_id"},{default:C((()=>[w(t,{modelValue:I(u).site_id,"onUpdate:modelValue":l[0]||(l[0]=e=>I(u).site_id=e),style:{width:"100%"}},{default:C((()=>[(k(),V(a,{value:0,key:-1,label:"\u4e0d\u8bbe\u7f6e\u7ad9\u70b9"})),(k(!0),b(S,null,j(I(c),((e,l)=>(k(),V(a,{key:l,value:e.id,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),l[2]||(l[2]=D("div",{class:"ry-cj-care"},[D("li",null,"\u8bbe\u7f6e\u9ed8\u8ba4\u7ad9\u70b9\u540e,\u6240\u6709\u672a\u7ed1\u5b9a\u7684\u57df\u540d\u548cIP\u90fd\u88ab\u5b9a\u5411\u5230\u9ed8\u8ba4\u7ad9\u70b9"),D("li",null,"\u53ef\u6709\u6548\u9632\u6b62\u6076\u610f\u89e3\u6790"),D("li",null,"\u4e0d\u8bbe\u7f6e\u65f6\u4e5f\u4f1a\u670980\u7aef\u53e3\u7684\u9ed8\u8ba4\u7ad9\u70b9")],-1))])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-5bcc75b6"]]),de={class:"lyBackupDialog"},re={key:3},se=i({__name:"moduleBackup",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=a;let o=_(!1);_(!1);let n=_("\u6570\u636e\u5e93\u5907\u4efd"),i=_(!1),d=_(!1),f=_(""),g=_({fid:"",type:2,page:1,limit:10}),y=_({page:1,limit:10,total:0}),h=_([]),x=_({});function S(){t("closed"),t("refreshData")}function j(e){g.value.page=e.page,g.value.limit=e.limit,D()}function D(){i.value=!0,r.sysBakBackUpList(g.value).then((e=>{i.value=!1,2e3==e.code?(h.value=e.data.data,y.value.page=e.data.page,y.value.limit=e.data.limit,y.value.total=e.data.total):p(e.msg)}))}function F(){d.value=!0,r.sysSitesBakMg({action:"backup_site",id:g.value.fid}).then((e=>{d.value=!1,2e3==e.code?(c(e.msg),D()):p(e.msg)}))}let E=_([]),O=_([]);function B(e){O.value=s(e),E.value=e.map((e=>e.id))}let $=_(null);function q(){T((()=>{$.value.handleOpen(null,"\u6279\u91cf\u5220\u9664\u5907\u4efd\u6587\u4ef6")}))}let G=_(0),N=_("0%"),K=_(!1),J=_(1),Z=_("");function Q(e){return new Promise((l=>setTimeout(l,e)))}function X(){return e=this,l=null,a=function*(){J.value=2,K.value=!0,O.value.forEach((e=>{e.status="wait"}));let e=O.value.length,l=0;for(let a=0;a<e;a++){G.value=a+1==e?100:parseInt((a+1)/e*100),N.value=G.value+"%";let t="del_backup_site",o={id:g.value.fid,bid:O.value[a].id,action:t};r.sysSitesBakMg(o).then((e=>{2e3==e.code?O.value[a].status="success":(O.value[a].status="error",l+=1)})),yield Q(1e3)}K.value=!1,J.value=3,Z.value=`\u6279\u91cf\u5220\u9664\u5907\u4efd\u6587\u4ef6\u5df2\u5b8c\u6210\uff0c\u5171${e}\u4e2a\u4efb\u52a1\uff0c\u6210\u529f${e-l}\u4e2a\uff0c\u5931\u8d25${l}\u4e2a!`},new Promise(((t,o)=>{var n=e=>{try{d(a.next(e))}catch(l){o(l)}},i=e=>{try{d(a.throw(e))}catch(l){o(l)}},d=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);d((a=a.apply(e,l)).next())}));var e,l,a}return l({handleOpen:function(e,l){n.value=l,o.value=!0,g.value.fid=e.id,f.value=e.db_name,D()}}),(e,l)=>{const a=v("el-button"),t=v("el-form-item"),s=v("el-form"),c=v("el-table-column"),p=v("el-table"),f=v("el-tag"),_=M("loading");return k(),b("div",de,[w(z,{modelValue:I(o),"onUpdate:modelValue":l[0]||(l[0]=e=>U(o)?o.value=e:o=e),title:I(n),width:"60%","before-close":S,loading:I(d)},{default:C((()=>[w(s,{inline:!1,model:I(g),rules:I(x),ref:"rulesForm","label-position":"right","label-width":"auto",disabled:I(d)},{default:C((()=>[w(t,null,{default:C((()=>[w(a,{type:"primary",onClick:F},{default:C((()=>l[1]||(l[1]=[L("\u5907\u4efd")]))),_:1}),w(a,{onClick:q,disabled:I(E).length<1},{default:C((()=>l[2]||(l[2]=[L("\u5220\u9664")]))),_:1},8,["disabled"])])),_:1})])),_:1},8,["model","rules","disabled"]),R((k(),V(p,{ref:"table",border:"",data:I(h),height:410,onSelectionChange:B},{default:C((()=>[w(c,{type:"selection",width:"55",align:"center"}),w(c,{prop:"name",label:"\u540d\u79f0","min-width":"180","show-overflow-tooltip":""}),w(c,{prop:"size",label:"\u5927\u5c0f","min-width":"100"},{default:C((e=>[L(P(I(u)(e.row.size)),1)])),_:1}),w(c,{prop:"filename",label:"\u4f4d\u7f6e","min-width":"190","show-overflow-tooltip":""}),w(c,{prop:"create_at",label:"\u65f6\u95f4","min-width":"160"}),w(c,{prop:"store_type",label:"\u5b58\u50a8\u5bf9\u8c61","min-width":"90"}),w(c,{fixed:"right",label:"\u64cd\u4f5c",width:"150"},{default:C((e=>[w(a,{link:"",type:"primary",onClick:l=>{return a=e.row,void r.sysSiteBakFileDownload({id:g.value.fid,bid:a.id,action:"download_backup_site"}).then((e=>{if("application/json"==e.headers["content-type"]){const l=new FileReader;l.readAsText(e.data),l.onload=()=>{const e=JSON.parse(l.result);A.warning(e.msg)}}else m(e.data,a.name)}));var a}},{default:C((()=>l[3]||(l[3]=[L("\u4e0b\u8f7d")]))),_:2},1032,["onClick"]),w(a,{link:"",type:"primary",onClick:l=>{return a=e.row,void Y.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${a.name}\u3011\u5907\u4efd\u6587\u4ef6\u5417\uff1f`,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{i.value=!0;let l={id:g.value.fid,bid:a.id,action:"del_backup_site"};r.sysSitesBakMg(l).then((e=>{i.value=!1,2e3==e.code?(A.success(e.msg),D()):A.warning(e.msg)}))})).catch((()=>{}));var a}},{default:C((()=>l[4]||(l[4]=[L("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[_,I(i)]]),w(H,{small:!0,"child-msg":I(y),onCallFather:j},null,8,["child-msg"])])),_:1},8,["modelValue","title","loading"]),w(W,{ref_key:"batchOpRef",ref:$,onClosed:D,tip2:I(Z),percentContent:I(N),percentage:I(G),loadingSave:I(K),stepStatus:I(J)},{table:C((()=>[w(p,{data:I(O),border:"","max-height":500},{default:C((()=>[w(c,{prop:"name",label:"\u540d\u79f0","min-width":"280","show-overflow-tooltip":""}),w(c,{prop:"status",label:"\u72b6\u6001","min-width":"100"},{default:C((e=>["wait"==e.row.status?(k(),V(f,{key:0,type:"info"},{default:C((()=>l[5]||(l[5]=[L("\u7b49\u5f85\u5220\u9664")]))),_:1})):"success"==e.row.status?(k(),V(f,{key:1,type:"success"},{default:C((()=>l[6]||(l[6]=[L("\u5220\u9664\u6210\u529f")]))),_:1})):"error"==e.row.status?(k(),V(f,{key:2,type:"danger"},{default:C((()=>l[7]||(l[7]=[L("\u5220\u9664\u5931\u8d25")]))),_:1})):(k(),b("span",re))])),_:1})])),_:1},8,["data"])])),footer:C((()=>[w(a,{type:"primary",onClick:X,loading:I(K)},{default:C((()=>l[8]||(l[8]=[L("\u786e\u8ba4")]))),_:1},8,["loading"])])),_:1},8,["tip2","percentContent","percentage","loadingSave","stepStatus"])])}}},[["__scopeId","data-v-06300c73"]]),ue={key:0},ce={key:1},pe={key:0},me={key:1},fe={key:2},ge={key:3},ye={key:0},he={key:1},_e=i({__name:"moduleNginxRedirect",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=d(),t=e;let o=_(!1);_(!1);let n=_(!1),i=_("\u65b0\u589e\u91cd\u5b9a\u5411"),u=_({redirectId:f(9),type:"domain",domains:[],redirectCode:"301",redirectRoot:!0,path:"",target:"http://",keepUrlPath:!0,status:!0,operate:"add"}),c=_([]),p=_([]),m=[{required:!0,message:"\u8bf7\u8f93\u5165\u8def\u5f84",trigger:"blur"}],g=[{required:!0,message:"\u8bf7\u9009\u62e9\u57df\u540d",trigger:"blur"}],y=_({type:[{required:!0,message:"\u8bf7\u9009\u62e9\u91cd\u5b9a\u5411\u7c7b\u578b",trigger:"blur"}],redirectCode:[{required:!0,message:"\u8bf7\u9009\u62e9\u91cd\u5b9a\u5411\u65b9\u5f0f",trigger:"blur"}],target:[{required:!0,message:"\u8bf7\u8f93\u5165\u76ee\u6807",trigger:"blur"}],keepUrlPath:[{required:!0,message:"\u8bf7\u9009\u62e9",trigger:"blur"}],status:[{required:!0,message:"\u8bf7\u9009\u62e9",trigger:"blur"}]});function h(){o.value=!1,i.value="",u.value={redirectId:f(9),type:"domain",domains:[],redirectCode:"301",redirectRoot:!0,path:"",target:"http://",keepUrlPath:!0,status:!0,operate:"add"}}function T(){u.value.operate="add",i.value="\u65b0\u589e\u91cd\u5b9a\u5411",o.value=!0}function M(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="",r.sysGetSitesManage({id:t.id,action:"get_site_redirect"}).then((e=>{a.loadingInfo.isLoading=!1,2e3===e.code?c.value=e.data:A.warning(e.msg)}))}function R(e,l){let o=!0,n="\u542f\u52a8";"stop"==e&&(o=!1,n="\u505c\u6b62"),Y.confirm(`\u786e\u5b9a\u8981${n}\u5417\uff1f`,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let i=l;i.operate="edit",i.status=o,i.editStatus=!0;let d={action:"set_site_redirect",id:t.id,cont:i};a.loadingInfo.isLoading=!0,a.loadingInfo.content=`\u6b63\u5728${n}...`,r.sysGetSitesManage(d).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),h(),M()):A.warning(e.msg)}))})).catch((()=>{}))}let E=_(null);function O(){E.value.validate((e=>{if(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_redirect",id:t.id,cont:u.value};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),h(),M()):A.warning(e.msg)}))}}))}return F((()=>{M(),r.sysGetSitesDomainList({site:t.id}).then((e=>{if(2e3==e.code)if(e.data.data.length>0){let l=e.data.data;const a=Array.from(new Set(l.map((e=>e.name)))).map((e=>l.find((l=>l.name===e))));p.value=a}else p.value=[]}))})),(e,l)=>{const d=v("el-button"),f=v("el-table-column"),_=v("el-table"),F=v("el-switch"),B=v("el-form-item"),$=v("el-option"),q=v("el-select"),G=v("el-input"),H=v("el-alert"),N=v("el-form");return k(),b("div",null,[w(d,{type:"primary",onClick:T,style:{"margin-bottom":"15px"},icon:"plus"},{default:C((()=>l[10]||(l[10]=[L("\u65b0\u589e")]))),_:1}),w(_,{border:"",data:I(c),"max-height":"500"},{default:C((()=>[w(f,{label:"\u6e90\u57df\u540d/\u8def\u5f84","min-width":"200","show-overflow-tooltip":""},{default:C((({row:e})=>["domain"==e.type?(k(),b("span",ue,P(e.domains?e.domains.join(","):""),1)):(k(),b("span",ce,P(e.path),1))])),_:1}),w(f,{prop:"type",label:"\u7c7b\u578b",width:"90"},{default:C((e=>["path"==e.row.type?(k(),b("span",pe,"\u8def\u5f84")):"domain"==e.row.type?(k(),b("span",me,"\u57df\u540d")):"404"==e.row.type?(k(),b("span",fe,"404")):(k(),b("span",ge))])),_:1}),w(f,{prop:"redirectCode",label:"\u65b9\u5f0f",width:"80"}),w(f,{prop:"target",label:"\u76ee\u6807URL","min-width":"180","show-overflow-tooltip":""}),w(f,{prop:"port",label:"\u72b6\u6001","min-width":"100"},{default:C((({row:e})=>[e.status?(k(),V(d,{key:0,link:"",type:"success",icon:"VideoPlay",onClick:l=>R("stop",e)},{default:C((()=>l[11]||(l[11]=[L(" \u5df2\u5f00\u542f ")]))),_:2},1032,["onClick"])):(k(),V(d,{key:1,link:"",type:"danger",icon:"VideoPause",onClick:l=>R("start",e)},{default:C((()=>l[12]||(l[12]=[L(" \u5df2\u505c\u6b62 ")]))),_:2},1032,["onClick"]))])),_:1}),w(f,{prop:"keepUrlPath",label:"\u4fdd\u7559URL\u53c2\u6570",width:"112"},{default:C((e=>["404"!=e.row.type?(k(),b("span",ye,P(e.row.keepUrlPath?"\u4fdd\u7559":"\u4e0d\u4fdd\u7559"),1)):(k(),b("span",he))])),_:1}),w(f,{prop:"redirectId",label:"ID",width:"120","show-overflow-tooltip":""}),w(f,{fixed:"right",label:"\u64cd\u4f5c",width:"109"},{default:C((e=>[w(d,{link:"",type:"primary",onClick:l=>function(e){u.value.operate="edit",i.value="\u7f16\u8f91\u91cd\u5b9a\u5411",o.value=!0;let l=s(e);u.value.redirectId=l.redirectId,u.value.type=l.type,u.value.domains=l.domains,u.value.redirectCode=l.redirectCode,u.value.redirectRoot=l.redirectRoot,u.value.path=l.path,u.value.target=l.target,u.value.keepUrlPath=l.keepUrlPath}(e.row)},{default:C((()=>l[13]||(l[13]=[L("\u7f16\u8f91")]))),_:2},1032,["onClick"]),w(d,{link:"",type:"primary",onClick:l=>{return o=e.row,void Y.confirm("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let l=o;l.operate="del";let n={action:"set_site_redirect",id:t.id,cont:l};a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u5220\u9664...",r.sysGetSitesManage(n).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),h(),M()):A.warning(e.msg)}))})).catch((()=>{}));var o}},{default:C((()=>l[14]||(l[14]=[L("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),w(z,{modelValue:I(o),"onUpdate:modelValue":l[9]||(l[9]=e=>U(o)?o.value=e:o=e),title:I(i),width:"680px","before-close":h},{footer:C((()=>[w(d,{onClick:h,loading:I(n)},{default:C((()=>l[17]||(l[17]=[L("\u53d6\u6d88")]))),_:1},8,["loading"]),w(d,{type:"primary",onClick:O,loading:I(n)},{default:C((()=>l[18]||(l[18]=[L("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:C((()=>[w(N,{ref_key:"rulesForm",ref:E,"label-position":"right","label-width":"auto",model:I(u),rules:I(y)},{default:C((()=>[w(B,{label:"\u5f00\u542f\u91cd\u5b9a\u5411",prop:"status"},{default:C((()=>[w(F,{modelValue:I(u).status,"onUpdate:modelValue":l[0]||(l[0]=e=>I(u).status=e)},null,8,["modelValue"])])),_:1}),w(B,{label:"\u91cd\u5b9a\u5411\u7c7b\u578b",prop:"type"},{default:C((()=>[w(q,{modelValue:I(u).type,"onUpdate:modelValue":l[1]||(l[1]=e=>I(u).type=e),onChange:l[2]||(l[2]=e=>{"404"!=I(u).type&&(u.value.redirectRoot=!1)}),disabled:"edit"===I(u).operate},{default:C((()=>[w($,{label:"\u57df\u540d",value:"domain"}),w($,{label:"\u8def\u5f84",value:"path"}),w($,{label:"\u9875\u9762404",value:"404"})])),_:1},8,["modelValue","disabled"])])),_:1}),w(B,{label:"\u91cd\u5b9a\u5411\u65b9\u5f0f",prop:"redirectCode"},{default:C((()=>[w(q,{modelValue:I(u).redirectCode,"onUpdate:modelValue":l[3]||(l[3]=e=>I(u).redirectCode=e)},{default:C((()=>[w($,{label:"301",value:"301"}),w($,{label:"302",value:"302"})])),_:1},8,["modelValue"]),l[15]||(l[15]=D("span",{class:"right-tips"}," 301\u6c38\u4e45\u91cd\u5b9a\u5411\uff0c302\u4e34\u65f6\u91cd\u5b9a\u5411 ",-1))])),_:1}),"path"==I(u).type?(k(),V(B,{key:0,label:"\u8def\u5f84",prop:"path",rules:"path"==I(u).type?I(m):[]},{default:C((()=>[w(G,{modelValue:I(u).path,"onUpdate:modelValue":l[4]||(l[4]=e=>I(u).path=e),modelModifiers:{trim:!0},placeholder:"\u8bf7\u8f93\u5165\u8def\u5f84 \u5982\uff1a/ruyi"},null,8,["modelValue"])])),_:1},8,["rules"])):x("",!0),"domain"==I(u).type?(k(),V(B,{key:1,label:"\u6e90\u57df\u540d",prop:"domains",rules:"domain"==I(u).type?I(g):[]},{default:C((()=>[w(q,{modelValue:I(u).domains,"onUpdate:modelValue":l[5]||(l[5]=e=>I(u).domains=e),multiple:""},{default:C((()=>[(k(!0),b(S,null,j(I(p),((e,l)=>(k(),V($,{key:l,value:e.name,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["rules"])):x("",!0),"404"==I(u).type?(k(),V(B,{key:2,label:"\u91cd\u5b9a\u5411\u5230\u9996\u9875",prop:"redirectRoot"},{default:C((()=>[w(F,{modelValue:I(u).redirectRoot,"onUpdate:modelValue":l[6]||(l[6]=e=>I(u).redirectRoot=e)},null,8,["modelValue"])])),_:1})):x("",!0),!I(u).redirectRoot&&"404"==I(u).type||"path"==I(u).type||"domain"==I(u).type?(k(),V(B,{key:3,label:"\u76ee\u6807URL\u5730\u5740",prop:"target"},{default:C((()=>[w(G,{modelValue:I(u).target,"onUpdate:modelValue":l[7]||(l[7]=e=>I(u).target=e),modelModifiers:{trim:!0},placeholder:"\u8bf7\u8f93\u5165URL\u5730\u5740 \u5982\uff1ahttp://ruyi.lybbn.cn/1.html"},null,8,["modelValue"])])),_:1})):x("",!0),"404"!==I(u).type?(k(),V(B,{key:4,label:"\u4fdd\u7559URL\u53c2\u6570",prop:"keepUrlPath"},{default:C((()=>[w(F,{modelValue:I(u).keepUrlPath,"onUpdate:modelValue":l[8]||(l[8]=e=>I(u).keepUrlPath=e)},null,8,["modelValue"])])),_:1})):x("",!0),"404"==I(u).type?(k(),V(H,{key:5,type:"warning"},{default:C((()=>l[16]||(l[16]=[L("404\u9875\u9762\u91cd\u5b9a\u5411\u53ea\u6709\u4e00\u6761\uff0c\u65b0\u5efa\u7b2c\u4e8c\u6761\u4f1a\u8986\u76d6\u7b2c\u4e00\u6761\u5185\u5bb9!!!")]))),_:1})):x("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-bedb2b86"]]),ve=i({__name:"moduleNginxLllimit",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=d(),t=e;let o=_({plan:"bbs",perserver:300,perip:25,rate:512,status:!1}),n=_([{key:"bbs",name:"\u8bba\u575b/\u535a\u5ba2",values:[300,25,512]},{key:"image",name:"\u56fe\u7247\u7ad9",values:[200,10,1024]},{key:"doanload",name:"\u4e0b\u8f7d\u7ad9",values:[50,3,2048]},{key:"shop",name:"\u5546\u57ce",values:[500,10,2048]},{key:"portalsite",name:"\u95e8\u6237",values:[400,15,1024]},{key:"company",name:"\u4f01\u4e1a",values:[60,10,512]},{key:"video",name:"\u89c6\u9891",values:[150,4,1024]}]),i=_({perserver:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e76\u53d1\u9650\u5236",trigger:"blur"}],perip:[{required:!0,message:"\u8bf7\u8f93\u5165\u5355IP\u9650\u5236",trigger:"blur"}],rate:[{required:!0,message:"\u8bf7\u8f93\u5165\u6d41\u91cf\u9650\u5236",trigger:"blur"}]});function s(e){"custom"==e?(o.value.perserver=null,o.value.perip=null,o.value.rate=null):n.value.forEach((l=>{l.key===e&&(o.value.perserver=l.values[0],o.value.perip=l.values[1],o.value.rate=l.values[2])}))}function u(e){"custom"!=o.value.plan&&(o.value.plan="custom")}let c=_(null);function p(){c.value.validate((e=>{if(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_ratelimit",id:t.id,cont:o.value};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?A.success(e.msg):A.warning(e.msg)}))}}))}return F((()=>{!function(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="";let e={action:"get_site_ratelimit",id:t.id};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,2e3===e.code?o.value=e.data:A.warning(e.msg)}))}()})),(e,l)=>{const a=v("el-switch"),t=v("el-form-item"),d=v("el-option"),r=v("el-select"),m=v("el-input"),f=v("el-form"),g=v("el-button"),y=v("el-col"),h=v("el-row"),_=M("limitPositiveIntNo0");return k(),V(h,{gutter:20},{default:C((()=>[w(y,{xs:24,sm:18,md:18,lg:18,xl:18},{default:C((()=>[w(f,{inline:!1,model:I(o),rules:I(i),ref_key:"rulesForm",ref:c,"label-position":"right","label-width":"auto",style:{"margin-left":"10px"}},{default:C((()=>[w(t,{prop:"status",label:"\u662f\u5426\u542f\u7528"},{default:C((()=>[w(a,{modelValue:I(o).status,"onUpdate:modelValue":l[0]||(l[0]=e=>I(o).status=e)},null,8,["modelValue"])])),_:1}),w(t,{label:"\u9650\u5236\u65b9\u6848"},{default:C((()=>[w(r,{modelValue:I(o).plan,"onUpdate:modelValue":l[1]||(l[1]=e=>I(o).plan=e),onChange:s},{default:C((()=>[(k(!0),b(S,null,j(I(n),((e,l)=>(k(),V(d,{key:l,label:e.name,value:e.key},null,8,["label","value"])))),128)),(k(),V(d,{key:999,label:"\u81ea\u5b9a\u4e49",value:"custom"}))])),_:1},8,["modelValue"])])),_:1}),w(t,{label:"\u5e76\u53d1\u9650\u5236",prop:"perserver"},{default:C((()=>[R(w(m,{modelValue:I(o).perserver,"onUpdate:modelValue":l[2]||(l[2]=e=>I(o).perserver=e),modelModifiers:{number:!0},maxlength:"15",onChange:u},null,8,["modelValue"]),[[_]]),l[5]||(l[5]=D("span",{class:"right-tips"},"\u9650\u5236\u5f53\u524d\u7ad9\u70b9\u6700\u5927\u5e76\u53d1\u6570",-1))])),_:1}),w(t,{label:"\u5355IP\u9650\u5236",prop:"perip"},{default:C((()=>[R(w(m,{modelValue:I(o).perip,"onUpdate:modelValue":l[3]||(l[3]=e=>I(o).perip=e),modelModifiers:{number:!0},maxlength:"15",onChange:u},null,8,["modelValue"]),[[_]]),l[6]||(l[6]=D("span",{class:"right-tips"},"\u9650\u5236\u5355\u4e2aIP\u8bbf\u95ee\u6700\u5927\u5e76\u53d1\u6570",-1))])),_:1}),w(t,{label:"\u6d41\u91cf\u9650\u5236",prop:"rate"},{default:C((()=>[R(w(m,{modelValue:I(o).rate,"onUpdate:modelValue":l[4]||(l[4]=e=>I(o).rate=e),modelModifiers:{number:!0},maxlength:"15",onChange:u},null,8,["modelValue"]),[[_]]),l[7]||(l[7]=D("span",{class:"right-tips"},"\u9650\u5236\u6bcf\u4e2a\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u4e0b\u8f7d\u901f\u7387(\u5355\u4f4d:KB/s)",-1))])),_:1})])),_:1},8,["model","rules"]),w(g,{type:"primary",onClick:p,style:{float:"right"}},{default:C((()=>l[8]||(l[8]=[L("\u4fdd\u5b58\u5e76\u91cd\u8f7d")]))),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-5d99c573"]]),be=i({__name:"moduleNginxProxy",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=d(),t=e;let o=_(!1),n=_(""),i=_(!1);_(!1),_(!1);let u=_("\u65b0\u589e\u53cd\u5411\u4ee3\u7406"),c=_({name:"",proxyPath:"/",proxyPass:"http://",cache:!1,cacheTime:1,cacheUnit:"m",sniEnable:!1,status:!0,advanced:!1,subFilters:[],proxyHost:"$host",operate:"add"}),p=_([]),m=_(""),f=_(""),y=_({name:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0",trigger:"blur"}],proxyPath:[{required:!0,message:"\u8bf7\u8f93\u5165\u4ee3\u7406\u8def\u5f84",trigger:"blur"}],proxyPass:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8f6c\u53d1\u5230\u7684\u540e\u7aef\u5730\u5740",trigger:"blur"}],proxyHost:[{required:!0,message:"\u8bf7\u586b\u5199\u5fc5\u586b\u9879",trigger:"blur"}]});let h=[{required:!0,trigger:"blur",min:1,type:"number",message:"\u8bf7\u8f93\u5165\u7f13\u5b58\u65f6\u95f4"},(T=1,P=99999,{required:!0,trigger:"blur",min:T,max:P,type:"number",message:`\u6570\u5b57\u53ef\u9009\u8303\u56f4${T}\u5230${P}`})];var T,P;function M(){i.value=!1,u.value="",c.value={name:"",proxyPath:"/",proxyPass:"http://",cache:!1,cacheTime:1,cacheUnit:"m",sniEnable:!1,status:!0,subFilters:[],proxyHost:"$host",operate:"add",advanced:!1}}function R(){c.value.operate="add",u.value="\u65b0\u589e\u53cd\u5411\u4ee3\u7406",i.value=!0}function E(){c.value.subFilters.push({key:"",value:""})}function O(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="",r.sysGetSitesManage({id:t.id,action:"get_site_proxy"}).then((e=>{a.loadingInfo.isLoading=!1,2e3===e.code?p.value=e.data:A.warning(e.msg)}))}function B(e,l){let o=!0,n="\u542f\u52a8";"stop"==e&&(o=!1,n="\u505c\u6b62"),Y.confirm(`\u786e\u5b9a\u8981${n}\u5417\uff1f`,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let i=l;i.operate="edit",i.status=o,i.editStatus=!0;let d={action:"set_site_proxy",id:t.id,cont:i};a.loadingInfo.isLoading=!0,a.loadingInfo.content=`\u6b63\u5728${n}...`,r.sysGetSitesManage(d).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),M(),O()):A.warning(e.msg)}))})).catch((()=>{}))}let $=_(null);function q(){$.value.validate((e=>{if(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_proxy",id:t.id,cont:c.value};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),M(),O()):A.warning(e.msg)}))}}))}function G(){n.value="",o.value=!1,m.value=""}function H(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_proxy_conf",id:t.id,name:f.value,conf:m.value};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),G()):A.warning(e.msg)}))}return F((()=>{O()})),(e,l)=>{const d=v("el-button"),_=v("el-table-column"),T=v("el-tag"),P=v("el-table"),F=v("el-switch"),N=v("el-form-item"),W=v("el-col"),K=v("el-row"),Z=v("el-option"),Q=v("el-select"),X=v("el-input"),ee=v("el-form");return k(),b("div",null,[w(d,{type:"primary",onClick:R,style:{"margin-bottom":"15px"},icon:"plus"},{default:C((()=>l[13]||(l[13]=[L("\u65b0\u589e")]))),_:1}),w(P,{border:"",data:I(p),"max-height":"500"},{default:C((()=>[w(_,{prop:"name",label:"\u540d\u79f0","min-width":"160","show-overflow-tooltip":""}),w(_,{prop:"proxyPath",label:"\u4ee3\u7406\u8def\u5f84","min-width":"120","show-overflow-tooltip":""}),w(_,{prop:"proxyPass",label:"\u8f6c\u53d1\u5230","min-width":"200","show-overflow-tooltip":""}),w(_,{prop:"cache",label:"\u7f13\u5b58","min-width":"100"},{default:C((({row:e})=>[e.cache?(k(),V(T,{key:1,type:"success"},{default:C((()=>l[15]||(l[15]=[L("\u542f\u7528")]))),_:1})):(k(),V(T,{key:0,type:"danger"},{default:C((()=>l[14]||(l[14]=[L("\u7981\u7528")]))),_:1}))])),_:1}),w(_,{prop:"port",label:"\u72b6\u6001","min-width":"100"},{default:C((({row:e})=>[e.status?(k(),V(d,{key:0,link:"",type:"success",icon:"VideoPlay",onClick:l=>B("stop",e)},{default:C((()=>l[16]||(l[16]=[L(" \u5df2\u5f00\u542f ")]))),_:2},1032,["onClick"])):(k(),V(d,{key:1,link:"",type:"danger",icon:"VideoPause",onClick:l=>B("start",e)},{default:C((()=>l[17]||(l[17]=[L(" \u5df2\u505c\u6b62 ")]))),_:2},1032,["onClick"]))])),_:1}),w(_,{fixed:"right",label:"\u64cd\u4f5c",width:"180"},{default:C((e=>[w(d,{link:"",type:"primary",onClick:l=>function(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="";let l={action:"get_site_proxy_conf",id:t.id,name:e.name};r.sysGetSitesManage(l).then((l=>{a.loadingInfo.isLoading=!1,2e3==l.code?(m.value=l.data,f.value=e.name,n.value=`\u4ee3\u7406\u914d\u7f6e\u4fee\u6539\u3010${e.name}\u3011`,o.value=!0):A.warning(l.msg)}))}(e.row)},{default:C((()=>l[18]||(l[18]=[L("\u914d\u7f6e\u6587\u4ef6")]))),_:2},1032,["onClick"]),w(d,{link:"",type:"primary",onClick:l=>function(e){c.value.operate="edit",u.value="\u7f16\u8f91\u53cd\u5411\u4ee3\u7406",i.value=!0;let l=s(e);c.value.name=l.name,c.value.proxyPath=l.proxyPath,c.value.proxyPass=l.proxyPass,c.value.cache=l.cache,c.value.cacheTime=l.cacheTime,c.value.cacheUnit=l.cacheUnit,c.value.sniEnable=l.sniEnable,c.value.status=l.status,c.value.subFilters=l.subFilters,c.value.proxyHost=l.proxyHost,c.value.advanced=l.advanced}(e.row)},{default:C((()=>l[19]||(l[19]=[L("\u7f16\u8f91")]))),_:2},1032,["onClick"]),w(d,{link:"",type:"primary",onClick:l=>{return o=e.row,void Y.confirm("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let l=o;l.operate="del";let n={action:"set_site_proxy",id:t.id,cont:l};a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u5220\u9664...",r.sysGetSitesManage(n).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),M(),O()):A.warning(e.msg)}))})).catch((()=>{}));var o}},{default:C((()=>l[20]||(l[20]=[L("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),w(z,{modelValue:I(i),"onUpdate:modelValue":l[10]||(l[10]=e=>U(i)?i.value=e:i=e),title:I(u),width:"680px","before-close":M},{footer:C((()=>[w(d,{onClick:M},{default:C((()=>l[29]||(l[29]=[L("\u53d6\u6d88")]))),_:1}),w(d,{type:"primary",onClick:q},{default:C((()=>l[30]||(l[30]=[L("\u4fdd\u5b58")]))),_:1})])),default:C((()=>[w(ee,{ref_key:"rulesForm",ref:$,"label-position":"right","label-width":"auto",model:I(c),rules:I(y)},{default:C((()=>[w(K,{gutter:10},{default:C((()=>[w(W,{span:12},{default:C((()=>[w(N,{label:"\u5f00\u542f\u4ee3\u7406",prop:"status"},{default:C((()=>[w(F,{modelValue:I(c).status,"onUpdate:modelValue":l[0]||(l[0]=e=>I(c).status=e)},null,8,["modelValue"])])),_:1})])),_:1}),w(W,{span:12},{default:C((()=>[w(N,{label:"\u9ad8\u7ea7\u6a21\u5f0f",prop:"advanced"},{default:C((()=>[w(F,{modelValue:I(c).advanced,"onUpdate:modelValue":l[1]||(l[1]=e=>I(c).advanced=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),I(c).advanced?(k(),V(N,{key:0,label:"\u5f00\u542f\u7f13\u5b58",prop:"cache"},{default:C((()=>[w(F,{modelValue:I(c).cache,"onUpdate:modelValue":l[2]||(l[2]=e=>I(c).cache=e)},null,8,["modelValue"]),l[21]||(l[21]=D("span",{class:"right-tips"}," \u5f00\u542f\u540e\u5185\u5bb9\u7f13\u5b58\u53ef\u80fd\u5bfc\u81f4\u65b0\u6570\u636e\u4e0d\u80fd\u53ca\u65f6\u53d8\u5316 ",-1))])),_:1})):x("",!0),I(c).advanced&&I(c).cache?(k(),V(N,{key:1,label:"\u7f13\u5b58\u65f6\u95f4",prop:"cacheTime",rules:I(c).cache?I(h):[]},{default:C((()=>[w(X,{modelValue:I(c).cacheTime,"onUpdate:modelValue":l[4]||(l[4]=e=>I(c).cacheTime=e),modelModifiers:{number:!0},maxlength:"15"},{append:C((()=>[w(Q,{modelValue:I(c).cacheUnit,"onUpdate:modelValue":l[3]||(l[3]=e=>I(c).cacheUnit=e),style:{width:"100px"}},{default:C((()=>[(k(!0),b(S,null,j(I(g),((e,l)=>(k(),V(Z,{key:l,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["rules"])):x("",!0),w(N,{label:"\u4ee3\u7406\u540d\u79f0",prop:"name"},{default:C((()=>[w(X,{modelValue:I(c).name,"onUpdate:modelValue":l[5]||(l[5]=e=>I(c).name=e),modelModifiers:{trim:!0},disabled:"edit"===I(c).operate,placeholder:"\u8bf7\u8f93\u5165\u53cd\u5411\u4ee3\u7406\u540d\u79f0"},null,8,["modelValue","disabled"])])),_:1}),w(N,{label:"\u4ee3\u7406\u8def\u5f84",prop:"proxyPath"},{default:C((()=>[w(X,{modelValue:I(c).proxyPath,"onUpdate:modelValue":l[6]||(l[6]=e=>I(c).proxyPath=e),modelModifiers:{trim:!0},placeholder:"\u8bf7\u8f93\u5165\u4ee3\u7406\u8def\u5f84\uff08\u524d\u7aef\u8bf7\u6c42\u8def\u5f84\uff09"},null,8,["modelValue"]),l[22]||(l[22]=D("span",{class:"right-tips"}," /\u8868\u793a\u4ee3\u7406\u6240\u6709\uff0c/api \u8868\u793a\u4ee3\u7406\u6240\u6709\u4ee5 /api \u5f00\u5934\u7684\u8bf7\u6c42 ",-1))])),_:1}),w(N,{label:"\u8f6c\u53d1\u5230",prop:"proxyPass"},{default:C((()=>[w(X,{modelValue:I(c).proxyPass,"onUpdate:modelValue":l[7]||(l[7]=e=>I(c).proxyPass=e),modelModifiers:{trim:!0},placeholder:"\u5982\uff1ahttp://127.0.0.1:8000"},null,8,["modelValue"]),l[23]||(l[23]=D("span",{class:"right-tips"}," \u4ee3\u7406\u7684\u7ad9\u70b9\uff0c\u4e00\u822c\u4e3a\u540e\u7aef\u670d\u52a1\u5730\u5740\uff0c\u5982\uff1ahttp://127.0.0.1:8000 ",-1))])),_:1}),w(N,{label:"\u540e\u7aef\u57df\u540d",prop:"proxyHost"},{default:C((()=>[w(X,{modelValue:I(c).proxyHost,"onUpdate:modelValue":l[8]||(l[8]=e=>I(c).proxyHost=e),modelModifiers:{trim:!0},placeholder:"\u5982\uff1ahttp://127.0.0.1:8000"},null,8,["modelValue"]),l[24]||(l[24]=D("span",{class:"right-tips"}," \u8bbe\u7f6e\u4f20\u9012\u7ed9\u540e\u7aef\u670d\u52a1\u5668\u7684Host\u5934\u90e8\u4fe1\u606f\uff0c$host\u4f1a\u88ab\u66ff\u6362\u4e3a\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e2d\u7684\u4e3b\u673a\u540d ",-1))])),_:1}),I(c).advanced?(k(),V(N,{key:2,label:"\u56de\u6e90SNI",prop:"sniEnable"},{default:C((()=>[w(F,{modelValue:I(c).sniEnable,"onUpdate:modelValue":l[9]||(l[9]=e=>I(c).sniEnable=e)},null,8,["modelValue"]),l[25]||(l[25]=D("span",{class:"right-tips"}," \u540e\u7aef\u4e3ahttps\u65f6\u56de\u6e90SNI\u53ef\u786e\u4fdd\u540e\u7aef\u670d\u52a1\u80fd\u6839\u636e\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6b63\u786e\u5730\u9009\u62e9\u8bc1\u4e66 ",-1))])),_:1})):x("",!0),I(c).advanced&&I(c).subFilters.length>0?(k(),V(N,{key:3,label:"\u5185\u5bb9\u66ff\u6362"},{default:C((()=>[(k(!0),b(S,null,j(I(c).subFilters,((e,a)=>(k(),b("div",{style:{width:"100%"},key:a},[w(K,{gutter:10},{default:C((()=>[w(W,{span:11},{default:C((()=>[w(X,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,modelModifiers:{trim:!0},placeholder:"\u539f\u5185\u5bb9"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),w(W,{span:11},{default:C((()=>[w(X,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,modelModifiers:{trim:!0},placeholder:"\u66ff\u6362\u4e3a"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),w(W,{span:2},{default:C((()=>[w(d,{link:"",onClick:e=>function(e){c.value.subFilters.splice(e,1)}(a),type:"danger"},{default:C((()=>l[26]||(l[26]=[L(" \u5220\u9664 ")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})):x("",!0),I(c).advanced?(k(),V(N,{key:4,label:I(c).subFilters.length>0?"\xa0":"\u5185\u5bb9\u66ff\u6362"},{default:C((()=>[w(d,{type:"primary",icon:"plus",onClick:E,disabled:I(c).subFilters.length>=3},{default:C((()=>l[27]||(l[27]=[L(" \u6dfb\u52a0\u5185\u5bb9\u66ff\u6362 ")]))),_:1},8,["disabled"]),l[28]||(l[28]=D("span",{class:"right-tips"}," \u8bf7\u6c42\u54cd\u5e94\u5185\u5bb9\u66ff\u6362\uff0c\u6700\u591a\u53ef\u6dfb\u52a03\u6761,\u65e0\u9700\u66ff\u6362\u8bf7\u7f6e\u7a7a ",-1))])),_:1},8,["label"])):x("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),w(z,{modelValue:I(o),"onUpdate:modelValue":l[12]||(l[12]=e=>U(o)?o.value=e:o=e),title:I(n),width:"680px","before-close":G},{default:C((()=>[w(J,{modelValue:I(m),"onUpdate:modelValue":l[11]||(l[11]=e=>U(m)?m.value=e:m=e),fontSize:"13px",placeholder:I(m)?"":"\u672a\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6",showLineNums:!0,lineWrapping:!0,height:"500px",mode:"javascript","read-only":!1,ref:"lyCodemirrorConf"},null,8,["modelValue","placeholder"]),w(d,{type:"primary",style:{"margin-top":"10px","margin-bottom":"10px"},onClick:H},{default:C((()=>l[31]||(l[31]=[L("\u4fdd\u5b58\u5e76\u91cd\u8f7d")]))),_:1}),l[32]||(l[32]=D("div",{class:"ry-cj-care"},[D("li",null,"\u5feb\u6377\u952e CTRL+F \u67e5\u627e\u548c\u66ff\u6362\u5185\u5bb9")],-1))])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-50a88cf8"]]),ke={class:"ruyi-acme-account"},we={__name:"moduleAddAcmeAccount",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=d(),o=a;let n=_(!1),i=_(!1),s=_("\u521b\u5efaACME\u8d26\u53f7"),u=_({email:"",type:"letsencrypt"}),c=[{id:"letsencrypt",name:"Let's Encrypt"}];let p=_({email:[{required:!0,message:"\u90ae\u7bb1\u5fc5\u586b\u9879",trigger:"blur"},{validator:function(e,l,a){return l?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(l)?a():a(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u5730\u5740")):a(new Error("\u8bf7\u8f93\u5165\u90ae\u7bb1"))},trigger:["blur","change"]}]});function m(){o("closed")}let f=_(null);function g(){f.value.validate((e=>{if(e){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u521b\u5efa...";let e={action:"create_acme_account",email:u.value.email,type:u.value.type};r.sysSSLManage(e).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),m(),o("refreshData")):A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){s.value=l,n.value=!0}}),(e,l)=>{const a=v("el-alert"),t=v("el-input"),o=v("el-form-item"),d=v("el-option"),r=v("el-select"),y=v("el-form"),h=v("el-button");return k(),b("div",ke,[w(z,{modelValue:I(n),"onUpdate:modelValue":l[2]||(l[2]=e=>U(n)?n.value=e:n=e),title:I(s),width:"560px","before-close":m,showFullScreen:!1},{footer:C((()=>[w(h,{onClick:m,loading:I(i)},{default:C((()=>l[4]||(l[4]=[L("\u53d6\u6d88")]))),_:1},8,["loading"]),w(h,{type:"primary",onClick:g,loading:I(i)},{default:C((()=>l[5]||(l[5]=[L("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:C((()=>[w(y,{inline:!1,model:I(u),rules:I(p),ref_key:"rulesForm",ref:f,"label-position":"right","label-width":"auto"},{default:C((()=>[w(a,{style:{"margin-bottom":"15px"}},{default:C((()=>l[3]||(l[3]=[L("\u6b64\u90ae\u7bb1\u8d26\u53f7\u7528\u4e8e\u7533\u8bf7SSL\u8bc1\u4e66")]))),_:1}),w(o,{label:"\u90ae\u7bb1\uff1a",prop:"email"},{default:C((()=>[w(t,{modelValue:I(u).email,"onUpdate:modelValue":l[0]||(l[0]=e=>I(u).email=e),placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1",clearable:""},null,8,["modelValue"])])),_:1}),w(o,{label:"\u670d\u52a1\u5546\uff1a",prop:"type"},{default:C((()=>[w(r,{modelValue:I(u).type,"onUpdate:modelValue":l[1]||(l[1]=e=>I(u).type=e),style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9"},{default:C((()=>[(k(!0),b(S,null,j(I(c),((e,l)=>(k(),V(d,{key:l,value:e.id,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},Ve={class:"lySSLApplyDialog"},xe=i({__name:"sslApplyLog",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=a;let o=_(!1),n=_(!1),i=_("\u65e5\u5fd7\u8be6\u60c5"),d=_({id:"",order_no:""}),u={},c=_(""),p=_("55vh"),m=_("log"),f=_(null),g=_(""),y=_(!1);function h(){v(),t("refreshData"),t("closed")}function v(){clearInterval(f.value),f.value=null}F((()=>{window.addEventListener("resize",L),L()})),E((()=>{window.removeEventListener("resize",L),v()}));let V=_(null);function x(){n.value=!0;let e={id:d.value.id,order_no:d.value.order_no,action:g.value,is_renew:y.value};r.sysGetSSLInfo(e).then((e=>{if(n.value=!1,2e3==e.code){if(c.value=e.data.data,T((()=>{V.value&&V.value.scrollToBottom()})),e.data.done&&(v(),"all"!=g.value)){let l=2e3;e.data.error&&(l=5e3),setTimeout((()=>{h()}),l)}}else A.warning(e.msg),setTimeout((()=>{h()}),2e3)}))}let S=_(null),j=_(!1);function L(){T((()=>{const e=S.value.getRef();if(e.dialogContentRef){const l=e.dialogContentRef.$refs.headerRef.offsetHeight||80,a=document.body.offsetHeight;e.dialogContentRef.fullscreen||j.value?p.value=a-l:p.value="55vh"}}))}function D(e){j.value=e,L()}return l({handleOpen:function(e,l){i.value=l,o.value=!0,e&&(u=s(e),d.value.id=u.site_id,d.value.order_no=u.order_no,y.value=u.is_renew,u.action&&(g.value=u.action),"all"!=g.value?f.value=setInterval((()=>{x()}),1e3):x())}}),(e,l)=>(k(),b("div",Ve,[w(z,{ref_key:"codeMirrorDialogRef",ref:S,modelValue:I(o),"onUpdate:modelValue":l[1]||(l[1]=e=>U(o)?o.value=e:o=e),title:I(i),width:"50%",onOnChangeFullScreen:D,"before-close":h,showClose:!1,showFullScreen:!1},{default:C((()=>[w(J,{modelValue:I(c),"onUpdate:modelValue":l[0]||(l[0]=e=>U(c)?c.value=e:c=e),fontSize:"15px",placeholder:(I(c),""),showLineNums:!1,lineWrapping:!0,mode:I(m),height:I(p),"read-only":!0,ref_key:"lyCodemirror",ref:V},null,8,["modelValue","placeholder","mode","height"])])),_:1},8,["modelValue","title"])]))}},[["__scopeId","data-v-ddb1aecf"]]),Ce={class:"ruyi-letsencrypt"},Ie={key:0},Se={style:{float:"left"}},je={key:2,style:{"margin-top":"20px"}},Le={key:0,style:{display:"flex","align-items":"center",width:"100%"}},Ue={key:1,style:{display:"flex","align-items":"center",width:"100%"}},Te={key:1},De={key:0},Pe={key:1},Me=i({__name:"moduleLetsEncrypt",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=e,t=d(),o=l;let n=_(!1),i=_(!1),s=_({email:"",status:!1}),u=_({verifyType:"file",checkedDomains:[],dnsAccount:""}),c=_([]),p=_(!1),m=_({}),f=_([]),g=_([{label:"\u963f\u91cc\u4e91DNS",name:"aliyun",status:!1},{label:"\u817e\u8baf\u4e91DNS",name:"tencent",status:!1}]),y=_(!1),h=_(!1);function E(e){u.value.checkedDomains=e?f.value:[],h.value=!1}function B(e){const l=e.length;y.value=l===f.value.length,h.value=l>0&&l<f.value.length}function $(){i.value=!0,r.sysGetSSLInfo({action:"get_acme_account",type:"letsencrypt"}).then((e=>{i.value=!1,2e3==e.code?s.value=e.data:A.warning(e.msg)}))}function q(){n.value=!0,r.sysGetSSLInfo({action:"get_cert_list",type:"letsencrypt",site_id:a.id}).then((e=>{n.value=!1,2e3==e.code?c.value=e.data:A.warning(e.msg)}))}let G=_(null);function H(){G.value.validate((e=>{if(e){if(!s.value.status)return void A.warning("\u8bf7\u5148\u521b\u5efaAcme\u8d26\u53f7");if(u.value.checkedDomains.length<1)return void A.warning("\u8bf7\u9009\u62e9\u9700\u8981\u7533\u8bf7\u7684\u57df\u540d");t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u7533\u8bf7...";let e={action:"apply_cert_letsencrypt",domains:u.value.checkedDomains,site_id:a.id};r.sysSSLManage(e).then((e=>{if(t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code){A({showClose:!1,message:e.msg,type:"success",duration:2e3});let l=e.data;l&&Q(l,!1),o("refreshData")}else A.warning(e.msg)}))}}))}function z(){if(!s.value.status)return void A.warning("\u8bf7\u5148\u521b\u5efaAcme\u8d26\u53f7");t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u7eed\u7b7e...";let e={action:"renew_cert_letsencrypt",site_id:a.id};r.sysSSLManage(e).then((e=>{if(t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code){A({showClose:!1,message:e.msg,type:"success",duration:2e3});let l=e.data;l&&Q(l,!0),o("refreshData")}else A.warning(e.msg)}))}let N=_(!1),Y=_(null);function W(){N.value=!0,T((()=>{Y.value.handleOpen(null,"\u521b\u5efaACME\u8d26\u53f7")}))}let K=_(!1),J=_(null);function Q(e="",l=!1){K.value=!0;let t={order_no:e,site_id:a.id,action:"get_letsencrypt_log",is_renew:l},o="\u7533\u8bf7SSL\u65e5\u5fd7\u8be6\u60c5";l&&(o="\u7eed\u7b7eSSL\u65e5\u5fd7\u8be6\u60c5"),T((()=>{J.value.handleOpen(t,o)}))}function X(){q()}return F((()=>{$(),r.sysGetSitesDomainList({site:a.id}).then((e=>{if(2e3==e.code)if(e.data.data.length>0){let l=e.data.data,a=[];l.forEach((e=>{a.push(e.name)})),f.value=[...new Set(a)]}else f.value=[];else A.warning(e.msg)})),q()})),(e,l)=>{const a=v("el-button"),t=v("el-link"),o=v("el-descriptions-item"),d=v("el-tag"),r=v("el-tooltip"),_=v("el-descriptions"),T=v("el-divider"),F=v("el-radio"),q=v("el-radio-group"),A=v("el-form-item"),Q=v("el-option"),ee=v("el-select"),le=v("el-checkbox"),ae=v("el-checkbox-group"),te=v("el-scrollbar"),oe=v("el-form"),ne=v("el-input"),ie=v("el-alert"),de=v("el-col"),re=v("el-row"),se=M("loading");return R((k(),b("div",Ce,[R((k(),V(_,{title:"Acme\u8d26\u6237\u7528\u4e8e\u7533\u8bf7\u514d\u8d39\u8bc1\u4e66(90\u5929)",direction:"vertical",column:3,border:""},{extra:C((()=>[I(s).status?x("",!0):(k(),V(a,{key:0,type:"primary",onClick:W},{default:C((()=>l[11]||(l[11]=[L(P("\u521b\u5efaAcme\u8d26\u6237"))]))),_:1}))])),default:C((()=>[w(o,{label:"\u8d26\u53f7(\u90ae\u7bb1)"},{default:C((()=>[I(s).email?(k(),b("span",Ie,P(I(s).email),1)):(k(),V(t,{key:1,underline:!1,type:"danger",onClick:W},{default:C((()=>l[12]||(l[12]=[L("\u8bf7\u5148\u521b\u5efa")]))),_:1}))])),_:1}),w(o,{label:"\u670d\u52a1\u5546"},{default:C((()=>[w(r,{effect:"dark",content:"Let's Encrypt \u662f\u4e00\u5bb6\u514d\u8d39\u3001\u5f00\u653e\u3001\u81ea\u52a8\u5316\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784,\u7531\u975e\u8425\u5229\u7ec4\u7ec7\u4e92\u8054\u7f51\u5b89\u5168\u7814\u7a76\u7ec4(ISRG)\u8fd0\u4f5c",placement:"bottom-end"},{default:C((()=>[w(d,null,{default:C((()=>l[13]||(l[13]=[L("Let's Encrypt")]))),_:1})])),_:1})])),_:1}),w(o,{label:"\u72b6\u6001"},{default:C((()=>[w(d,{type:I(s).email?"success":"info"},{default:C((()=>[L(P(I(s).status?"\u5df2\u521b\u5efa":"\u5f85\u521b\u5efa"),1)])),_:1},8,["type"])])),_:1})])),_:1})),[[se,I(i)]]),I(c).length<1||I(p)?(k(),V(T,{key:0,"content-position":"left"},{default:C((()=>l[14]||(l[14]=[L("\u8bc1\u4e66\u7533\u8bf7\uff08\u9ed8\u8ba4\u81ea\u52a8\u7eed\u7b7e\uff09")]))),_:1})):x("",!0),I(c).length<1||I(p)?(k(),V(oe,{key:1,inline:!1,model:I(u),rules:I(m),ref_key:"rulesForm",ref:G,"label-position":"right","label-width":"auto",style:{padding:"10px 25px 10px 25px"}},{default:C((()=>[w(A,{label:"\u9a8c\u8bc1\u65b9\u6cd5"},{default:C((()=>[w(q,{modelValue:I(u).verifyType,"onUpdate:modelValue":l[0]||(l[0]=e=>I(u).verifyType=e)},{default:C((()=>[w(F,{value:"file",label:"\u6587\u4ef6\u9a8c\u8bc1"})])),_:1},8,["modelValue"]),l[15]||(l[15]=D("span",{class:"right-tips"},"\u6587\u4ef6\u9a8c\u8bc1\u65e0\u6cd5\u7533\u8bf7\u6cdb\u57df\u540d\u89e3\u6790",-1))])),_:1}),"dnsAccount"==I(u).verifyType?(k(),V(A,{key:0,label:"DNS\u8d26\u53f7"},{default:C((()=>[w(ee,{modelValue:I(u).dnsAccount,"onUpdate:modelValue":l[1]||(l[1]=e=>I(u).dnsAccount=e),style:{width:"300px"}},{default:C((()=>[(k(!0),b(S,null,j(I(g),((e,l)=>(k(),V(Q,{key:l,label:e.label,value:e.name},{default:C((()=>[D("span",Se,P(e.label),1),D("span",{style:O({float:"right",color:e.status?"var(--el-color-success)":"var(--el-text-color-secondary)","font-size":"13px"})},P(e.status?"\u5df2\u914d\u7f6e":"\u672a\u914d\u7f6e"),5)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"]),w(a,{style:{"margin-left":"10px"}},{default:C((()=>l[16]||(l[16]=[L("\u914d\u7f6e")]))),_:1})])),_:1})):x("",!0),w(A,{label:"\u7533\u8bf7\u57df\u540d"},{default:C((()=>[w(te,{height:"200px",style:{width:"300px",border:"1px solid #f1f1f1",padding:"10px"}},{default:C((()=>[w(le,{modelValue:I(y),"onUpdate:modelValue":l[2]||(l[2]=e=>U(y)?y.value=e:y=e),indeterminate:I(h),onChange:E},{default:C((()=>l[17]||(l[17]=[L("\u5168\u9009")]))),_:1},8,["modelValue","indeterminate"]),w(ae,{modelValue:I(u).checkedDomains,"onUpdate:modelValue":l[3]||(l[3]=e=>I(u).checkedDomains=e),onChange:B,style:{display:"flex","flex-direction":"column","margin-left":"20px"}},{default:C((()=>[(k(!0),b(S,null,j(I(f),((e,l)=>(k(),V(le,{key:l,label:e,value:e},{default:C((()=>[L(P(e),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),w(A,{label:" "},{default:C((()=>[w(a,{type:"primary",onClick:H},{default:C((()=>l[18]||(l[18]=[L("\u7533\u8bf7\u8bc1\u4e66")]))),_:1}),I(p)?(k(),V(a,{key:0,onClick:l[4]||(l[4]=e=>U(p)?p.value=!1:p=!1)},{default:C((()=>l[19]||(l[19]=[L("\u53d6\u6d88\u91cd\u65b0\u7533\u8bf7")]))),_:1})):x("",!0)])),_:1})])),_:1},8,["model","rules"])):x("",!0),I(c).length>0&&!I(p)?(k(),b("div",je,[w(_,{title:"\u8bc1\u4e66\u4fe1\u606f",border:!0,column:2,style:{"margin-bottom":"15px"},class:"rydescriptions"},{extra:C((()=>[w(a,{onClick:l[5]||(l[5]=e=>U(p)?p.value=!0:p=!0)},{default:C((()=>l[20]||(l[20]=[L("\u91cd\u65b0\u7533\u8bf7")]))),_:1}),w(a,{type:"primary",onClick:z},{default:C((()=>l[21]||(l[21]=[L("\u7eed\u7b7e\u8bc1\u4e66")]))),_:1})])),default:C((()=>[w(o,{label:"\u7b7e\u540d"},{default:C((()=>[L(P(I(c)[0].certinfo.organization_name||"-"),1)])),_:1}),w(o,{label:"\u8ba4\u8bc1\u57df\u540d/IP"},{default:C((()=>{return[L(P((e=I(c)[0].certinfo,e?e.san_names&&e.san_names.length>0?e.san_names.join("\u3001"):e.common_name:"-")),1)];var e})),_:1}),w(o,{label:"\u8bc1\u4e66\u7c7b\u578b"},{default:C((()=>[I(c)[0].certinfo.common_name?(k(),b("div",Le,[w(d,null,{default:C((()=>[L(P(I(c)[0].certinfo.type||""),1)])),_:1}),"\u81ea\u7b7e\u8bc1\u4e66"==I(c)[0].certinfo.type?(k(),V(a,{key:0,size:"small",type:"primary",style:{"margin-left":"10px","margin-right":"10px"},onClick:e.downlowdFile},{default:C((()=>l[22]||(l[22]=[L("\u70b9\u51fb\u4e0b\u8f7d\u6839\u8bc1\u4e66")]))),_:1},8,["onClick"])):x("",!0),"\u81ea\u7b7e\u8bc1\u4e66"==I(c)[0].certinfo.type?(k(),b("div",Ue,[l[23]||(l[23]=L(" \u8bc1\u4e66\u5bc6\u7801\uff1a ")),w(ne,{modelValue:I(c)[0].root_password,"onUpdate:modelValue":l[6]||(l[6]=e=>I(c)[0].root_password=e),size:"small",style:{width:"100px"},disabled:!0},null,8,["modelValue"]),w(Z,{content:I(c)[0].root_password,size:"small"},null,8,["content"])])):x("",!0)])):(k(),b("span",Te,"-"))])),_:1}),w(o,{label:"\u8fc7\u671f\u65f6\u95f4"},{default:C((()=>[I(c)[0].certinfo.not_valid_after?(k(),b("span",De,[L(P(I(c)[0].certinfo.not_valid_after),1),D("span",{style:O({color:I(c)[0].expire_days>25?"var(--el-color-success)":"var(--el-color-danger)"})},"\uff08\u5269\u4f59\uff1a"+P(I(c)[0].expire_days)+"\u5929\uff09",5)])):(k(),b("span",Pe,P("-")))])),_:1})])),_:1}),"\u81ea\u7b7e\u8bc1\u4e66"==I(c)[0].certinfo.type?(k(),V(ie,{key:0,type:"success"},{default:C((()=>l[24]||(l[24]=[L("\u3010\u81ea\u7b7e\u8bc1\u4e66\u3011\u4e0d\u88ab\u6d4f\u89c8\u5668\u4fe1\u4efb\uff0c\u6d4f\u89c8\u5668\u4f1a\u663e\u793a\u3010\u4e0d\u5b89\u5168...\u3011\u63d0\u793a\uff0c\u4e0b\u8f7d\u6839\u8bc1\u4e66\u6216\u3010\u7ee7\u7eed\u524d\u5f80...\u3011\u5373\u53ef")]))),_:1})):x("",!0),w(re,{gutter:20},{default:C((()=>[w(de,{xs:24,sm:24,md:12,lg:12,xl:12},{default:C((()=>[D("div",null,[l[25]||(l[25]=D("div",null,"\u79c1\u94a5(KEY)\uff1a",-1)),w(ne,{style:{"margin-top":"5px"},modelValue:I(c)[0].key,"onUpdate:modelValue":l[7]||(l[7]=e=>I(c)[0].key=e),autosize:{minRows:6,maxRows:8},type:"textarea",disabled:!0},null,8,["modelValue"])])])),_:1}),w(de,{xs:24,sm:24,md:12,lg:12,xl:12},{default:C((()=>[D("div",null,[l[26]||(l[26]=D("div",null,"\u8bc1\u4e66(PEM\u683c\u5f0f)\uff1a",-1)),w(ne,{style:{"margin-top":"5px"},modelValue:I(c)[0].cert,"onUpdate:modelValue":l[8]||(l[8]=e=>I(c)[0].cert=e),autosize:{minRows:6,maxRows:8},type:"textarea",disabled:!0},null,8,["modelValue"])])])),_:1})])),_:1})])):x("",!0),I(N)?(k(),V(we,{key:3,ref_key:"addAcmeAccountFlag",ref:Y,onClosed:l[9]||(l[9]=e=>U(N)?N.value=!1:N=!1),onRefreshData:$},null,512)):x("",!0),I(K)?(k(),V(xe,{key:4,ref_key:"sslApplyLogFlag",ref:J,onClosed:l[10]||(l[10]=e=>U(K)?K.value=!1:K=!1),onRefreshData:X},null,512)):x("",!0)])),[[se,I(n)]])}}},[["__scopeId","data-v-aed8afd4"]]),Re={key:0,style:{display:"flex","align-items":"center",width:"100%"}},Fe={key:1,style:{display:"flex","align-items":"center",width:"100%"}},Ee={key:1},Oe={key:0},Be={key:1},$e=i({__name:"moduleCurrentSSL",props:{id:{type:[Number,String],default:""}},emits:["refreshData","jump"],setup(e,{emit:l}){const a=e,t=d(),o=l;let n=_(!1),i=_({key:"",cert:"",certinfo:{},forceHttps:!1,enableHttps:!1,root_password:"",expire_days:0}),s=_({key:[{required:!0,message:"\u79c1\u94a5(KEY)\u5fc5\u586b",trigger:"blur"}],cert:[{required:!0,message:"\u8bc1\u4e66(PEM\u683c\u5f0f)\u5fc5\u586b",trigger:"blur"}]});function u(e){let l=i.value.enableHttps;i.value.enableHttps=!i.value.enableHttps;let o="\u786e\u5b9a\u8981\u5f00\u542fHTTPS\u5417\uff1f",n="\u5f00\u542f";e?(o="\u786e\u5b9a\u8981\u5f00\u542fHTTPS\u5417\uff1f",n="\u5f00\u542f"):(o="\u786e\u5b9a\u8981\u5173\u95edHTTPS\u5417\uff1f",n="\u5173\u95ed"),Y.confirm(o,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content=`\u6b63\u5728${n}HTTPS...`,r.sysGetSitesManage({id:a.id,action:"set_site_ssl_status",cont:{status:l}}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success("\u8bbe\u7f6e\u6210\u529f"),i.value.enableHttps=!i.value.enableHttps):A.warning(e.msg)}))})).catch((()=>{}))}function c(e){let l=i.value.forceHttps;i.value.forceHttps=!i.value.forceHttps;let o="\u786e\u5b9a\u8981\u5f00\u542f\u5f3a\u5236HTTPS\u5417\uff1f",n="\u5f00\u542f";e?(o="\u786e\u5b9a\u8981\u5f00\u542f\u5f3a\u5236HTTPS\u5417\uff1f",n="\u5f00\u542f"):(o="\u786e\u5b9a\u8981\u5173\u95ed\u5f3a\u5236HTTPS\u5417\uff1f",n="\u5173\u95ed"),Y.confirm(o,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content=`\u6b63\u5728${n}\u5f3a\u5236HTTPS...`,r.sysGetSitesManage({id:a.id,action:"set_site_ssl_forcehttps",cont:{status:l}}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success("\u8bbe\u7f6e\u6210\u529f"),i.value.forceHttps=!i.value.forceHttps):A.warning(e.msg)}))})).catch((()=>{}))}let p=_(null);function m(){p.value.validate((e=>{e&&Y.confirm("\u786e\u5b9a\u8981\u4fdd\u5b58\u8bc1\u4e66\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u8bbe\u7f6e\u8bc1\u4e66...",r.sysGetSitesManage({id:a.id,action:"save_site_ssl_cert",cont:{cert:i.value.cert,key:i.value.key}}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?A.success("\u4fdd\u5b58\u6210\u529f"):A.warning(e.msg)}))})).catch((()=>{}))}))}function f(){"Let's Encrypt"==i.value.certinfo.organization_name&&o("jump","letsencrypt")}return F((()=>{n.value=!0,r.sysGetSitesManage({action:"get_site_cert",id:a.id}).then((e=>{n.value=!1,2e3==e.code?i.value=e.data:A.warning(e.msg)}))})),(e,l)=>{const a=v("el-switch"),t=v("el-form-item"),o=v("el-col"),d=v("el-row"),r=v("el-button"),g=v("el-descriptions-item"),y=v("el-tag"),h=v("el-input"),_=v("el-descriptions"),S=v("el-alert"),j=v("el-form"),U=M("loading");return R((k(),V(j,{inline:!1,model:I(i),rules:I(s),ref_key:"rulesForm",ref:p,"label-position":"top","label-width":"auto"},{default:C((()=>[w(d,null,{default:C((()=>[w(o,{span:6},{default:C((()=>[w(t,{label:"\u542f\u7528HTTPS",prop:"enableHttps","label-position":"right"},{default:C((()=>[w(a,{modelValue:I(i).enableHttps,"onUpdate:modelValue":l[0]||(l[0]=e=>I(i).enableHttps=e),onChange:u},null,8,["modelValue"])])),_:1})])),_:1}),w(o,{span:6},{default:C((()=>[w(t,{label:"\u5f3a\u5236HTTPS",prop:"forceHttps","label-position":"right"},{default:C((()=>[w(a,{modelValue:I(i).forceHttps,"onUpdate:modelValue":l[1]||(l[1]=e=>I(i).forceHttps=e),onChange:c},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),w(_,{title:"\u8bc1\u4e66\u4fe1\u606f",border:!0,column:2,style:{"margin-bottom":"15px"},class:"rydescriptions"},{extra:C((()=>{return[(e=I(i).certinfo.organization_name,"Let's Encrypt"==e?(k(),V(r,{key:0,type:"primary",onClick:f},{default:C((()=>l[5]||(l[5]=[L("\u7eed\u7b7e\u8bc1\u4e66")]))),_:1})):x("",!0))];var e})),default:C((()=>[w(g,{label:"\u7b7e\u540d"},{default:C((()=>[L(P(I(i).certinfo.organization_name||"-"),1)])),_:1}),w(g,{label:"\u8ba4\u8bc1\u57df\u540d/IP"},{default:C((()=>{return[L(P((e=I(i).certinfo,e?e.san_names&&e.san_names.length>0?e.san_names.join("\u3001"):e.common_name:"-")),1)];var e})),_:1}),w(g,{label:"\u8bc1\u4e66\u7c7b\u578b"},{default:C((()=>[I(i).certinfo.common_name?(k(),b("div",Re,[w(y,null,{default:C((()=>[L(P(I(i).certinfo.type||""),1)])),_:1}),"\u81ea\u7b7e\u8bc1\u4e66"==I(i).certinfo.type?(k(),V(r,{key:0,size:"small",type:"primary",style:{"margin-left":"10px","margin-right":"10px"},onClick:e.downlowdFile},{default:C((()=>l[6]||(l[6]=[L("\u70b9\u51fb\u4e0b\u8f7d\u6839\u8bc1\u4e66")]))),_:1},8,["onClick"])):x("",!0),"\u81ea\u7b7e\u8bc1\u4e66"==I(i).certinfo.type?(k(),b("div",Fe,[l[7]||(l[7]=L(" \u8bc1\u4e66\u5bc6\u7801\uff1a ")),w(h,{modelValue:I(i).root_password,"onUpdate:modelValue":l[2]||(l[2]=e=>I(i).root_password=e),size:"small",style:{width:"100px"},disabled:!0},null,8,["modelValue"]),w(Z,{content:I(i).root_password,size:"small"},null,8,["content"])])):x("",!0)])):(k(),b("span",Ee,"-"))])),_:1}),w(g,{label:"\u8fc7\u671f\u65f6\u95f4"},{default:C((()=>[I(i).certinfo.not_valid_after?(k(),b("span",Oe,[L(P(I(i).certinfo.not_valid_after),1),D("span",{style:O({color:I(i).expire_days>25?"var(--el-color-success)":"var(--el-color-danger)"})},"\uff08\u5269\u4f59\uff1a"+P(I(i).expire_days)+"\u5929\uff09",5)])):(k(),b("span",Be,P("-")))])),_:1})])),_:1}),"\u81ea\u7b7e\u8bc1\u4e66"==I(i).certinfo.type?(k(),V(S,{key:0,type:"success"},{default:C((()=>l[8]||(l[8]=[L("\u3010\u81ea\u7b7e\u8bc1\u4e66\u3011\u4e0d\u88ab\u6d4f\u89c8\u5668\u4fe1\u4efb\uff0c\u6d4f\u89c8\u5668\u4f1a\u663e\u793a\u3010\u4e0d\u5b89\u5168...\u3011\u63d0\u793a\uff0c\u4e0b\u8f7d\u6839\u8bc1\u4e66\u6216\u3010\u7ee7\u7eed\u524d\u5f80...\u3011\u5373\u53ef")]))),_:1})):x("",!0),w(d,{gutter:20},{default:C((()=>[w(o,{xs:24,sm:24,md:12,lg:12,xl:12},{default:C((()=>[w(t,{prop:"key"},{label:C((()=>l[9]||(l[9]=[D("span",null,"\u79c1\u94a5(KEY)\uff1a",-1)]))),default:C((()=>[w(h,{modelValue:I(i).key,"onUpdate:modelValue":l[3]||(l[3]=e=>I(i).key=e),autosize:{minRows:6,maxRows:8},type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1}),w(o,{xs:24,sm:24,md:12,lg:12,xl:12},{default:C((()=>[w(t,{prop:"cert"},{label:C((()=>l[10]||(l[10]=[D("span",null,"\u8bc1\u4e66(PEM\u683c\u5f0f)\uff1a",-1)]))),default:C((()=>[w(h,{modelValue:I(i).cert,"onUpdate:modelValue":l[4]||(l[4]=e=>I(i).cert=e),autosize:{minRows:6,maxRows:8},type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),w(t,null,{default:C((()=>[w(r,{type:"primary",onClick:m},{default:C((()=>l[11]||(l[11]=[L("\u4fdd\u5b58\u8bc1\u4e66")]))),_:1})])),_:1}),l[12]||(l[12]=D("div",{class:"ry-cj-care"},[D("li",null,"\u7c98\u8d34\u60a8\u7684\u8bc1\u4e66\u79d8\u94a5KEY\u548c\u8bc1\u4e66PEM\u5185\u5bb9\uff0c\u7136\u540e\u3010\u4fdd\u5b58\u8bc1\u4e66\u3011\u5373\u53ef"),D("li",null,"\u82e5\u65e0\u8bc1\u4e66\uff0c\u53ef\u4f7f\u7528\u3010Let's Encrypt\u3011\u8bc1\u4e66\uff0c\u6709\u6548\u671f90\u5929\uff0c\u8bf7\u6ce8\u610f\u53ca\u65f6\u7eed\u7b7e"),D("li",null,"\u4f7f\u7528Let's Encrypt\u8bc1\u4e66\u4e14\u5373\u5c06\u8fc7\u671f\u65f6\uff0c\u70b9\u51fb\u3010\u7eed\u7b7e\u8bc1\u4e66\u3011\u5373\u53ef"),D("li",null,"\u5982\u542f\u7528HTTPS\u540e\u65e0\u6cd5\u4f7f\u7528HTTPS\u8bbf\u95ee\uff0c\u8bf7\u68c0\u67e5\u670d\u52a1\u5668\u3010\u9632\u706b\u5899\u3011\u6216\u3010\u5b89\u5168\u7ec4\u3011\u662f\u5426\u653e\u901a443\u7aef\u53e3")],-1))])),_:1},8,["model","rules"])),[[U,I(n)]])}}},[["__scopeId","data-v-850aa927"]]),qe={class:"ruyi-inner-ssl"},Ge=i({__name:"moduleNginxSSL",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){d();const a=e;let t=_("current");function o(e){}function n(e){t.value=e}return(e,l)=>{const i=v("el-tab-pane"),d=v("el-tabs");return k(),b("div",qe,[w(d,{modelValue:I(t),"onUpdate:modelValue":l[0]||(l[0]=e=>U(t)?t.value=e:t=e),onTabClick:o,"tab-position":"top",type:"card"},{default:C((()=>[w(i,{label:"\u5f53\u524d\u8bc1\u4e66",name:"current"},{default:C((()=>["current"==I(t)?(k(),V($e,{key:0,id:a.id,onJump:n},null,8,["id"])):x("",!0)])),_:1}),w(i,{label:"Let's Encrypt",name:"letsencrypt"},{default:C((()=>["letsencrypt"==I(t)?(k(),V(Me,{key:0,id:a.id},null,8,["id"])):x("",!0)])),_:1})])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-471e1fb4"]]),He={class:"lyflex"},ze={class:"lyflex"},Ne={class:"lyflex"},Ae=i({__name:"moduleNginxAntiChain",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=d(),t=e;let o=_({status:!1,exts:"js,css,png,jpg,jpeg,gif,ico,bmp,swf,eot,svg,ttf,woff,woff2",noReferer:!0,domains:"",returnCode:"404"}),n=_({exts:[{required:!0,message:"\u8bf7\u8f93\u5165\u6269\u5c55\u540d",trigger:"blur"}],domains:[{required:!0,message:"\u8bf7\u8f93\u5165\u5141\u8bb8\u7684\u57df\u540d",trigger:"change"}],returnCode:[{required:!0,message:"\u8bf7\u8f93\u5165\u54cd\u5e94\u8d44\u6e90",trigger:"blur"}]});let i=_(null);function s(){i.value.validate((e=>{if(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e=o.value;e.domains=e.domains.replace(/\n/g,",");let l={action:"set_site_antichain",id:t.id,cont:e};r.sysGetSitesManage(l).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?A.success(e.msg):A.warning(e.msg)}))}}))}return F((()=>{!function(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="";let e={action:"get_site_antichain",id:t.id};r.sysGetSitesManage(e).then((e=>{if(a.loadingInfo.isLoading=!1,2e3===e.code){let l=e.data;l.domains=l.domains.replace(/,/g,"\n"),o.value=l}else A.warning(e.msg)}))}()})),(e,l)=>{const a=v("el-switch"),t=v("el-form-item"),d=v("InfoFilled"),r=v("el-icon"),u=v("el-tooltip"),c=v("el-input"),p=v("el-form"),m=v("el-button"),f=v("el-col"),g=v("el-row");return k(),V(g,{gutter:20},{default:C((()=>[w(f,{xs:24,sm:20,md:20,lg:20,xl:20},{default:C((()=>[w(p,{model:I(o),rules:I(n),ref_key:"rulesForm",ref:i,"label-position":"right","label-width":"auto",style:{"margin-left":"10px"}},{default:C((()=>[w(t,{label:"\u542f\u7528\u9632\u76d7\u94fe"},{default:C((()=>[w(a,{modelValue:I(o).status,"onUpdate:modelValue":l[0]||(l[0]=e=>I(o).status=e)},null,8,["modelValue"])])),_:1}),w(t,{label:"\u6269\u5c55\u540d",prop:"exts"},{label:C((()=>[D("div",He,[l[5]||(l[5]=D("div",{style:{"margin-right":"3px"}},"\u6269\u5c55\u540d",-1)),w(u,{effect:"dark",content:"\u6587\u4ef6\u540e\u7f00,\u4f7f\u7528','\u5206\u9694,\u5982: png,jpg",placement:"top-start"},{default:C((()=>[w(r,null,{default:C((()=>[w(d)])),_:1})])),_:1})])])),default:C((()=>[w(c,{modelValue:I(o).exts,"onUpdate:modelValue":l[1]||(l[1]=e=>I(o).exts=e),type:"text"},null,8,["modelValue"])])),_:1}),w(t,{label:"\u5141\u8bb8\u7a7a\u6765\u6e90",prop:"noReferer"},{label:C((()=>[D("div",ze,[l[6]||(l[6]=D("div",{style:{"margin-right":"3px"}},"\u5141\u8bb8\u7a7a\u6765\u6e90",-1)),w(u,{effect:"dark",content:"\u5141\u8bb8\u7a7aHTTP_REFERER\u7684header\u8bf7\u6c42",placement:"top-start"},{default:C((()=>[w(r,null,{default:C((()=>[w(d)])),_:1})])),_:1})])])),default:C((()=>[w(a,{modelValue:I(o).noReferer,"onUpdate:modelValue":l[2]||(l[2]=e=>I(o).noReferer=e)},null,8,["modelValue"])])),_:1}),w(t,{label:"\u5141\u8bb8\u57df\u540d",prop:"domains"},{default:C((()=>[w(c,{modelValue:I(o).domains,"onUpdate:modelValue":l[3]||(l[3]=e=>I(o).domains=e),placeholder:"\u4e00\u884c\u4e00\u4e2a\u57df\u540d",type:"textarea",autosize:{minRows:6,maxRows:20}},null,8,["modelValue"])])),_:1}),w(t,{label:"\u54cd\u5e94\u8d44\u6e90",prop:"returnCode"},{label:C((()=>[D("div",Ne,[l[7]||(l[7]=D("div",{style:{"margin-right":"3px"}},"\u54cd\u5e94\u8d44\u6e90",-1)),w(u,{effect:"dark",content:"\u4e00\u822c\u8bbe\u7f6e\u4e3a404/403\u7b49\u72b6\u6001\u7801\uff0c\u4e5f\u53ef\u4e3a\u4e00\u4e2a\u8d44\u6e90(URI\u8def\u5f84\u5982\uff1a/ry.jpg)",placement:"top-start"},{default:C((()=>[w(r,null,{default:C((()=>[w(d)])),_:1})])),_:1})])])),default:C((()=>[w(c,{modelValue:I(o).returnCode,"onUpdate:modelValue":l[4]||(l[4]=e=>I(o).returnCode=e),type:"text",maxlength:35},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),w(m,{type:"primary",onClick:s,style:{float:"right"}},{default:C((()=>l[8]||(l[8]=[L("\u4fdd\u5b58\u5e76\u91cd\u8f7d")]))),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-075ced4a"]]),Ye={class:"lyWebSettingsDialog"},We={style:{display:"flex",width:"100%"}},Ke={style:{display:"flex"}},Je={style:{"margin-right":"10px","margin-left":"30px"}},Ze={style:{"margin-right":"10px","margin-left":"30px"}},Qe=i({__name:"nginxSettings",props:{data:{type:Object}},emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=d(),o=a;let n=_(""),i=_(!1),u=_(!1),c=_(!1),p=_(null),m=_(null),f=_(!1),g=_(null),y=_(!1),h=_(null),S=_({id:null,name:"",path:"",error_log:"",access_log:"",is_error_log:!0,is_access_log:!0,status:!1,conf:"",oldConf:"",tmpDomains:"",defaultDocs:""}),j=_([]);let M=_({tmpDomains:[{required:!0,trigger:"change",validator:function(e,l,a){const t=l.split("\n");let o=!0,n="";t.forEach(((e,l)=>{""!==e&&(function(e){return/^([\w\-\*]{1,150}\.){1,8}([\w\-]{1,30}|[\w\-]{1,30}\.[\w\-]{1,24})(?::\d{1,5})?$/.test(e)}(e)||function(e){return/^(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?::\d{1,5})?$/.test(e)}(e)||(o=!1,n=`\u7b2c${l+1}\u884c\u683c\u5f0f\u4e0d\u6b63\u786e: ${e}`))})),o?a():a(new Error(n))}}]});function R(){o("closed")}let F=_("baseSettings");let E=_(null);function O(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u9519\u8bef\u65e5\u5fd7...",r.sysGetSitesManage({id:S.value.id,action:"get_site_log",op:"error_log"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(S.value.error_log=e.data,T((()=>{E.value&&E.value.scrollToBottom()}))):A.warning(e.msg)}))}let B=_(null);function $(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u8bbf\u95ee\u65e5\u5fd7...",r.sysGetSitesManage({id:S.value.id,action:"get_site_log",op:"error_log"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(S.value.access_log=e.data,T((()=>{B.value&&B.value.scrollToBottom()}))):A.warning(e.msg)}))}function q(e){let l=S.value.is_error_log;S.value.is_error_log=!S.value.is_error_log;let a="\u786e\u5b9a\u8981\u5173\u95ed\u9519\u8bef\u65e5\u5fd7\u5417\uff1f";a=e?"\u786e\u5b9a\u8981\u5f00\u542f\u9519\u8bef\u65e5\u5fd7\u5417\uff1f":"\u786e\u5b9a\u8981\u5173\u95ed\u9519\u8bef\u65e5\u5fd7\u5417\uff1f",Y.confirm(a,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{r.sysGetSitesManage({id:S.value.id,status:l,action:"site_log_open",op:"error_log"}).then((l=>{2e3==l.code?(A.success("\u4fee\u6539\u6210\u529f"),S.value.is_error_log=e):A.warning(l.msg)}))})).catch((()=>{}))}function G(e){let l=S.value.is_access_log;S.value.is_access_log=!S.value.is_access_log;let a="\u786e\u5b9a\u8981\u5173\u95ed\u8bbf\u95ee\u65e5\u5fd7\u5417\uff1f";a=e?"\u786e\u5b9a\u8981\u5f00\u542f\u8bbf\u95ee\u65e5\u5fd7\u5417\uff1f":"\u786e\u5b9a\u8981\u5173\u95ed\u8bbf\u95ee\u65e5\u5fd7\u5417\uff1f",Y.confirm(a,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{r.sysGetSitesManage({id:S.value.id,status:l,action:"site_log_open",op:"access_log"}).then((e=>{2e3==e.code?(A.success("\u4fee\u6539\u6210\u529f"),S.value.is_access_log=!S.value.is_access_log):A.warning(e.msg)}))})).catch((()=>{}))}function H(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u57df\u540d\u5217\u8868...",r.sysGetSitesDomainList({site:S.value.id}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?j.value=e.data.data:A.warning(e.msg)}))}function W(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="",r.sysGetSitesManage({id:S.value.id,action:"get_site_base"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(S.value.path=e.data.path,S.value.defaultDocs=e.data.indexDocs.replace(/,/g,"\n")):A.warning(e.msg)}))}function K(e){"baseSettings"==e.props.name?W():"domainSettings"==e.props.name?H():"error_log"==e.props.name?O():"access_log"==e.props.name?$():"edit_conf"===e.props.name&&(t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6...",r.sysGetSitesManage({id:S.value.id,action:"get_site_conf"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(S.value.conf=e.data,S.value.oldConf=e.data):A.warning(e.msg)})))}function Z(){if(S.value.oldConf==S.value.conf)return void A.warning("\u914d\u7f6e\u6587\u4ef6\u672a\u53d8\u52a8\uff0c\u65e0\u9700\u4fdd\u5b58!!!");if(""==S.value.conf||null==S.value.conf)return void A.warning("\u914d\u7f6e\u6587\u4ef6\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u914d\u7f6e");Y.confirm("\u786e\u5b9a\u8981\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\u5417\uff1f","\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6...",r.sysGetSitesManage({id:S.value.id,conf:S.value.conf,action:"save_site_conf"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?A.success("\u4fdd\u5b58\u6210\u529f,\u5e76\u91cd\u8f7d\u914d\u7f6e"):A.warning(e.msg)}))})).catch((()=>{}))}function Q(e){e?(clearInterval(p.value),p.value=setInterval((()=>{O()}),5e3)):(clearInterval(p.value),p.value=null)}function X(e){e?(clearInterval(m.value),m.value=setInterval((()=>{$()}),5e3)):(clearInterval(m.value),m.value=null)}let ee=_(null);function le(){ee.value.validate((e=>{if(e){const e=S.value.tmpDomains.split("\n");let l={action:"add_site_domain",id:S.value.id,domainList:e};t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u6dfb\u52a0\u57df\u540d...",r.sysSitesDomainMg(l).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),S.value.tmpDomains="",ee.value.resetFields(),H()):A.warning(e.msg)}))}}))}function ae(e){f.value=e}function te(){y.value=!0,T((()=>{g.value.handleOpen({path:S.value.path,isDir:!0},"\u76ee\u5f55\u9009\u62e9")}))}function oe(e){S.value.path=e}function ne(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_path",id:S.value.id,path:S.value.path};r.sysGetSitesManage(e).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),h.value.path=S.value.path):A.warning(e.msg)}))}function ie(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_indexdoc",id:S.value.id,indexdoc:S.value.defaultDocs.replace(/\n/g,",")};r.sysGetSitesManage(e).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),W()):A.warning(e.msg)}))}return l({handleOpen:function(e,l){n.value=l,i=!0,e&&(h.value=s(e),S.value.id=h.value.id,S.value.name=h.value.name,S.value.status=h.value.status,S.value.path=h.value.path,S.value.is_error_log=h.value.error_log,S.value.is_access_log=h.value.access_log,"baseSettings"==F.value&&W())}}),(e,l)=>{const a=v("el-button"),o=v("el-input"),d=v("el-form-item"),s=v("el-col"),p=v("el-row"),m=v("el-tab-pane"),h=v("el-form"),_=v("el-link"),T=v("el-table-column"),O=v("el-table"),$=v("el-switch"),W=v("InfoFilled"),de=v("el-icon"),re=v("el-tooltip"),se=v("el-tabs"),ue=v("el-main");return k(),b("div",Ye,[w(z,{modelValue:I(i),"onUpdate:modelValue":l[12]||(l[12]=e=>U(i)?i.value=e:i=e),title:I(n),width:"60%","before-close":R,onOnChangeFullScreen:ae},{default:C((()=>[w(ue,null,{default:C((()=>[w(se,{"tab-position":"left",modelValue:I(F),"onUpdate:modelValue":l[10]||(l[10]=e=>U(F)?F.value=e:F=e),onTabClick:K},{default:C((()=>[w(m,{label:"\u57fa\u672c\u8bbe\u7f6e",name:"baseSettings"},{default:C((()=>[w(p,{gutter:20},{default:C((()=>[w(s,{xs:24,sm:20,md:20,lg:20,xl:20,style:{"padding-left":"20px"}},{default:C((()=>[w(d,{label:"\u7f51\u7ad9\u76ee\u5f55\uff1a",class:"is-required"},{default:C((()=>[D("div",We,[w(o,{modelValue:I(S).path,"onUpdate:modelValue":l[0]||(l[0]=e=>I(S).path=e)},{append:C((()=>[w(a,{onClick:te,icon:"Folder",class:"panelsave"},{default:C((()=>l[13]||(l[13]=[L("\u9009\u62e9")]))),_:1})])),_:1},8,["modelValue"]),w(a,{type:"primary",style:{"margin-left":"20px"},onClick:ne},{default:C((()=>l[14]||(l[14]=[L("\u4fdd\u5b58")]))),_:1})])])),_:1}),D("div",Ke,[w(d,{label:"\u9ed8\u8ba4\u6587\u6863\uff1a",prop:"defaultDocs",class:"is-required",style:{width:"100%"}},{default:C((()=>[w(o,{modelValue:I(S).defaultDocs,"onUpdate:modelValue":l[1]||(l[1]=e=>I(S).defaultDocs=e),autosize:{minRows:5,maxRows:8},type:"textarea",placeholder:"\u8bf7\u8f93\u5165\u9ed8\u8ba4\u6587\u6863\u540d\u79f0\uff0c\u4e00\u884c\u4e00\u4e2a\n\u683c\u5f0f\uff1aindex.html",clearable:""},null,8,["modelValue"])])),_:1}),w(d,null,{default:C((()=>[w(a,{type:"primary",onClick:ie,style:{"margin-left":"20px"}},{default:C((()=>l[15]||(l[15]=[L("\u4fdd\u5b58")]))),_:1})])),_:1})])])),_:1})])),_:1})])),_:1}),w(m,{label:"\u57df\u540d\u8bbe\u7f6e",name:"domainSettings"},{default:C((()=>[w(h,{inline:!0,model:I(S),rules:I(M),ref_key:"rulesForm",ref:ee,"label-position":"right","label-width":"auto",style:{"margin-bottom":"20px"}},{default:C((()=>[w(d,{label:"\u57df\u540d\uff1a",prop:"tmpDomains",style:{width:"80%"}},{default:C((()=>[w(o,{modelValue:I(S).tmpDomains,"onUpdate:modelValue":l[2]||(l[2]=e=>I(S).tmpDomains=e),autosize:{minRows:5,maxRows:8},type:"textarea",placeholder:"\u8bf7\u8f93\u5165\u7f51\u7ad9\u57df\u540d\uff0c\u652f\u6301\u591a\u4e2a\uff08\u57df\u540d\u3001IP)+\u7aef\u53e3\uff08\u9ed8\u8ba480\uff09\uff0c\u4e00\u884c\u4e00\u4e2a\n\u57df\u540d\u683c\u5f0f1\uff1awww.lybbn.cn\n\u57df\u540d\u683c\u5f0f2\uff1awww.lybbn.cn:8080\nIP\u683c\u5f0f\uff1a192.168.1.1:8080\n\u6cdb\u89e3\u6790\uff1a*.lybbn.cn",clearable:""},null,8,["modelValue"])])),_:1}),w(d,null,{default:C((()=>[w(a,{type:"primary",onClick:le},{default:C((()=>l[16]||(l[16]=[L("\u4fdd\u5b58")]))),_:1})])),_:1})])),_:1},8,["model","rules"]),w(O,{border:"",data:I(j),"max-height":"500"},{default:C((()=>[w(T,{prop:"name",label:"\u57df\u540d","min-width":"200","show-overflow-tooltip":""},{default:C((e=>[w(_,{type:"primary",href:"http://"+e.row.name,target:"_blank"},{default:C((()=>[L(P(e.row.name),1)])),_:2},1032,["href"])])),_:1}),w(T,{prop:"port",label:"\u7aef\u53e3","min-width":"100"}),w(T,{fixed:"right",label:"\u64cd\u4f5c",width:"100"},{default:C((e=>[w(a,{link:"",type:"primary",onClick:l=>{return a=e.row,void Y.confirm("\u786e\u8ba4\u8981\u5220\u9664\u8be5\u57df\u540d\u5417\uff1f","\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,r.sysSitesDomainMg({sid:S.value.id,id:a.id,domain:a.name,port:a.port,action:"del_site_domain"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),H()):A.warning(e.msg)}))})).catch((()=>{}));var a},disabled:I(j).length<2},{default:C((()=>l[17]||(l[17]=[L("\u5220\u9664")]))),_:2},1032,["onClick","disabled"])])),_:1})])),_:1},8,["data"])])),_:1}),w(m,{label:"SSL\u8bbe\u7f6e",name:"ssl"},{default:C((()=>["ssl"==I(F)?(k(),V(Ge,{key:0,class:"ruyiSSLMg",id:I(S).id},null,8,["id"])):x("",!0)])),_:1}),w(m,{label:"\u53cd\u5411\u4ee3\u7406",name:"proxy"},{default:C((()=>["proxy"==I(F)?(k(),V(be,{key:0,class:"ruyiNginxRedirect",id:I(S).id},null,8,["id"])):x("",!0)])),_:1}),w(m,{label:"\u6d41\u91cf\u9650\u5236",name:"lllimit"},{default:C((()=>["lllimit"==I(F)?(k(),V(ve,{key:0,id:I(S).id},null,8,["id"])):x("",!0)])),_:1}),w(m,{label:"\u9632\u76d7\u94fe",name:"fangdao"},{default:C((()=>["fangdao"==I(F)?(k(),V(Ae,{key:0,id:I(S).id},null,8,["id"])):x("",!0)])),_:1}),w(m,{label:"\u91cd\u5b9a\u5411",name:"redirect"},{default:C((()=>["redirect"==I(F)?(k(),V(_e,{key:0,class:"ruyiNginxRedirect",id:I(S).id},null,8,["id"])):x("",!0)])),_:1}),w(m,{label:"\u914d\u7f6e\u6587\u4ef6",name:"edit_conf"},{default:C((()=>[w(J,{modelValue:I(S).conf,"onUpdate:modelValue":l[3]||(l[3]=e=>I(S).conf=e),fontSize:"13px",placeholder:I(S).conf?"":"\u672a\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6",showLineNums:!0,lineWrapping:!0,mode:"javascript",height:I(f)?"80vh":"60vh","read-only":!1,ref:"lyCodemirrorConf"},null,8,["modelValue","placeholder","height"]),w(a,{type:"primary",style:{"margin-top":"10px","margin-bottom":"10px"},onClick:Z},{default:C((()=>l[18]||(l[18]=[L("\u4fdd\u5b58\u5e76\u91cd\u8f7d")]))),_:1}),l[19]||(l[19]=D("div",{class:"ry-cj-care"},[D("li",null,"\u82e5\u60a8\u4e0d\u4e86\u89e3Nginx\u7684\u914d\u7f6e\u6587\u4ef6\u89c4\u5219\uff0c\u8bf7\u52ff\u968f\u610f\u4fee\u6539!!!"),D("li",null,"\u5feb\u6377\u952e CTRL+F \u67e5\u627e\u548c\u66ff\u6362\u5185\u5bb9")],-1))])),_:1}),w(m,{label:"\u9519\u8bef\u65e5\u5fd7",name:"error_log"},{default:C((()=>[D("div",null,[l[21]||(l[21]=D("span",{style:{"margin-right":"10px"}},"\u65e5\u5fd7\u5f00\u5173",-1)),w($,{modelValue:I(S).is_error_log,"onUpdate:modelValue":l[4]||(l[4]=e=>I(S).is_error_log=e),onChange:q},null,8,["modelValue"]),D("span",Je,[l[20]||(l[20]=L(" \u5b9a\u65f6\u5237\u65b0 ")),w(re,{effect:"dark",content:"\u9ed8\u8ba45\u79d2\u5237\u65b0\u4e00\u6b21",placement:"top-start"},{default:C((()=>[w(de,null,{default:C((()=>[w(W)])),_:1})])),_:1})]),w($,{modelValue:I(u),"onUpdate:modelValue":l[5]||(l[5]=e=>U(u)?u.value=e:u=e),onChange:Q},null,8,["modelValue"])]),w(J,{modelValue:I(S).error_log,"onUpdate:modelValue":l[6]||(l[6]=e=>I(S).error_log=e),fontSize:"13px",placeholder:I(S).error_log?"":"\u5f53\u524d\u6ca1\u6709\u9519\u8bef\u65e5\u5fd7\uff01",showLineNums:!1,lineWrapping:!1,mode:"log",height:I(f)?"86vh":"65vh","read-only":!0,ref_key:"lyCodemirrorErrorLog",ref:E},null,8,["modelValue","placeholder","height"])])),_:1}),w(m,{label:"\u8bbf\u95ee\u65e5\u5fd7",name:"access_log"},{default:C((()=>[D("div",null,[l[23]||(l[23]=D("span",{style:{"margin-right":"10px"}},"\u65e5\u5fd7\u5f00\u5173",-1)),w($,{modelValue:I(S).is_access_log,"onUpdate:modelValue":l[7]||(l[7]=e=>I(S).is_access_log=e),onChange:G},null,8,["modelValue"]),D("span",Ze,[l[22]||(l[22]=L(" \u5b9a\u65f6\u5237\u65b0 ")),w(re,{effect:"dark",content:"\u9ed8\u8ba45\u79d2\u5237\u65b0\u4e00\u6b21",placement:"top-start"},{default:C((()=>[w(de,null,{default:C((()=>[w(W)])),_:1})])),_:1})]),w($,{modelValue:I(c),"onUpdate:modelValue":l[8]||(l[8]=e=>U(c)?c.value=e:c=e),onChange:X},null,8,["modelValue"])]),w(J,{modelValue:I(S).access_log,"onUpdate:modelValue":l[9]||(l[9]=e=>I(S).access_log=e),fontSize:"13px",placeholder:I(S).error_log?"":"\u5f53\u524d\u6ca1\u6709\u8bbf\u95ee\u65e5\u5fd7\uff01",showLineNums:!1,lineWrapping:!1,mode:"log",height:I(f)?"86vh":"65vh","read-only":!0,ref_key:"lyCodemirrorAccessLog",ref:B},null,8,["modelValue","placeholder","height"])])),_:1})])),_:1},8,["modelValue"])])),_:1}),I(y)?(k(),V(N,{key:0,class:"ruyidirchoice",ref_key:"choosePathDirFlag",ref:g,onChange:oe,onClosed:l[11]||(l[11]=e=>U(y)?y.value=!1:y=!1)},null,512)):x("",!0)])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-1757eb11"]]),Xe={class:"handle-top"},el={class:"search-sites-input"},ll={class:"lyczj",style:{display:"flex","align-items":"center"}},al=["onClick"],tl={key:0,style:{"font-size":"12px","font-weight":"bold"}},ol={key:0},nl={key:1},il={key:0},dl={key:1},rl={key:0},sl={key:1},ul={key:6,class:"softmask"},cl={key:7,class:"soft-ins-guide-dialog"},pl=i({__name:"index",props:{installed:{type:Boolean,default:!1},status:{type:Boolean,default:!1}},setup(e,{expose:l}){const a=K(),t=d(),o=y();let i=B((()=>o.ismobile)),s=_(!1),u=_(null),c=_(!1),p=_(null),m=_(!1),f=_(null),g=_(!1),F=_([{id:0,name:"\u9ed8\u8ba4\u5206\u7ec4"}]),E=_({page:1,limit:10}),G=_({page:1,limit:10,total:0}),z=_([]);function N(e){E.value.page=e.page,E.value.limit=e.limit,W()}function W(){s.value=!0;let e=n({},E.value);e.module=0,r.sysGetSitesList(e).then((e=>{s.value=!1,2e3===e.code&&(e.data.data.forEach((e=>{e.showEndDate=!1})),z.value=e.data.data,G.value.page=e.data.page,G.value.limit=e.data.limit,G.value.total=e.data.total)}))}function J(){E.value.page=1,W()}let Z=_(!1),Q=_(null);function X(){Z.value=!0,T((()=>{Q.value.handleOpen(null,"\u6dfb\u52a0\u7ad9\u70b9")}))}let le=_(null),ae=_(!1);function te(){ae.value=!0,T((()=>{le.value.handleOpen(null,"\u7ad9\u70b9\u5206\u7ec4\u7ba1\u7406")}))}function de(e){c.value=!0,T((()=>{u.value.handleOpen(e,`\u7ad9\u70b9\u3010${e.name}\u3011\u8bbe\u7f6e`)}))}function re(e,l){let a="\u786e\u5b9a\u542f\u52a8\u7ad9\u70b9\u5417\uff1f";"stop"==e&&(a="\u505c\u6b62\u7ad9\u70b9\u540e\uff0c\u8bbf\u95ee\u8be5\u7ad9\u70b9\u4f1a\u663e\u793a\u5f53\u524d\u7ad9\u70b9\u505c\u6b62\u9875\u9762\uff0c\u662f\u5426\u7ee7\u7eed\uff1f"),Y.confirm(`${a}`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{t.loadingInfo.isLoading=!0,r.sysGetSitesManage({id:l,op:e,action:"status_static_site"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),W()):A.warning(e.msg)}))})).catch((()=>{}))}function ue(){g.value=!0,T((()=>{f.value.handleOpen(null,"\u9ed8\u8ba4\u7ad9\u70b9\u8bbe\u7f6e")}))}let ce=_(!1),pe=_(null);function me(){a.push({path:"/appstore"})}return l({RefreshData:function(){T((()=>{r.sysSitegroup({page:1,limit:999}).then((e=>{2e3===e.code&&(F.value=e.data.data)})),W()}))}}),(l,o)=>{const n=v("el-button"),d=v("arrow-down"),y=v("el-icon"),_=v("el-dropdown-item"),B=v("el-dropdown-menu"),K=v("el-dropdown"),fe=v("el-col"),ge=v("el-option"),ye=v("el-select"),he=v("el-input"),_e=v("el-row"),ve=v("el-link"),be=v("el-table-column"),ke=v("el-tooltip"),we=v("el-text"),Ve=v("el-table"),xe=v("InfoFilled"),Ce=M("loading");return k(),b("div",null,[D("div",Xe,[w(_e,null,{default:C((()=>[w(fe,{xs:24,sm:16,md:16,lg:16,xl:16},{default:C((()=>[w(n,{type:"primary",onClick:X,disabled:!e.status},{default:C((()=>o[11]||(o[11]=[L("\u6dfb\u52a0\u7ad9\u70b9")]))),_:1},8,["disabled"]),w(n,{type:"primary",plain:"",onClick:te},{default:C((()=>o[12]||(o[12]=[L("\u5206\u7ec4")]))),_:1}),w(n,{icon:"refresh",circle:"",onClick:J}),w(K,null,{dropdown:C((()=>[w(B,null,{default:C((()=>[w(_,{onClick:ue},{default:C((()=>o[14]||(o[14]=[L("\u9ed8\u8ba4\u7ad9\u70b9")]))),_:1})])),_:1})])),default:C((()=>[w(n,{plain:""},{default:C((()=>[o[13]||(o[13]=L(" \u9ad8\u7ea7\u8bbe\u7f6e")),w(y,{class:"el-icon--right"},{default:C((()=>[w(d)])),_:1})])),_:1})])),_:1})])),_:1}),w(fe,{xs:24,sm:8,md:8,lg:8,xl:8},{default:C((()=>[D("div",el,[w(ye,{modelValue:I(E).group,"onUpdate:modelValue":o[0]||(o[0]=e=>I(E).group=e),style:{width:"280px","margin-right":"10px"},filterable:"",clearable:""},{prefix:C((()=>o[15]||(o[15]=[L("\u5206\u7ec4")]))),default:C((()=>[(k(!0),b(S,null,j(I(F),(e=>(k(),V(ge,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),w(he,{modelValue:I(E).search,"onUpdate:modelValue":o[1]||(o[1]=e=>I(E).search=e),clearable:"",onClear:o[2]||(o[2]=e=>J()),"suffix-icon":"Search",onKeyup:o[3]||(o[3]=$((e=>J()),["enter"])),onChange:o[4]||(o[4]=e=>J()),placeholder:"\u641c\u7d22"},null,8,["modelValue"])])])),_:1})])),_:1})]),R((k(),V(Ve,{data:I(z),style:{width:"100%","border-top":"1px solid var(--el-border-color-lighter)"},"header-cell-class-name":"table-header-style"},{default:C((()=>[w(be,{prop:"name",label:"\u540d\u79f0","min-width":"180"},{default:C((e=>[w(ve,{type:"primary",underline:!1,onClick:q((l=>de(e.row)),["stop"])},{default:C((()=>[L(P(e.row.name),1)])),_:2},1032,["onClick"])])),_:1}),w(be,{prop:"status",label:"\u72b6\u6001",width:"130"},{default:C((({row:e})=>[e.status?(k(),V(n,{key:0,link:"",type:"success",icon:"VideoPlay",onClick:l=>re("stop",e.id)},{default:C((()=>o[16]||(o[16]=[L(" \u5df2\u542f\u52a8 ")]))),_:2},1032,["onClick"])):(k(),V(n,{key:1,link:"",type:"danger",icon:"VideoPause",onClick:l=>re("start",e.id)},{default:C((()=>o[17]||(o[17]=[L(" \u5df2\u505c\u6b62 ")]))),_:2},1032,["onClick"]))])),_:1}),w(be,{prop:"path",label:"\u6839\u76ee\u5f55",width:"90"},{default:C((e=>[D("div",ll,[w(ke,{effect:"dark",content:e.row.path,placement:"bottom"},{default:C((()=>[D("img",{class:"ruyi-fileicons",src:h,onClick:l=>{var o;(o=e.row).path&&(t.fileInfo.currentDir=o.path,a.push({path:"/files"}))}},null,8,al)])),_:2},1032,["content"]),e.row.is_default?(k(),b("span",tl,"(\u9ed8\u8ba4\u7ad9)")):x("",!0)])])),_:1}),w(be,{label:"\u5907\u4efd",width:"100"},{default:C((e=>[w(we,{type:e.row.bakNums<1?"info":"primary",style:{cursor:"pointer"},onClick:l=>{return a=e.row,ce.value=!0,void T((()=>{pe.value.handleOpen(a,"\u3010"+a.name+"\u3011\u7ad9\u70b9\u5907\u4efd")}));var a}},{default:C((()=>[e.row.bakNums<1?(k(),b("span",ol,"\u65e0")):x("",!0),o[18]||(o[18]=L("\u5907\u4efd")),e.row.bakNums>0?(k(),b("span",nl,P("("+e.row.bakNums+")"),1)):x("",!0)])),_:2},1032,["type","onClick"])])),_:1}),w(be,{prop:"endTime",label:"\u5230\u671f\u65f6\u95f4","min-width":"100"},{default:C((({row:e,$index:l})=>[w(ve,{type:"primary",underline:!1,onClick:l=>function(e){m.value=!0,T((()=>{p.value.handleOpen(e,`\u3010${e.name}\u3011\u4fee\u6539\u5230\u671f\u65f6\u95f4`)}))}(e)},{default:C((()=>[e.endTime?(k(),b("span",dl,P(e.endTime),1)):(k(),b("span",il," \u6c38\u4e0d\u8fc7\u671f "))])),_:2},1032,["onClick"])])),_:1}),w(be,{prop:"sslinfo",label:"SSL",width:"100"},{default:C((e=>[e.row.sslinfo.enableHttps?(k(),b("span",rl,[D("span",{style:O({color:e.row.sslinfo.expire_days>25?"var(--el-color-success)":"var(--el-color-danger)"})},"\u5269\u4f59"+P(e.row.sslinfo.expire_days)+"\u5929",5)])):(k(),b("span",sl))])),_:1}),w(be,{prop:"remark",label:"\u5907\u6ce8","min-width":"100","show-overflow-tooltip":""}),w(be,{prop:"create_at",label:"\u521b\u5efa\u65f6\u95f4","min-width":"170"}),w(be,{fixed:!I(i)&&"right",label:"\u64cd\u4f5c",width:"130"},{default:C((e=>[w(n,{link:"",type:"primary",onClick:l=>de(e.row)},{default:C((()=>o[19]||(o[19]=[L("\u914d\u7f6e")]))),_:2},1032,["onClick"]),w(n,{link:"",type:"primary",onClick:l=>{return a=e.row,void Y.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${a.name}\u3011\u7ad9\u70b9\u5417\uff1f\u6b64\u64cd\u4f5c\u4f1a\u5220\u9664\u8be5\u7f51\u7ad9\u7684\u65e5\u5fd7\u3001\u7ad9\u70b9\u76ee\u5f55\u3001\u914d\u7f6e\u4fe1\u606f\u7b49\uff01\uff01\uff01`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,r.sysGetSitesManage({id:a.id,action:"del_static_site"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),W()):A.warning(e.msg)}))})).catch((()=>{}));var a}},{default:C((()=>o[20]||(o[20]=[L("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1},8,["fixed"])])),_:1},8,["data"])),[[Ce,I(s)]]),w(H,{small:!0,"child-msg":I(G),onCallFather:N,border:!1,position:"right"},null,8,["child-msg"]),I(Z)?(k(),V(ee,{key:0,ref_key:"moduleAddFlag",ref:Q,onRefreshData:W,onClosed:o[5]||(o[5]=e=>U(Z)?Z.value=!1:Z=!1)},null,512)):x("",!0),I(ae)?(k(),V(oe,{key:1,ref_key:"moduleGroupFlag",ref:le,onClosed:o[6]||(o[6]=e=>U(ae)?ae.value=!1:ae=!1)},null,512)):x("",!0),I(c)?(k(),V(Qe,{key:2,ref_key:"nginxSettingsFlag",ref:u,onClosed:o[7]||(o[7]=e=>U(c)?c.value=!1:c=!1)},null,512)):x("",!0),I(m)?(k(),V(ne,{key:3,ref_key:"endTimeFlag",ref:p,onRefreshData:W,onClosed:o[8]||(o[8]=e=>U(m)?m.value=!1:m=!1)},null,512)):x("",!0),I(g)?(k(),V(ie,{key:4,ref_key:"defaultSiteFlag",ref:f,onRefreshData:W,onClosed:o[9]||(o[9]=e=>U(g)?g.value=!1:g=!1)},null,512)):x("",!0),I(ce)?(k(),V(se,{key:5,ref_key:"moduleBackupFlag",ref:pe,onRefreshData:W,onClosed:o[10]||(o[10]=e=>U(ce)?ce.value=!1:ce=!1)},null,512)):x("",!0),e.installed?x("",!0):(k(),b("div",ul)),e.installed?x("",!0):(k(),b("div",cl,[w(y,{size:20,color:"var(--el-color-danger)",style:{"margin-right":"10px"}},{default:C((()=>[w(xe)])),_:1}),o[22]||(o[22]=L(" \u5f53\u524d\u672a\u5b89\u88c5Web\u670d\u52a1\u5668\u73af\u5883 ")),w(n,{type:"primary",link:"",style:{"margin-left":"10px","font-size":"15px"},onClick:me},{default:C((()=>o[21]||(o[21]=[L("\u53bb\u5546\u5e97\u5b89\u88c5")]))),_:1})]))])}}},[["__scopeId","data-v-db592944"]]),ml={style:{display:"flex","align-items":"center",width:"100%"}},fl={style:{width:"150px","padding-left":"20px"}},gl={style:{display:"flex","align-items":"center",width:"100%"}},yl={style:{display:"flex","align-items":"center",width:"100%"}},hl={style:{display:"flex","align-items":"center",width:"100%"}},_l={style:{width:"150px","padding-left":"20px"}},vl={style:{background:"var(--el-fill-color-darker)",width:"100%","word-break":"break-all"}},bl=i({__name:"moduleAdd",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=K(),o=d(),i=a;let u=B((()=>"windows"==o.sysConfig.currentOs)),c=_(!1),p=_(!1),m=_("\u6dfb\u52a0Python\u9879\u76ee"),f=_({name:"",remark:"",path:"",group:0,type:1,project_cfg:{advanced:!1,version:"",requirements:"",install_reqs:!1,rukou:"",port:"",allowport:!1,start_method:"command",start_user:"root",start_command:"",sgi:"wsgi",framework:"python",application:"",protocol:"http",host:"127.0.0.1",autostart:!0}});G((()=>f.value.project_cfg.sgi),((e,l)=>{const a=f.value.project_cfg;if("django"==a.framework){if(a.application){let t=a.application.replace(l,e);f.value.project_cfg.application=t}if(a.rukou){let l="wsgi"==e?"asgi.py":"wsgi.py",t=a.rukou.replace(l,e+".py");f.value.project_cfg.rukou=t}}}));let g=B((()=>{const e=f.value.project_cfg;if(!f.value.path)return"";if("python"===f.value.framework)return"";{let l=e.port?e.port:"\u7aef\u53e3\u672a\u914d\u7f6e",a=e.application?e.application:"\u5e94\u7528\u672a\u914d\u7f6e";if("daphne"===e.start_method)return`${e.start_method} -b 127.0.0.1 -p ${l} ${a}`;if("uwsgi"===e.start_method)return`${e.start_method} --http 127.0.0.1:${l} --module ${a}`;if("gunicorn"===e.start_method)return"wsgi"==e.sgi?`${e.start_method} --bind 127.0.0.1:${l} ${a}`:"asgi"==e.sgi?`${e.start_method} --bind 127.0.0.1:${l} ${a} -k uvicorn.workers.UvicornWorker`:`${e.start_method} --bind 127.0.0.1:${l} ${a}`}}));_([{id:0,name:"\u9ed8\u8ba4\u5206\u7ec4"}]);let y=_([]),h=_(!1),M=_(null),R=_(null),F=_(!1),E=_(null),O=_(!1);let $=_({name:[{required:!0,message:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u79f0",trigger:"blur"}],path:[{required:!0,message:"\u8bf7\u9009\u62e9\u9879\u76ee\u6839\u76ee\u5f55",trigger:"blur"}],"project_cfg.version":[{required:!0,message:"\u8bf7\u9009\u62e9Python\u7248\u672c",trigger:"blur"}]}),q=_([{required:!0,validator:function(e,l,a){const t=parseInt(l,10);isNaN(t)&&a(new Error("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u7aef\u53e3\u53f7")),t<1||t>65534?a(new Error("\u7aef\u53e3\u53f7\u5fc5\u987b\u57280\u523065535\u4e4b\u95f4")):a()},trigger:"blur"}]),H=_([{required:!0,message:"\u8bf7\u8f93\u5165\u5e94\u7528\u53c2\u6570",trigger:"blur"}]);function Y(){i("closed")}function W(){h.value=!0,T((()=>{M.value.handleOpen({path:f.value.path,isDir:!0},"\u76ee\u5f55\u9009\u62e9")}))}function J(){F.value=!0,T((()=>{R.value.handleOpen({path:f.value.path,isDir:!1},"\u4f9d\u8d56\u6587\u4ef6\u9009\u62e9")}))}function Z(){O.value=!0,T((()=>{E.value.handleOpen({path:f.value.path,isDir:!1},"\u5165\u53e3\u6587\u4ef6\u9009\u62e9")}))}let Q=_(null);function X(e){let l=s(e);f.value.path=l,T((()=>{Q.value&&Q.value.blur()})),ae()}function ee(e){let l=s(e);f.value.project_cfg.requirements=l}function le(e){let l=s(e);f.value.project_cfg.rukou=l,ae()}function ae(){o.loadingInfo.isLoading=!0,o.loadingInfo.content="\u9884\u83b7\u53d6\u73af\u5883\u4e2d...",r.sysGetPythonMg({action:"get_env_info",path:f.value.path,rukou:f.value.project_cfg.rukou}).then((e=>{o.loadingInfo.isLoading=!1,o.loadingInfo.content="",2e3===e.code&&(f.value.project_cfg.framework=e.data.framework,f.value.project_cfg.rukou=e.data.rukou,f.value.project_cfg.requirements=e.data.requirements,f.value.project_cfg.sgi=e.data.sgi,f.value.project_cfg.application=e.data.application,e.data.requirements&&(f.value.project_cfg.install_reqs=!0))}))}function te(e){ae()}function oe(e){"daphne"==e&&(f.value.project_cfg.sgi="asgi")}function ne(){t.push({path:"/appstore"})}let ie=_(null);function de(){ie.value.validate((e=>{if(e){p.value=!0;let e=n({},f.value);e.action="create_site",r.sysPythonSiteMg(e).then((e=>{if(p.value=!1,2e3==e.code){let l=e.data;A.success(e.msg),Y(),i("refreshData",l.id,l.name)}else A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){m.value=l,c.value=!0,r.sysGetPythonMg({action:"list_version"}).then((e=>{2e3===e.code&&(y.value=e.data)}))}}),(e,l)=>{const a=v("el-input"),t=v("el-checkbox"),o=v("el-form-item"),n=v("el-option"),i=v("el-select"),d=v("el-tooltip"),r=v("el-radio-button"),s=v("el-radio-group"),_=v("QuestionFilled"),T=v("el-icon"),B=v("el-button"),G=v("el-col"),A=v("el-row"),K=v("el-switch"),ae=v("el-form");return k(),b("div",null,[w(z,{modelValue:I(c),"onUpdate:modelValue":l[15]||(l[15]=e=>U(c)?c.value=e:c=e),title:I(m),width:"730px","before-close":Y},{footer:C((()=>[w(B,{onClick:Y,loading:I(p)},{default:C((()=>l[19]||(l[19]=[L("\u53d6\u6d88")]))),_:1},8,["loading"]),w(B,{type:"primary",onClick:de,loading:I(p)},{default:C((()=>l[20]||(l[20]=[L("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:C((()=>[w(ae,{inline:!1,model:I(f),rules:I($),ref_key:"rulesForm",ref:ie,"label-position":"right","label-width":"auto"},{default:C((()=>[w(o,{label:"\u9879\u76ee\u540d\u79f0\uff1a",prop:"name"},{default:C((()=>[D("div",ml,[w(a,{modelValue:I(f).name,"onUpdate:modelValue":l[0]||(l[0]=e=>I(f).name=e),placeholder:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u79f0",maxlength:"50"},null,8,["modelValue"]),D("div",fl,[w(t,{modelValue:I(f).project_cfg.advanced,"onUpdate:modelValue":l[1]||(l[1]=e=>I(f).project_cfg.advanced=e),label:"\u9ad8\u7ea7\u6a21\u5f0f"},null,8,["modelValue"])])])])),_:1}),w(o,{label:"Python\u7248\u672c\uff1a",prop:"project_cfg.version"},{default:C((()=>[D("div",gl,[w(i,{modelValue:I(f).project_cfg.version,"onUpdate:modelValue":l[2]||(l[2]=e=>I(f).project_cfg.version=e),placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"},clearable:"",filterable:""},{default:C((()=>[(k(!0),b(S,null,j(I(y),(e=>(k(),V(n,{key:e.version,label:e.version,value:e.version},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),w(d,{content:"\u5982\u679c\u6ca1\u6709Python\u73af\u5883\uff0c\u8bf7\u70b9\u51fb\u524d\u5f80\u3010\u5e94\u7528\u5546\u5e97\u3011\u5b89\u88c5\u6307\u5b9aPython\u7248\u672c"},{default:C((()=>[D("span",{style:{color:"var(--el-color-primary)",width:"150px","padding-left":"20px",cursor:"pointer"},onClick:ne},"\u6ca1\u6709\uff1f\u53bb\u5b89\u88c5")])),_:1})])])),_:1}),w(o,{label:"\u542f\u52a8\u65b9\u5f0f\uff1a",prop:"project_cfg.start_method"},{default:C((()=>[w(s,{modelValue:I(f).project_cfg.start_method,"onUpdate:modelValue":l[3]||(l[3]=e=>I(f).project_cfg.start_method=e),onChange:oe},{default:C((()=>[w(r,{label:"\u547d\u4ee4\u884c",value:"command"}),I(u)?x("",!0):(k(),V(r,{key:0,label:"uwsgi",value:"uwsgi"})),I(u)?x("",!0):(k(),V(r,{key:1,label:"gunicorn",value:"gunicorn"})),w(r,{label:"daphne",value:"daphne"})])),_:1},8,["modelValue"]),w(d,{effect:"dark",content:"\u547d\u4ee4\u884c\uff1a\u9002\u7528\u4e8epython<br/>uwsgi\uff1a\u9002\u7528\u4e8eflask\u3001django<br/>gunicorn\uff1a\u9002\u7528\u4e8eflask\u3001django<br/>daphne\uff1a\u9002\u7528\u4e8edjango","raw-content":!0,placement:"top-start"},{default:C((()=>[w(T,{style:{"margin-left":"5px"}},{default:C((()=>[w(_)])),_:1})])),_:1})])),_:1}),"command"==I(f).project_cfg.start_method?(k(),V(o,{key:0,label:"\u542f\u52a8\u547d\u4ee4\uff1a",prop:"project_cfg.start_command"},{default:C((()=>[w(a,{modelValue:I(f).project_cfg.start_command,"onUpdate:modelValue":l[4]||(l[4]=e=>I(f).project_cfg.start_command=e),placeholder:"\u5982\uff1apip install -r requirements.txt && python manage.py runserver 0.0.0.0:8000",maxlength:"300"},null,8,["modelValue"])])),_:1})):x("",!0),"command"!=I(f).project_cfg.start_method?(k(),V(o,{key:1,label:"\u9879\u76ee\u7aef\u53e3\uff1a",prop:"project_cfg.port",rules:"command"!=I(f).project_cfg.start_method?I(q):[]},{default:C((()=>[D("div",yl,[w(a,{ref_key:"PathInputElement",ref:Q,modelValue:I(f).project_cfg.port,"onUpdate:modelValue":l[5]||(l[5]=e=>I(f).project_cfg.port=e),placeholder:"\u8bf7\u8f93\u5165\u9879\u76ee\u7aef\u53e3",type:"number",min:"1",max:"65534"},null,8,["modelValue"])])])),_:1},8,["rules"])):x("",!0),w(o,{label:"\u9879\u76ee\u76ee\u5f55\uff1a",prop:"path"},{default:C((()=>[w(a,{modelValue:I(f).path,"onUpdate:modelValue":l[6]||(l[6]=e=>I(f).path=e),placeholder:"\u8bf7\u9009\u62e9\u9879\u76ee\u6839\u76ee\u5f55",class:"selectDirs",onChange:te},{prepend:C((()=>[w(B,{onClick:W,icon:"Folder",type:"primary"})])),_:1},8,["modelValue"])])),_:1}),"command"!=I(f).project_cfg.start_method&&I(f).project_cfg.advanced?(k(),V(o,{key:2,label:"\u5165\u53e3\u6587\u4ef6\uff1a",prop:"project_cfg.rukou"},{default:C((()=>[w(a,{modelValue:I(f).project_cfg.rukou,"onUpdate:modelValue":l[7]||(l[7]=e=>I(f).project_cfg.rukou=e),clearable:"",placeholder:"\u9879\u76ee\u5165\u53e3\u6587\u4ef6\u5982\uff1awsgi.py\u3001asgi.py\u3001app.py",class:"selectDirs"},{prepend:C((()=>[w(B,{onClick:Z,icon:"Document",type:"primary"})])),_:1},8,["modelValue"])])),_:1})):x("",!0),I(f).project_cfg.advanced?(k(),V(A,{key:3,gutter:20},{default:C((()=>[w(G,{span:8},{default:C((()=>[w(o,{label:"\u9879\u76ee\u6846\u67b6\uff1a",prop:"project_cfg.framework"},{default:C((()=>[w(i,{modelValue:I(f).project_cfg.framework,"onUpdate:modelValue":l[8]||(l[8]=e=>I(f).project_cfg.framework=e),placeholder:"\u8bf7\u9009\u62e9\u9879\u76ee\u6846\u67b6",disabled:!0,style:{width:"100%"},filterable:""},{default:C((()=>[w(n,{key:"django",label:"django",value:"django"}),w(n,{key:"flask",label:"flask",value:"flask"}),w(n,{key:"python",label:"python",value:"python"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),w(G,{span:16},{default:C((()=>[w(o,{label:"\u5e94\u7528\u53c2\u6570\uff1a",prop:"project_cfg.application",rules:"command"!=I(f).project_cfg.start_method?I(H):[]},{default:C((()=>[w(a,{modelValue:I(f).project_cfg.application,"onUpdate:modelValue":l[9]||(l[9]=e=>I(f).project_cfg.application=e),placeholder:"\u5982\uff1aapplication.asgi:application\u6216app:app",maxlength:"100"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1})])),_:1})):x("",!0),I(f).project_cfg.advanced?(k(),V(o,{key:4,label:"\u4f9d\u8d56\u6587\u4ef6\uff1a",prop:"project_cfg.requirements"},{default:C((()=>[D("div",hl,[w(a,{modelValue:I(f).project_cfg.requirements,"onUpdate:modelValue":l[10]||(l[10]=e=>I(f).project_cfg.requirements=e),clearable:"",placeholder:"\u8bf7\u9009\u62e9\u4f9d\u8d56\u6587\u4ef6\uff0c\u5982\uff1arequirements.txt",class:"selectDirs"},{prepend:C((()=>[w(B,{onClick:J,icon:"Document",type:"primary"})])),_:1},8,["modelValue"]),D("div",_l,[w(t,{modelValue:I(f).project_cfg.install_reqs,"onUpdate:modelValue":l[11]||(l[11]=e=>I(f).project_cfg.install_reqs=e),label:"\u5b89\u88c5\u4f9d\u8d56"},null,8,["modelValue"])])])])),_:1})):x("",!0),w(A,{gutter:20},{default:C((()=>["command"!=I(f).project_cfg.start_method?(k(),V(G,{key:0,span:12},{default:C((()=>["command"!=I(f).project_cfg.start_method?(k(),V(o,{key:0,label:"\u901a\u8baf\u534f\u8bae\uff1a",prop:"project_cfg.sgi"},{default:C((()=>[w(i,{modelValue:I(f).project_cfg.sgi,"onUpdate:modelValue":l[12]||(l[12]=e=>I(f).project_cfg.sgi=e),placeholder:"\u8bf7\u9009\u62e9\u901a\u8baf\u534f\u8bae",disabled:"daphne"==I(f).project_cfg.start_method,style:{width:"100%"},filterable:""},{default:C((()=>[w(n,{key:"wsgi",label:"wsgi",value:"wsgi",disabled:"daphne"==I(f).project_cfg.start_method},null,8,["disabled"]),w(n,{key:"asgi",label:"asgi",value:"asgi"})])),_:1},8,["modelValue","disabled"])])),_:1})):x("",!0)])),_:1})):x("",!0),w(G,{span:12},{default:C((()=>[I(f).project_cfg.advanced&&!I(u)?(k(),V(o,{key:0,label:"\u542f\u52a8\u7528\u6237\uff1a",prop:"project_cfg.start_user"},{default:C((()=>[w(i,{modelValue:I(f).project_cfg.start_user,"onUpdate:modelValue":l[13]||(l[13]=e=>I(f).project_cfg.start_user=e),placeholder:"\u8bf7\u9009\u62e9\u542f\u52a8\u7528\u6237",style:{width:"100%"},clearable:"",filterable:""},{default:C((()=>[w(n,{key:"root",label:"root",value:"root"}),w(n,{key:"www",label:"www",value:"www"})])),_:1},8,["modelValue"])])),_:1})):x("",!0)])),_:1})])),_:1}),I(f).project_cfg.advanced?(k(),V(o,{key:5,label:"\u5f00\u673a\u542f\u52a8\uff1a"},{default:C((()=>[w(K,{modelValue:I(f).project_cfg.autostart,"onUpdate:modelValue":l[14]||(l[14]=e=>I(f).project_cfg.autostart=e),"inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"\u5f00\u542f","inactive-text":"\u5173\u95ed"},null,8,["modelValue"])])),_:1})):x("",!0),I(g)?(k(),V(o,{key:6,label:"\u8f85\u52a9\u9884\u89c8\uff1a"},{default:C((()=>[D("div",vl,P(I(g)),1)])),_:1})):x("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),I(h)?(k(),V(N,{key:0,ref_key:"chooseDirShowFlag",ref:M,onChange:X,onClosed:l[16]||(l[16]=e=>U(h)?h.value=!1:h=!1)},null,512)):x("",!0),I(F)?(k(),V(N,{key:1,ref_key:"chooseFileShowFlag",ref:R,onChange:ee,onClosed:l[17]||(l[17]=e=>U(F)?F.value=!1:F=!1),onlyFileSelect:!0},null,512)):x("",!0),I(O)?(k(),V(N,{key:2,ref_key:"chooseRKFileShowFlag",ref:E,onChange:le,onClosed:l[18]||(l[18]=e=>U(O)?O.value=!1:O=!1),onlyFileSelect:!0},null,512)):x("",!0)])}}},[["__scopeId","data-v-d561cfa7"]]),kl={class:"lySSLApplyDialog"},wl=i({__name:"createSiteLog",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=a;let o=_(!1),n=_(!1),i=_("\u65e5\u5fd7\u8be6\u60c5"),d=_({id:""}),u={},c=_(""),p=_("55vh"),m=_("log"),f=_(null),g=_("new_lines");function y(){h(),t("refreshData"),t("closed")}function h(){clearInterval(f.value),f.value=null}F((()=>{window.addEventListener("resize",j),j()})),E((()=>{window.removeEventListener("resize",j),h()}));let v=_(null);function V(){n.value=!0;let e={id:d.value.id,action:"get_create_log"};r.sysPythonSiteMg(e).then((e=>{if(n.value=!1,2e3==e.code){if(c.value=e.data.data,T((()=>{v.value&&v.value.scrollToBottom()})),e.data.done&&(h(),"all"!=g.value)){let l=2e3;e.data.error&&(l=5e3),setTimeout((()=>{y()}),l)}}else A.warning(e.msg),setTimeout((()=>{y()}),2e3)}))}let x=_(null),S=_(!1);function j(){T((()=>{const e=x.value.getRef();if(e.dialogContentRef){const l=e.dialogContentRef.$refs.headerRef.offsetHeight||80,a=document.body.offsetHeight;e.dialogContentRef.fullscreen||S.value?p.value=a-l:p.value="55vh"}}))}function L(e){S.value=e,j()}return l({handleOpen:function(e,l){i.value=l,o.value=!0,e&&(u=s(e),d.value.id=u.id,u.action&&(g.value=u.action),"all"!=g.value?f.value=setInterval((()=>{V()}),2e3):V())}}),(e,l)=>(k(),b("div",kl,[w(z,{ref_key:"codeMirrorDialogRef",ref:x,modelValue:I(o),"onUpdate:modelValue":l[1]||(l[1]=e=>U(o)?o.value=e:o=e),title:I(i),width:"50%",onOnChangeFullScreen:L,"before-close":y,showClose:!1,showFullScreen:!1},{default:C((()=>[w(J,{modelValue:I(c),"onUpdate:modelValue":l[0]||(l[0]=e=>U(c)?c.value=e:c=e),fontSize:"15px",placeholder:(I(c),""),showLineNums:!1,lineWrapping:!0,mode:I(m),height:I(p),"read-only":!0,ref_key:"lyCodemirror",ref:v},null,8,["modelValue","placeholder","mode","height"])])),_:1},8,["modelValue","title"])]))}},[["__scopeId","data-v-7bcdb7c5"]]),Vl={class:"handle-top"},xl={class:"search-sites-input"},Cl={key:0},Il={key:1},Sl={class:"lyczj",style:{display:"flex","align-items":"center"}},jl=["onClick"],Ll={key:0,style:{"font-size":"12px","font-weight":"bold"}},Ul=i({__name:"index",setup(e,{expose:l}){const a=K(),t=d(),o=y();let i=B((()=>o.ismobile)),s=_(!1),u=_({page:1,limit:10}),c=_({page:1,limit:10,total:0}),p=_([]);function m(e){u.value.page=e.page,u.value.limit=e.limit,f()}function f(){s.value=!0;let e=n({},u.value);r.sysGetPythonSiteMg(e).then((e=>{s.value=!1,2e3===e.code&&(e.data.data.forEach((e=>{e.showEndDate=!1})),p.value=e.data.data,c.value.page=e.data.page,c.value.limit=e.data.limit,c.value.total=e.data.total)}))}function g(){u.value.page=1,f()}let S=_(!1),j=_(null);function F(){S.value=!0,T((()=>{j.value.handleOpen(null,"\u6dfb\u52a0Python\u9879\u76ee")}))}let E=_(!1),O=_(null);function G(e,l){E.value=!0,T((()=>{let a={id:e};O.value.handleOpen(a,"\u6dfb\u52a0\u3010"+l+"\u3011\u9879\u76ee\u65e5\u5fd7\u8be6\u60c5")}))}let z=_(!1),N=_(null);function W(e){z.value=!0;let l={id:e.id,installed:!0,version:"",status:e.status,name:"python_project"};T((()=>{N.value.handleOpen(l,"\u3010"+e.name+"\u3011\u7ba1\u7406")}))}let J=_(!1),Z=_(null);function ee(e,l){let a="\u786e\u5b9a\u542f\u52a8\u7ad9\u70b9\u5417\uff1f",o="\u542f\u52a8\u4e2d...";"stop"==e?(a="\u786e\u5b9a\u8981\u505c\u6b62\u7ad9\u70b9\u5417\uff1f",o="\u505c\u6b62\u4e2d..."):"restart"==e&&(a="\u786e\u5b9a\u8981\u91cd\u542f\u5417\uff1f",o="\u91cd\u542f\u4e2d..."),Y.confirm(`${a}`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content=o,r.sysPythonSiteMg({id:l,op:e,action:"set_status"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),f()):A.warning(e.msg)}))})).catch((()=>{}))}function le(){a.push({path:"/appstore"})}function ae(e){p.value.forEach((l=>{l.id==e.id&&(l.status=e.status)}))}return l({RefreshData:function(){T((()=>{f()}))}}),(e,l)=>{const o=v("el-button"),n=v("el-col"),d=v("el-input"),y=v("el-row"),_=v("el-link"),B=v("el-table-column"),K=v("el-tag"),te=v("el-tooltip"),oe=v("el-table"),ne=M("loading");return k(),b("div",null,[D("div",Vl,[w(y,null,{default:C((()=>[w(n,{xs:24,sm:16,md:16,lg:16,xl:16},{default:C((()=>[w(o,{type:"primary",onClick:F},{default:C((()=>l[8]||(l[8]=[L("\u6dfb\u52a0Python\u9879\u76ee")]))),_:1}),w(o,{onClick:le},{default:C((()=>l[9]||(l[9]=[L("\u5b89\u88c5Python\u73af\u5883")]))),_:1}),w(o,{icon:"refresh",circle:"",onClick:g})])),_:1}),w(n,{xs:24,sm:8,md:8,lg:8,xl:8},{default:C((()=>[D("div",xl,[w(d,{modelValue:I(u).search,"onUpdate:modelValue":l[0]||(l[0]=e=>I(u).search=e),clearable:"",onClear:l[1]||(l[1]=e=>g()),"suffix-icon":"Search",onKeyup:l[2]||(l[2]=$((e=>g()),["enter"])),onChange:l[3]||(l[3]=e=>g()),placeholder:"\u641c\u7d22"},null,8,["modelValue"])])])),_:1})])),_:1})]),R((k(),V(oe,{data:I(p),style:{width:"100%","border-top":"1px solid var(--el-border-color-lighter)"},"header-cell-class-name":"table-header-style"},{default:C((()=>[w(B,{prop:"name",label:"\u540d\u79f0","min-width":"180"},{default:C((e=>[w(_,{type:"primary",underline:!1,onClick:q((l=>W(e.row)),["stop"])},{default:C((()=>[L(P(e.row.name),1)])),_:2},1032,["onClick"])])),_:1}),w(B,{prop:"status",label:"\u72b6\u6001","min-width":"100"},{default:C((({row:e})=>[e.status?(k(),V(o,{key:0,link:"",type:"success",icon:"VideoPlay",onClick:l=>ee("stop",e.id)},{default:C((()=>l[10]||(l[10]=[L(" \u5df2\u542f\u52a8 ")]))),_:2},1032,["onClick"])):(k(),V(o,{key:1,link:"",type:"danger",icon:"VideoPause",onClick:l=>ee("start",e.id)},{default:C((()=>l[11]||(l[11]=[L(" \u5df2\u505c\u6b62 ")]))),_:2},1032,["onClick"]))])),_:1}),w(B,{prop:"project_cfg.port",label:"\u7aef\u53e3",width:"90"},{default:C((e=>["command"==e.row.start_method?(k(),b("span",Cl)):(k(),b("span",Il,P(e.row.project_cfg.port),1))])),_:1}),w(B,{prop:"project_cfg.framework",label:"\u9879\u76ee\u6846\u67b6",width:"100"}),w(B,{prop:"project_cfg.start_method",label:"\u542f\u52a8\u7c7b\u578b",width:"100"}),w(B,{prop:"project_cfg.autostart",label:"\u5f00\u673a\u542f\u52a8",width:"100"},{default:C((e=>[e.row.project_cfg.autostart?(k(),V(K,{key:0,type:"primary"},{default:C((()=>l[12]||(l[12]=[L("\u662f")]))),_:1})):(k(),V(K,{key:1},{default:C((()=>l[13]||(l[13]=[L("\u5426")]))),_:1}))])),_:1}),w(B,{prop:"path",label:"\u9879\u76ee\u76ee\u5f55",width:"90"},{default:C((e=>[D("div",Sl,[w(te,{effect:"dark",content:e.row.path,placement:"bottom"},{default:C((()=>[D("img",{class:"ruyi-fileicons",src:h,onClick:l=>{var o;(o=e.row).path&&(t.fileInfo.currentDir=o.path,a.push({path:"/files"}))}},null,8,jl)])),_:2},1032,["content"]),e.row.is_default?(k(),b("span",Ll,"(\u9ed8\u8ba4\u7ad9)")):x("",!0)])])),_:1}),w(B,{prop:"create_at",label:"\u521b\u5efa\u65f6\u95f4","min-width":"170"}),w(B,{fixed:!I(i)&&"right",label:"\u64cd\u4f5c",width:"200"},{default:C((e=>["windows"!=I(t).sysConfig.currentOs?(k(),V(o,{key:0,link:"",type:"primary",onClick:l=>{return a=e.row,J.value=!0,void T((()=>{let e={id:0,initcmd:`clear && cd ${a.path} \n`};Z.value.handleOpen(e,"\u5982\u610f\u7ec8\u7aef")}));var a}},{default:C((()=>l[14]||(l[14]=[L("\u7ec8\u7aef")]))),_:2},1032,["onClick"])):x("",!0),w(o,{link:"",type:"primary",onClick:l=>ee("restart",e.row.id)},{default:C((()=>l[15]||(l[15]=[L("\u91cd\u542f")]))),_:2},1032,["onClick"]),w(o,{link:"",type:"primary",onClick:l=>W(e.row)},{default:C((()=>l[16]||(l[16]=[L("\u914d\u7f6e")]))),_:2},1032,["onClick"]),w(o,{link:"",type:"primary",onClick:l=>{return a=e.row,void Y.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${a.name}\u3011\u9879\u76ee\u5417\uff1f\u6b64\u64cd\u4f5c\u4f1a\u5220\u9664\u8be5\u9879\u76ee\u7684\u65e5\u5fd7\u3001\u914d\u7f6e\u4fe1\u606f\u7b49\uff01\uff01\uff01`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u5220\u9664\u4e2d...",r.sysPythonSiteMg({id:a.id,action:"del_site"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),f()):A.warning(e.msg)}))})).catch((()=>{}));var a}},{default:C((()=>l[17]||(l[17]=[L("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1},8,["fixed"])])),_:1},8,["data"])),[[ne,I(s)]]),w(H,{small:!0,"child-msg":I(c),onCallFather:m,border:!1,position:"right"},null,8,["child-msg"]),I(S)?(k(),V(bl,{key:0,ref_key:"moduleAddFlag",ref:j,onClosed:l[4]||(l[4]=e=>U(S)?S.value=!1:S=!1),onRefreshData:G},null,512)):x("",!0),I(E)?(k(),V(wl,{key:1,ref_key:"moduleinstallLogFlag",ref:O,onClosed:l[5]||(l[5]=e=>U(E)?E.value=!1:E=!1),onRefreshData:f},null,512)):x("",!0),I(z)?(k(),V(Q,{key:2,ref_key:"softInfoFlag",ref:N,onClosed:l[6]||(l[6]=e=>U(z)?z.value=!1:z=!1),onRefreshStatus:ae,onRefreshData:f},null,512)):x("",!0),I(J)?(k(),V(X,{key:3,ref_key:"moduleDialogTerminalFlag",ref:Z,onClosed:l[7]||(l[7]=e=>U(J)?J.value=!1:J=!1)},null,512)):x("",!0)])}}},[["__scopeId","data-v-82f64241"]]),Tl={key:0,style:{"margin-bottom":"20px"},class:"lystatuscard"},Dl={class:"lyflex"},Pl={class:"lyflex"},Ml={key:0,class:"lyflex"},Rl=i({__name:"index",setup(e){const l=d(),a=y();let t=B((()=>a.ismobile)),o=_("Static"),n=_("nginx");function i(e){let a=e.props.name;u.value.id="",u.value.installed=!1,u.value.version="",u.value.status=!1,"Static"==a?(n.value=l.sysConfig.webServer,c(n.value)):(n.value=a,j(a))}function s(){c(n.value)}let u=_({id:"",installed:!1,version:"",status:!1,name:""});function c(e="nginx"){""!=e&&(l.loadingInfo.isLoading=!0,l.loadingInfo.content="\u6b63\u5728\u83b7\u53d6...",r.sysSoftinfoMg({name:e,action:"get_soft_info"}).then((e=>{l.loadingInfo.isLoading=!1,l.loadingInfo.content="",2e3==e.code?(u.value=e.data,u.value.installed&&j(o.value)):A.warning(e.msg)})))}function p(e="stop"){let a="\u786e\u5b9a\u8981\u505c\u6b62\u5417\uff1f",t=!1,o="\u542f\u52a8\u6210\u529f";"stop"==e?(l.loadingInfo.content="\u6b63\u5728\u505c\u6b62\u4e2d...",t=!1,o="\u505c\u6b62\u6210\u529f"):"reload"==e?(l.loadingInfo.content="\u6b63\u5728\u91cd\u8f7d\u914d\u7f6e\u4e2d...",a="\u786e\u5b9a\u8981\u91cd\u8f7d\u914d\u7f6e\u5417\uff1f",t=u.value.status,o="\u91cd\u8f7d\u914d\u7f6e\u6210\u529f"):"restart"==e&&(l.loadingInfo.content=u.value.status?"\u6b63\u5728\u91cd\u542f\u4e2d...":"\u6b63\u5728\u542f\u52a8\u4e2d...",a=u.value.status?"\u786e\u5b9a\u8981\u91cd\u542f\u5417\uff1f":"\u786e\u5b9a\u8981\u542f\u52a8\u5417\uff1f",t=!0,o=u.value.status?"\u91cd\u542f\u6210\u529f":"\u542f\u52a8\u6210\u529f"),Y.confirm(`${a}`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{l.loadingInfo.isLoading=!0,r.sysSoftManage({id:u.value.id,status:e,action:"status"}).then((e=>{l.loadingInfo.isLoading=!1,l.loadingInfo.content="",2e3==e.code?(A.success(o),u.value.status=t):A.warning(e.msg)}))})).catch((()=>{}))}let m=_(!1),f=_(null);function g(){m.value=!0,T((()=>{f.value.handleOpen(u.value,"\u3010"+u.value.name+"("+u.value.version+")\u3011\u7ba1\u7406")}))}let h=_(null),S=_(null);function j(e="Static"){T((()=>{"Static"==e?T((()=>{h.value.RefreshData()})):"Python"==e&&T((()=>{S.value.RefreshData()}))}))}return F((()=>{n.value=l.sysConfig.webServer,c(n.value)})),(e,l)=>{const a=v("el-tag"),d=v("el-button"),r=v("el-divider"),c=v("el-card"),y=v("el-tab-pane"),_=v("el-tabs"),j=v("el-main");return k(),V(j,{class:"ruyi-sites"},{default:C((()=>[w(c,{shadow:"never"},{default:C((()=>[w(_,{modelValue:I(o),"onUpdate:modelValue":l[3]||(l[3]=e=>U(o)?o.value=e:o=e),onTabClick:i},{default:C((()=>[I(n)&&"Static"==I(o)?(k(),b("div",Tl,[w(c,{shadow:"hover",style:O({overflowX:I(t)?"auto":"none"})},{default:C((()=>[D("div",Dl,[w(a,{style:{"margin-right":"20px"},effect:"dark",type:"success"},{default:C((()=>[L(P(I(n)),1)])),_:1}),w(a,{style:{"margin-right":"20px"},type:I(u).installed?"success":"info"},{default:C((()=>[L(P(I(u).installed?"\u5df2\u5b89\u88c5":"\u672a\u5b89\u88c5"),1)])),_:1},8,["type"]),w(a,{style:{"margin-right":"20px"}},{default:C((()=>[L("\u7248\u672c: "+P(I(u).version||"\u672a\u77e5"),1)])),_:1}),w(a,{style:{"margin-right":"20px"},type:I(u).status?"success":"danger"},{default:C((()=>[L("\u72b6\u6001: "+P(I(u).status?"\u5df2\u542f\u52a8":"\u672a\u542f\u52a8"),1)])),_:1},8,["type"]),D("div",Pl,[w(d,{type:"primary",link:"",onClick:l[0]||(l[0]=e=>p("stop")),disabled:!I(u).installed},{default:C((()=>l[5]||(l[5]=[L("\u505c\u6b62")]))),_:1},8,["disabled"]),w(r,{direction:"vertical"}),w(d,{type:"primary",link:"",onClick:l[1]||(l[1]=e=>p("restart")),disabled:!I(u).installed},{default:C((()=>[L(P(I(u).status?"\u91cd\u542f":"\u542f\u52a8"),1)])),_:1},8,["disabled"])]),"Static"==I(o)?(k(),b("div",Ml,[w(r,{direction:"vertical"}),w(d,{type:"primary",link:"",onClick:l[2]||(l[2]=e=>p("reload")),disabled:!I(u).installed},{default:C((()=>l[6]||(l[6]=[L(P("\u91cd\u8f7d"))]))),_:1},8,["disabled"]),w(r,{direction:"vertical"}),w(d,{type:"primary",link:"",onClick:g,disabled:!I(u).installed},{default:C((()=>l[7]||(l[7]=[L(P("\u8bbe\u7f6e"))]))),_:1},8,["disabled"])])):x("",!0)])])),_:1},8,["style"])])):x("",!0),w(y,{label:"\u9759\u6001\u9879\u76ee",name:"Static"},{default:C((()=>["Static"==I(o)?(k(),V(pl,{key:0,installed:I(u).installed,status:I(u).status,ref_key:"staticRef",ref:h},null,8,["installed","status"])):x("",!0)])),_:1}),w(y,{label:"Python\u9879\u76ee",name:"Python"},{default:C((()=>["Python"==I(o)?(k(),V(Ul,{key:0,ref_key:"pythonRef",ref:S},null,512)):x("",!0)])),_:1})])),_:1},8,["modelValue"])])),_:1}),I(m)?(k(),V(Q,{key:0,ref_key:"softInfoFlag",ref:f,onClosed:l[4]||(l[4]=e=>U(m)?m.value=!1:m=!1),onRefreshStatus:s},null,512)):x("",!0)])),_:1})}}},[["__scopeId","data-v-b7248122"]]);export{Rl as default};
