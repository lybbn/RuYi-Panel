var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,n=(e,n)=>{for(var i in n||(n={}))a.call(n,i)&&o(e,i,n[i]);if(l)for(var i of l(n))t.call(n,i)&&o(e,i,n[i]);return e};import{c as i,i as d,A as r,e as s,M as u,j as c,k as p,l as m,U as f,u as g,m as y}from"./index.DdU3pFbI.js";import{b as _,ag as h,o as v,c as b,P as k,H as w,u as V,L as x,O as C,a4 as I,G as S,t as j,K as L,n as U,a as T,M as D,aq as P,I as M,j as R,W as F,D as E,k as O,a5 as B,V as q,e as $}from"./@vue.BluSRtaz.js";import{P as G}from"./Pagination.DhOoI1te.js";import{L as H}from"./dialog.BvK2-1BY.js";import{l as z}from"./fileList.0qIp1icd.js";import{_ as N}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as A,a as Y}from"./element-plus.CMBwCou9.js";import"./crypto-js.CCePG2on.js";import"./js-cookie.Ch5AnFJE.js";import"./clipboard.55ERAcYO.js";import{b as W}from"./batchOp.Jf61eufF.js";import{b as K}from"./vue-router.CjawWhbh.js";import{l as Z}from"./index.GhyFdw6y.js";import{_ as J}from"./index.BtSuCC0u.js";import{s as Q}from"./softInfo.CiCEVXig.js";import{l as X}from"./dialogTerminal.XJDivsNV.js";import"./axios.3Xbkft1r.js";import"./vue-clipboard3.CjTOZN0C.js";import"./pinia.DhJalR8o.js";import"./@element-plus.sBVz1STF.js";import"./nprogress.B5M_jmCc.js";import"./@xterm.8vZnc5Va.js";import"./pinia-plugin-persistedstate.DTf8V5gU.js";import"./destr.ZpApkS-1.js";import"./deep-pick-omit.DP_A4OSP.js";import"./lodash-es.BccSst5e.js";import"./@vueuse.l0Dx-5Bl.js";import"./@popperjs.CpAfbxx4.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.9DdhAVak.js";import"./async-validator.Cuo4gI4y.js";import"./memoize-one.Ds0C_khL.js";import"./normalize-wheel-es.CUoAWVRo.js";import"./@floating-ui.yzr8CaSr.js";import"./vue-codemirror.DFdUdG36.js";import"./codemirror.BJSsQESG.js";import"./@codemirror.BkM7iGym.js";import"./@lezer.CzslrRCj.js";import"./crelt.DSg10-ms.js";import"./style-mod.Dj2YSJ7-.js";import"./w3c-keyname.f-y9tSbI.js";import"./index.DDb0sGrY.js";const ee=N({__name:"moduleAdd",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=i(),o=a;let s=_(!1),u=_(!1),c=_("\u6dfb\u52a0\u7f51\u7ad9"),p=_({name:"",remark:"",path:t.sysConfig.wwwrootPath,group:0,type:0}),m=_([{id:0,name:"\u9ed8\u8ba4\u5206\u7ec4"}]),f=_(!1),g=_(null);let y=_({name:[{required:!0,trigger:"change",validator:function(e,l,a){const t=l.split("\n");let o=!0,n="";t.forEach(((e,l)=>{""!==e&&(function(e){return/^([\w\-\*]{1,150}\.){1,8}([\w\-]{1,30}|[\w\-]{1,30}\.[\w\-]{1,24})(?::\d{1,5})?$/.test(e)}(e)||function(e){return/^(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?::\d{1,5})?$/.test(e)}(e)||(o=!1,n=`\u7b2c${l+1}\u884c\u683c\u5f0f\u4e0d\u6b63\u786e: ${e}`))})),o?a():a(new Error(n))}}],path:[{required:!0,message:"\u8bf7\u9009\u62e9\u7f51\u7ad9\u6839\u76ee\u5f55",trigger:"blur"}],group:[{required:!0,message:"\u8bf7\u9009\u62e9\u7f51\u7ad9\u5206\u7ec4",trigger:"blur"}]});function T(){o("closed")}function D(e){const l=e.split("\n")[0];p.value.remark=l,p.value.path=l?t.sysConfig.wwwrootPath+"/"+l.replace(/:/g,"_"):t.sysConfig.wwwrootPath}function P(){f.value=!0,U((()=>{g.value.handleOpen({path:p.value.path,isDir:!0},"\u76ee\u5f55\u9009\u62e9")}))}function M(e){let l=d(e);p.value.path=l}let R=_(null);function F(){R.value.validate((e=>{if(e){u.value=!0;const e=p.value.name.split("\n");let l=n({},p.value);l.name=e[0].split(":")[0],l.domainList=e,l.action="save_static_site",r.sysGetSitesManage(l).then((e=>{u.value=!1,2e3==e.code?(A.success(e.msg),T(),o("refreshData")):A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){c.value=l,s.value=!0,r.sysSitegroup({page:1,limit:999}).then((e=>{2e3===e.code&&(m.value=e.data.data)}))}}),(e,l)=>{const a=h("el-input"),t=h("el-form-item"),o=h("el-button"),n=h("el-option"),i=h("el-select"),d=h("el-form");return v(),b("div",null,[k(H,{modelValue:V(s),"onUpdate:modelValue":l[4]||(l[4]=e=>j(s)?s.value=e:s=e),title:V(c),width:"680px","before-close":T},{footer:w((()=>[k(o,{onClick:T,loading:V(u)},{default:w((()=>l[6]||(l[6]=[x("\u53d6\u6d88")]))),_:1},8,["loading"]),k(o,{type:"primary",onClick:F,loading:V(u)},{default:w((()=>l[7]||(l[7]=[x("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:w((()=>[k(d,{inline:!1,model:V(p),rules:V(y),ref_key:"rulesForm",ref:R,"label-position":"right","label-width":"auto"},{default:w((()=>[k(t,{label:"\u57df\u540d\uff1a",prop:"name"},{default:w((()=>[k(a,{modelValue:V(p).name,"onUpdate:modelValue":l[0]||(l[0]=e=>V(p).name=e),autosize:{minRows:5,maxRows:8},type:"textarea",placeholder:"\u8bf7\u8f93\u5165\u7f51\u7ad9\u57df\u540d\uff0c\u652f\u6301\u591a\u4e2a\uff08\u57df\u540d\u3001IP)+\u7aef\u53e3\uff08\u9ed8\u8ba480\uff09\uff0c\u4e00\u884c\u4e00\u4e2a\n\u57df\u540d\u683c\u5f0f1\uff1awww.lybbn.cn\n\u57df\u540d\u683c\u5f0f2\uff1awww.lybbn.cn:8080\nIP\u683c\u5f0f\uff1a192.168.1.1:8080\n\u6cdb\u89e3\u6790\uff1a*.lybbn.cn",clearable:"",onInput:D},null,8,["modelValue"])])),_:1}),k(t,{label:"\u5907\u6ce8\uff1a",prop:"remark"},{default:w((()=>[k(a,{modelValue:V(p).remark,"onUpdate:modelValue":l[1]||(l[1]=e=>V(p).remark=e),placeholder:"\u5907\u6ce8",clearable:""},null,8,["modelValue"])])),_:1}),k(t,{label:"\u6839\u76ee\u5f55\uff1a",prop:"path"},{default:w((()=>[k(a,{modelValue:V(p).path,"onUpdate:modelValue":l[2]||(l[2]=e=>V(p).path=e),placeholder:"\u8bf7\u9009\u62e9\u7f51\u7ad9\u6839\u76ee\u5f55",class:"selectDirs"},{prepend:w((()=>[k(o,{onClick:P,icon:"Folder",type:"primary"})])),_:1},8,["modelValue"])])),_:1}),k(t,{label:"\u5206\u7ec4\uff1a",prop:"group"},{default:w((()=>[k(i,{modelValue:V(p).group,"onUpdate:modelValue":l[3]||(l[3]=e=>V(p).group=e),placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"},clearable:"",filterable:""},{default:w((()=>[(v(!0),b(C,null,I(V(m),(e=>(v(),S(n,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),V(f)?(v(),S(z,{key:0,ref_key:"chooseDirShowFlag",ref:g,onChange:M,onClosed:l[5]||(l[5]=e=>j(f)?f.value=!1:f=!1)},null,512)):L("",!0)])}}},[["__scopeId","data-v-440ec44c"]]),le={class:"handlegroupadd"},ae={key:1},te={style:{display:"flex","align-items":"center"}},oe=N({__name:"moduleGroup",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=a;let o=_(!1),n=_(!1),i=_(!1),d=_(""),s=_({name:"",is_default:!1}),u=_([]);function c(){t("closed")}function p(){n.value=!0,r.sysSitegroup({page:1,limit:999}).then((e=>{if(n.value=!1,2e3===e.code){let l=e.data.data;l.forEach((e=>{e.isEdit=!1})),u.value=l}}))}function m(){if(""==s.value.name)return void A.warning("\u8bf7\u586b\u5199\u7ad9\u70b9\u5206\u7ec4\u540d\u79f0");let e={name:s.value.name,is_default:!1};r.sysSitegroupAdd(e).then((e=>{i.value=!1,2e3==e.code?(A.success(e.msg),p(),s.value.name=""):A.warning(e.msg)}))}return l({handleOpen:function(e,l){d.value=l,o.value=!0,p()}}),(e,l)=>{const a=h("el-input"),t=h("el-button"),f=h("el-table-column"),g=h("el-table");return v(),b("div",null,[k(H,{modelValue:V(o),"onUpdate:modelValue":l[1]||(l[1]=e=>j(o)?o.value=e:o=e),title:V(d),width:"560px","before-close":c,loading:V(n)},{default:w((()=>[T("div",le,[k(a,{modelValue:V(s).name,"onUpdate:modelValue":l[0]||(l[0]=e=>V(s).name=e),clearable:"",placeholder:"\u8bf7\u586b\u5199\u7ad9\u70b9\u5206\u7ec4\u540d\u79f0"},null,8,["modelValue"]),k(t,{type:"primary",style:{"margin-left":"10px"},onClick:m,disabled:V(i)},{default:w((()=>l[2]||(l[2]=[x("\u6dfb\u52a0")]))),_:1},8,["disabled"])]),k(g,{border:"",data:V(u),height:"40vh"},{default:w((()=>[k(f,{prop:"name",label:"\u540d\u79f0","min-width":"200","show-overflow-tooltip":""},{default:w((e=>[e.row.isEdit?(v(),S(a,{key:0,modelValue:e.row.name,"onUpdate:modelValue":l=>e.row.name=l,clearable:""},null,8,["modelValue","onUpdate:modelValue"])):(v(),b("span",ae,D(e.row.name),1))])),_:1}),k(f,{label:"\u64cd\u4f5c",width:"100"},{default:w((e=>[T("div",te,[e.row.isEdit?L("",!0):(v(),S(t,{key:0,link:"",type:"primary",onClick:l=>{var a;(a=e.row).is_default?A.warning("\u9ed8\u8ba4\u5206\u7ec4\u7981\u6b62\u7f16\u8f91"):a.isEdit=!0}},{default:w((()=>l[3]||(l[3]=[x("\u7f16\u8f91")]))),_:2},1032,["onClick"])),e.row.isEdit?(v(),S(t,{key:1,link:"",type:"primary",onClick:l=>function(e){if(""==e.name)return void A.warning("\u8bf7\u586b\u5199\u7ad9\u70b9\u5206\u7ec4\u540d\u79f0");let l={id:e.id,name:e.name,is_default:!1};r.sysSitegroupEdit(l).then((e=>{i.value=!1,2e3==e.code?(A.success(e.msg),p()):A.warning(e.msg)}))}(e.row)},{default:w((()=>l[4]||(l[4]=[x("\u4fdd\u5b58")]))),_:2},1032,["onClick"])):L("",!0),e.row.isEdit?(v(),S(t,{key:2,link:"",type:"primary",onClick:l=>e.row.isEdit=!1},{default:w((()=>l[5]||(l[5]=[x("\u53d6\u6d88")]))),_:2},1032,["onClick"])):L("",!0),e.row.isEdit?L("",!0):(v(),S(t,{key:3,link:"",type:"primary",onClick:l=>{var a;(a=e.row).is_default?A.warning("\u9ed8\u8ba4\u5206\u7ec4\u7981\u6b62\u5220\u9664"):Y.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${a.name}\u3011\u64cd\u4f5c\u5417\uff1f`,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let l={id:a.id};r.sysSitegroupDelete(l).then((e=>{n.value=!1,2e3==e.code?(A.success(e.msg),p()):A.warning(e.msg)}))})).catch((()=>{}))}},{default:w((()=>l[6]||(l[6]=[x("\u5220\u9664")]))),_:2},1032,["onClick"]))])])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue","title","loading"])])}}},[["__scopeId","data-v-624b97c3"]]),ne={__name:"moduleEditEnd",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=i(),o=a;let n=_(!1),s=_(!1),u=_("\u521b\u5efa\u76ee\u5f55"),c=_({id:"",endTime:"",typechoice:1}),p=_([{required:!0,message:"\u8bf7\u9009\u62e9\u5230\u671f\u65f6\u95f4",trigger:"blur"}]);function m(){o("closed")}let f=_(null);function g(){f.value.validate((e=>{if(e){let e=null;1==c.value.typechoice&&(e=c.value.endTime),t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let l={action:"set_site_endtime",id:c.value.id,endTime:e};r.sysGetSitesManage(l).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),m(),o("refreshData")):A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){if(u.value=l,n.value=!0,e){let l=d(e);c.value.id=l.id,c.value.endTime=l.endTime,c.value.endTime||(c.value.typechoice=2)}}}),(e,l)=>{const a=h("el-radio-button"),t=h("el-radio-group"),o=h("el-form-item"),i=h("el-date-picker"),d=h("el-form"),r=h("el-button");return v(),b("div",null,[k(H,{modelValue:V(n),"onUpdate:modelValue":l[2]||(l[2]=e=>j(n)?n.value=e:n=e),title:V(u),width:"560px","before-close":m,showFullScreen:!1},{footer:w((()=>[k(r,{onClick:m,loading:V(s)},{default:w((()=>l[3]||(l[3]=[x("\u53d6\u6d88")]))),_:1},8,["loading"]),k(r,{type:"primary",onClick:g,loading:V(s)},{default:w((()=>l[4]||(l[4]=[x("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:w((()=>[k(d,{inline:!1,model:V(c),rules:e.rules,ref_key:"rulesForm",ref:f,"label-position":"right","label-width":"auto"},{default:w((()=>[k(o,{label:"\u5230\u671f\u7c7b\u578b\uff1a",required:""},{default:w((()=>[k(t,{modelValue:V(c).typechoice,"onUpdate:modelValue":l[0]||(l[0]=e=>V(c).typechoice=e)},{default:w((()=>[k(a,{label:"\u6307\u5b9a\u65f6\u95f4",value:1}),k(a,{label:"\u8bbe\u7f6e\u6c38\u4e45",value:2})])),_:1},8,["modelValue"])])),_:1}),1===V(c).typechoice?(v(),S(o,{key:0,label:"\u5230\u671f\u65f6\u95f4\uff1a",prop:"endTime",rules:1===V(c).typechoice?V(p):[]},{default:w((()=>[k(i,{style:{width:"100%"},modelValue:V(c).endTime,"onUpdate:modelValue":l[1]||(l[1]=e=>V(c).endTime=e),type:"datetime",placeholder:"\u8bf7\u9009\u62e9",format:"YYYY-MM-DD hh:mm:ss","value-format":"YYYY-MM-DD hh:mm:ss"},null,8,["modelValue"])])),_:1},8,["rules"])):L("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},ie=N({__name:"moduleSetDefaultSite",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=i(),o=a;let n=_(!1),d=_(!1),s=_("\u8bbe\u7f6e\u9ed8\u8ba4\u7ad9\u70b9"),u=_({site_id:0}),c=_([]),p=_({site_id:[{required:!0,message:"\u8bf7\u9009\u62e9\u9ed8\u8ba4\u7ad9\u70b9",trigger:"blur"}]});function m(){o("closed")}let f=_(null);function g(){f.value.validate((e=>{if(e){1==u.value.typechoice&&u.value.endTime,t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_default",id:u.value.site_id};r.sysGetSitesManage(e).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),m(),o("refreshData")):A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){s.value=l,n.value=!0,function(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="";let e={module:0,page:1,limit:999};e.module=0,r.sysGetSitesList(e).then((e=>{t.loadingInfo.isLoading=!1,2e3===e.code&&(c.value=e.data.data,c.value.forEach((e=>{e.is_default&&(u.value.site_id=e.id)})))}))}()}}),(e,l)=>{const a=h("el-option"),t=h("el-select"),o=h("el-form-item"),i=h("el-form"),r=h("el-button");return v(),b("div",null,[k(H,{modelValue:V(n),"onUpdate:modelValue":l[1]||(l[1]=e=>j(n)?n.value=e:n=e),title:V(s),width:"560px","before-close":m,showFullScreen:!1},{footer:w((()=>[k(r,{onClick:m,loading:V(d)},{default:w((()=>l[3]||(l[3]=[x("\u53d6\u6d88")]))),_:1},8,["loading"]),k(r,{type:"primary",onClick:g,loading:V(d)},{default:w((()=>l[4]||(l[4]=[x("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:w((()=>[k(i,{inline:!1,model:V(u),rules:V(p),ref_key:"rulesForm",ref:f,"label-position":"right","label-width":"auto"},{default:w((()=>[k(o,{label:"\u9ed8\u8ba4\u7ad9\u70b9\uff1a",prop:"site_id"},{default:w((()=>[k(t,{modelValue:V(u).site_id,"onUpdate:modelValue":l[0]||(l[0]=e=>V(u).site_id=e),style:{width:"100%"}},{default:w((()=>[(v(),S(a,{value:0,key:-1,label:"\u4e0d\u8bbe\u7f6e\u7ad9\u70b9"})),(v(!0),b(C,null,I(V(c),((e,l)=>(v(),S(a,{key:l,value:e.id,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),l[2]||(l[2]=T("div",{class:"ry-cj-care"},[T("li",null,"\u8bbe\u7f6e\u9ed8\u8ba4\u7ad9\u70b9\u540e,\u6240\u6709\u672a\u7ed1\u5b9a\u7684\u57df\u540d\u548cIP\u90fd\u88ab\u5b9a\u5411\u5230\u9ed8\u8ba4\u7ad9\u70b9"),T("li",null,"\u53ef\u6709\u6548\u9632\u6b62\u6076\u610f\u89e3\u6790"),T("li",null,"\u4e0d\u8bbe\u7f6e\u65f6\u4e5f\u4f1a\u670980\u7aef\u53e3\u7684\u9ed8\u8ba4\u7ad9\u70b9")],-1))])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-5bcc75b6"]]),de={class:"lyBackupDialog"},re={key:3},se=N({__name:"moduleBackup",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=a;let o=_(!1);_(!1);let n=_("\u6570\u636e\u5e93\u5907\u4efd"),i=_(!1),m=_(!1),f=_(""),g=_({fid:"",type:2,page:1,limit:10}),y=_({page:1,limit:10,total:0}),C=_([]),I=_({});function L(){t("closed"),t("refreshData")}function T(e){g.value.page=e.page,g.value.limit=e.limit,R()}function R(){i.value=!0,r.sysBakBackUpList(g.value).then((e=>{i.value=!1,2e3==e.code?(C.value=e.data.data,y.value.page=e.data.page,y.value.limit=e.data.limit,y.value.total=e.data.total):u(e.msg)}))}function F(){m.value=!0,r.sysSitesBakMg({action:"backup_site",id:g.value.fid}).then((e=>{m.value=!1,2e3==e.code?(c(e.msg),R()):u(e.msg)}))}let E=_([]),O=_([]);function B(e){O.value=d(e),E.value=e.map((e=>e.id))}let q=_(null);function $(){U((()=>{q.value.handleOpen(null,"\u6279\u91cf\u5220\u9664\u5907\u4efd\u6587\u4ef6")}))}let z=_(0),N=_("0%"),K=_(!1),Z=_(1),J=_("");function Q(e){return new Promise((l=>setTimeout(l,e)))}function X(){return e=this,l=null,a=function*(){Z.value=2,K.value=!0,O.value.forEach((e=>{e.status="wait"}));let e=O.value.length,l=0;for(let a=0;a<e;a++){z.value=a+1==e?100:parseInt((a+1)/e*100),N.value=z.value+"%";let t="del_backup_site",o={id:g.value.fid,bid:O.value[a].id,action:t};r.sysSitesBakMg(o).then((e=>{2e3==e.code?O.value[a].status="success":(O.value[a].status="error",l+=1)})),yield Q(1e3)}K.value=!1,Z.value=3,J.value=`\u6279\u91cf\u5220\u9664\u5907\u4efd\u6587\u4ef6\u5df2\u5b8c\u6210\uff0c\u5171${e}\u4e2a\u4efb\u52a1\uff0c\u6210\u529f${e-l}\u4e2a\uff0c\u5931\u8d25${l}\u4e2a!`},new Promise(((t,o)=>{var n=e=>{try{d(a.next(e))}catch(l){o(l)}},i=e=>{try{d(a.throw(e))}catch(l){o(l)}},d=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,i);d((a=a.apply(e,l)).next())}));var e,l,a}return l({handleOpen:function(e,l){n.value=l,o.value=!0,g.value.fid=e.id,f.value=e.db_name,R()}}),(e,l)=>{const a=h("el-button"),t=h("el-form-item"),d=h("el-form"),u=h("el-table-column"),c=h("el-table"),f=h("el-tag"),_=P("loading");return v(),b("div",de,[k(H,{modelValue:V(o),"onUpdate:modelValue":l[0]||(l[0]=e=>j(o)?o.value=e:o=e),title:V(n),width:"60%","before-close":L,loading:V(m)},{default:w((()=>[k(d,{inline:!1,model:V(g),rules:V(I),ref:"rulesForm","label-position":"right","label-width":"auto",disabled:V(m)},{default:w((()=>[k(t,null,{default:w((()=>[k(a,{type:"primary",onClick:F},{default:w((()=>l[1]||(l[1]=[x("\u5907\u4efd")]))),_:1}),k(a,{onClick:$,disabled:V(E).length<1},{default:w((()=>l[2]||(l[2]=[x("\u5220\u9664")]))),_:1},8,["disabled"])])),_:1})])),_:1},8,["model","rules","disabled"]),M((v(),S(c,{ref:"table",border:"",data:V(C),height:410,onSelectionChange:B},{default:w((()=>[k(u,{type:"selection",width:"55",align:"center"}),k(u,{prop:"name",label:"\u540d\u79f0","min-width":"180","show-overflow-tooltip":""}),k(u,{prop:"size",label:"\u5927\u5c0f","min-width":"100"},{default:w((e=>[x(D(V(s)(e.row.size)),1)])),_:1}),k(u,{prop:"filename",label:"\u4f4d\u7f6e","min-width":"190","show-overflow-tooltip":""}),k(u,{prop:"create_at",label:"\u65f6\u95f4","min-width":"160"}),k(u,{prop:"store_type",label:"\u5b58\u50a8\u5bf9\u8c61","min-width":"90"}),k(u,{fixed:"right",label:"\u64cd\u4f5c",width:"150"},{default:w((e=>[k(a,{link:"",type:"primary",onClick:l=>{return a=e.row,void r.sysSiteBakFileDownload({id:g.value.fid,bid:a.id,action:"download_backup_site"}).then((e=>{if("application/json"==e.headers["content-type"]){const l=new FileReader;l.readAsText(e.data),l.onload=()=>{const e=JSON.parse(l.result);A.warning(e.msg)}}else p(e.data,a.name)}));var a}},{default:w((()=>l[3]||(l[3]=[x("\u4e0b\u8f7d")]))),_:2},1032,["onClick"]),k(a,{link:"",type:"primary",onClick:l=>{return a=e.row,void Y.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${a.name}\u3011\u5907\u4efd\u6587\u4ef6\u5417\uff1f`,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{i.value=!0;let l={id:g.value.fid,bid:a.id,action:"del_backup_site"};r.sysSitesBakMg(l).then((e=>{i.value=!1,2e3==e.code?(A.success(e.msg),R()):A.warning(e.msg)}))})).catch((()=>{}));var a}},{default:w((()=>l[4]||(l[4]=[x("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[_,V(i)]]),k(G,{small:!0,"child-msg":V(y),onCallFather:T},null,8,["child-msg"])])),_:1},8,["modelValue","title","loading"]),k(W,{ref_key:"batchOpRef",ref:q,onClosed:R,tip2:V(J),percentContent:V(N),percentage:V(z),loadingSave:V(K),stepStatus:V(Z)},{table:w((()=>[k(c,{data:V(O),border:"","max-height":500},{default:w((()=>[k(u,{prop:"name",label:"\u540d\u79f0","min-width":"280","show-overflow-tooltip":""}),k(u,{prop:"status",label:"\u72b6\u6001","min-width":"100"},{default:w((e=>["wait"==e.row.status?(v(),S(f,{key:0,type:"info"},{default:w((()=>l[5]||(l[5]=[x("\u7b49\u5f85\u5220\u9664")]))),_:1})):"success"==e.row.status?(v(),S(f,{key:1,type:"success"},{default:w((()=>l[6]||(l[6]=[x("\u5220\u9664\u6210\u529f")]))),_:1})):"error"==e.row.status?(v(),S(f,{key:2,type:"danger"},{default:w((()=>l[7]||(l[7]=[x("\u5220\u9664\u5931\u8d25")]))),_:1})):(v(),b("span",re))])),_:1})])),_:1},8,["data"])])),footer:w((()=>[k(a,{type:"primary",onClick:X,loading:V(K)},{default:w((()=>l[8]||(l[8]=[x("\u786e\u8ba4")]))),_:1},8,["loading"])])),_:1},8,["tip2","percentContent","percentage","loadingSave","stepStatus"])])}}},[["__scopeId","data-v-06300c73"]]),ue={key:0},ce={key:1},pe={key:0},me={key:1},fe={key:2},ge={key:3},ye={key:0},_e={key:1},he=N({__name:"moduleNginxRedirect",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=i(),t=e;let o=_(!1);_(!1);let n=_(!1),s=_("\u65b0\u589e\u91cd\u5b9a\u5411"),u=_({redirectId:m(9),type:"domain",domains:[],redirectCode:"301",redirectRoot:!0,path:"",target:"http://",keepUrlPath:!0,status:!0,operate:"add"}),c=_([]),p=_([]),f=[{required:!0,message:"\u8bf7\u8f93\u5165\u8def\u5f84",trigger:"blur"}],g=[{required:!0,message:"\u8bf7\u9009\u62e9\u57df\u540d",trigger:"blur"}],y=_({type:[{required:!0,message:"\u8bf7\u9009\u62e9\u91cd\u5b9a\u5411\u7c7b\u578b",trigger:"blur"}],redirectCode:[{required:!0,message:"\u8bf7\u9009\u62e9\u91cd\u5b9a\u5411\u65b9\u5f0f",trigger:"blur"}],target:[{required:!0,message:"\u8bf7\u8f93\u5165\u76ee\u6807",trigger:"blur"}],keepUrlPath:[{required:!0,message:"\u8bf7\u9009\u62e9",trigger:"blur"}],status:[{required:!0,message:"\u8bf7\u9009\u62e9",trigger:"blur"}]});function U(){o.value=!1,s.value="",u.value={redirectId:m(9),type:"domain",domains:[],redirectCode:"301",redirectRoot:!0,path:"",target:"http://",keepUrlPath:!0,status:!0,operate:"add"}}function P(){u.value.operate="add",s.value="\u65b0\u589e\u91cd\u5b9a\u5411",o.value=!0}function M(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="",r.sysGetSitesManage({id:t.id,action:"get_site_redirect"}).then((e=>{a.loadingInfo.isLoading=!1,2e3===e.code?c.value=e.data:A.warning(e.msg)}))}function F(e,l){let o=!0,n="\u542f\u52a8";"stop"==e&&(o=!1,n="\u505c\u6b62"),Y.confirm(`\u786e\u5b9a\u8981${n}\u5417\uff1f`,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let i=l;i.operate="edit",i.status=o,i.editStatus=!0;let d={action:"set_site_redirect",id:t.id,cont:i};a.loadingInfo.isLoading=!0,a.loadingInfo.content=`\u6b63\u5728${n}...`,r.sysGetSitesManage(d).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),U(),M()):A.warning(e.msg)}))})).catch((()=>{}))}let E=_(null);function O(){E.value.validate((e=>{if(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_redirect",id:t.id,cont:u.value};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),U(),M()):A.warning(e.msg)}))}}))}return R((()=>{M(),r.sysGetSitesDomainList({site:t.id}).then((e=>{if(2e3==e.code)if(e.data.data.length>0){let l=e.data.data;const a=Array.from(new Set(l.map((e=>e.name)))).map((e=>l.find((l=>l.name===e))));p.value=a}else p.value=[]}))})),(e,l)=>{const i=h("el-button"),m=h("el-table-column"),_=h("el-table"),R=h("el-switch"),B=h("el-form-item"),q=h("el-option"),$=h("el-select"),G=h("el-input"),z=h("el-alert"),N=h("el-form");return v(),b("div",null,[k(i,{type:"primary",onClick:P,style:{"margin-bottom":"15px"},icon:"plus"},{default:w((()=>l[10]||(l[10]=[x("\u65b0\u589e")]))),_:1}),k(_,{border:"",data:V(c),"max-height":"500"},{default:w((()=>[k(m,{label:"\u6e90\u57df\u540d/\u8def\u5f84","min-width":"200","show-overflow-tooltip":""},{default:w((({row:e})=>["domain"==e.type?(v(),b("span",ue,D(e.domains?e.domains.join(","):""),1)):(v(),b("span",ce,D(e.path),1))])),_:1}),k(m,{prop:"type",label:"\u7c7b\u578b",width:"90"},{default:w((e=>["path"==e.row.type?(v(),b("span",pe,"\u8def\u5f84")):"domain"==e.row.type?(v(),b("span",me,"\u57df\u540d")):"404"==e.row.type?(v(),b("span",fe,"404")):(v(),b("span",ge))])),_:1}),k(m,{prop:"redirectCode",label:"\u65b9\u5f0f",width:"80"}),k(m,{prop:"target",label:"\u76ee\u6807URL","min-width":"180","show-overflow-tooltip":""}),k(m,{prop:"port",label:"\u72b6\u6001","min-width":"100"},{default:w((({row:e})=>[e.status?(v(),S(i,{key:0,link:"",type:"success",icon:"VideoPlay",onClick:l=>F("stop",e)},{default:w((()=>l[11]||(l[11]=[x(" \u5df2\u5f00\u542f ")]))),_:2},1032,["onClick"])):(v(),S(i,{key:1,link:"",type:"danger",icon:"VideoPause",onClick:l=>F("start",e)},{default:w((()=>l[12]||(l[12]=[x(" \u5df2\u505c\u6b62 ")]))),_:2},1032,["onClick"]))])),_:1}),k(m,{prop:"keepUrlPath",label:"\u4fdd\u7559URL\u53c2\u6570",width:"112"},{default:w((e=>["404"!=e.row.type?(v(),b("span",ye,D(e.row.keepUrlPath?"\u4fdd\u7559":"\u4e0d\u4fdd\u7559"),1)):(v(),b("span",_e))])),_:1}),k(m,{prop:"redirectId",label:"ID",width:"120","show-overflow-tooltip":""}),k(m,{fixed:"right",label:"\u64cd\u4f5c",width:"109"},{default:w((e=>[k(i,{link:"",type:"primary",onClick:l=>function(e){u.value.operate="edit",s.value="\u7f16\u8f91\u91cd\u5b9a\u5411",o.value=!0;let l=d(e);u.value.redirectId=l.redirectId,u.value.type=l.type,u.value.domains=l.domains,u.value.redirectCode=l.redirectCode,u.value.redirectRoot=l.redirectRoot,u.value.path=l.path,u.value.target=l.target,u.value.keepUrlPath=l.keepUrlPath}(e.row)},{default:w((()=>l[13]||(l[13]=[x("\u7f16\u8f91")]))),_:2},1032,["onClick"]),k(i,{link:"",type:"primary",onClick:l=>{return o=e.row,void Y.confirm("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let l=o;l.operate="del";let n={action:"set_site_redirect",id:t.id,cont:l};a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u5220\u9664...",r.sysGetSitesManage(n).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),U(),M()):A.warning(e.msg)}))})).catch((()=>{}));var o}},{default:w((()=>l[14]||(l[14]=[x("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),k(H,{modelValue:V(o),"onUpdate:modelValue":l[9]||(l[9]=e=>j(o)?o.value=e:o=e),title:V(s),width:"680px","before-close":U},{footer:w((()=>[k(i,{onClick:U,loading:V(n)},{default:w((()=>l[17]||(l[17]=[x("\u53d6\u6d88")]))),_:1},8,["loading"]),k(i,{type:"primary",onClick:O,loading:V(n)},{default:w((()=>l[18]||(l[18]=[x("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:w((()=>[k(N,{ref_key:"rulesForm",ref:E,"label-position":"right","label-width":"auto",model:V(u),rules:V(y)},{default:w((()=>[k(B,{label:"\u5f00\u542f\u91cd\u5b9a\u5411",prop:"status"},{default:w((()=>[k(R,{modelValue:V(u).status,"onUpdate:modelValue":l[0]||(l[0]=e=>V(u).status=e)},null,8,["modelValue"])])),_:1}),k(B,{label:"\u91cd\u5b9a\u5411\u7c7b\u578b",prop:"type"},{default:w((()=>[k($,{modelValue:V(u).type,"onUpdate:modelValue":l[1]||(l[1]=e=>V(u).type=e),onChange:l[2]||(l[2]=e=>{"404"!=V(u).type&&(u.value.redirectRoot=!1)}),disabled:"edit"===V(u).operate},{default:w((()=>[k(q,{label:"\u57df\u540d",value:"domain"}),k(q,{label:"\u8def\u5f84",value:"path"}),k(q,{label:"\u9875\u9762404",value:"404"})])),_:1},8,["modelValue","disabled"])])),_:1}),k(B,{label:"\u91cd\u5b9a\u5411\u65b9\u5f0f",prop:"redirectCode"},{default:w((()=>[k($,{modelValue:V(u).redirectCode,"onUpdate:modelValue":l[3]||(l[3]=e=>V(u).redirectCode=e)},{default:w((()=>[k(q,{label:"301",value:"301"}),k(q,{label:"302",value:"302"})])),_:1},8,["modelValue"]),l[15]||(l[15]=T("span",{class:"right-tips"}," 301\u6c38\u4e45\u91cd\u5b9a\u5411\uff0c302\u4e34\u65f6\u91cd\u5b9a\u5411 ",-1))])),_:1}),"path"==V(u).type?(v(),S(B,{key:0,label:"\u8def\u5f84",prop:"path",rules:"path"==V(u).type?V(f):[]},{default:w((()=>[k(G,{modelValue:V(u).path,"onUpdate:modelValue":l[4]||(l[4]=e=>V(u).path=e),modelModifiers:{trim:!0},placeholder:"\u8bf7\u8f93\u5165\u8def\u5f84 \u5982\uff1a/ruyi"},null,8,["modelValue"])])),_:1},8,["rules"])):L("",!0),"domain"==V(u).type?(v(),S(B,{key:1,label:"\u6e90\u57df\u540d",prop:"domains",rules:"domain"==V(u).type?V(g):[]},{default:w((()=>[k($,{modelValue:V(u).domains,"onUpdate:modelValue":l[5]||(l[5]=e=>V(u).domains=e),multiple:""},{default:w((()=>[(v(!0),b(C,null,I(V(p),((e,l)=>(v(),S(q,{key:l,value:e.name,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["rules"])):L("",!0),"404"==V(u).type?(v(),S(B,{key:2,label:"\u91cd\u5b9a\u5411\u5230\u9996\u9875",prop:"redirectRoot"},{default:w((()=>[k(R,{modelValue:V(u).redirectRoot,"onUpdate:modelValue":l[6]||(l[6]=e=>V(u).redirectRoot=e)},null,8,["modelValue"])])),_:1})):L("",!0),!V(u).redirectRoot&&"404"==V(u).type||"path"==V(u).type||"domain"==V(u).type?(v(),S(B,{key:3,label:"\u76ee\u6807URL\u5730\u5740",prop:"target"},{default:w((()=>[k(G,{modelValue:V(u).target,"onUpdate:modelValue":l[7]||(l[7]=e=>V(u).target=e),modelModifiers:{trim:!0},placeholder:"\u8bf7\u8f93\u5165URL\u5730\u5740 \u5982\uff1ahttp://ruyi.lybbn.cn/1.html"},null,8,["modelValue"])])),_:1})):L("",!0),"404"!==V(u).type?(v(),S(B,{key:4,label:"\u4fdd\u7559URL\u53c2\u6570",prop:"keepUrlPath"},{default:w((()=>[k(R,{modelValue:V(u).keepUrlPath,"onUpdate:modelValue":l[8]||(l[8]=e=>V(u).keepUrlPath=e)},null,8,["modelValue"])])),_:1})):L("",!0),"404"==V(u).type?(v(),S(z,{key:5,type:"warning"},{default:w((()=>l[16]||(l[16]=[x("404\u9875\u9762\u91cd\u5b9a\u5411\u53ea\u6709\u4e00\u6761\uff0c\u65b0\u5efa\u7b2c\u4e8c\u6761\u4f1a\u8986\u76d6\u7b2c\u4e00\u6761\u5185\u5bb9!!!")]))),_:1})):L("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-bedb2b86"]]),ve=N({__name:"moduleNginxLllimit",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=i(),t=e;let o=_({plan:"bbs",perserver:300,perip:25,rate:512,status:!1}),n=_([{key:"bbs",name:"\u8bba\u575b/\u535a\u5ba2",values:[300,25,512]},{key:"image",name:"\u56fe\u7247\u7ad9",values:[200,10,1024]},{key:"doanload",name:"\u4e0b\u8f7d\u7ad9",values:[50,3,2048]},{key:"shop",name:"\u5546\u57ce",values:[500,10,2048]},{key:"portalsite",name:"\u95e8\u6237",values:[400,15,1024]},{key:"company",name:"\u4f01\u4e1a",values:[60,10,512]},{key:"video",name:"\u89c6\u9891",values:[150,4,1024]}]),d=_({perserver:[{required:!0,message:"\u8bf7\u8f93\u5165\u5e76\u53d1\u9650\u5236",trigger:"blur"}],perip:[{required:!0,message:"\u8bf7\u8f93\u5165\u5355IP\u9650\u5236",trigger:"blur"}],rate:[{required:!0,message:"\u8bf7\u8f93\u5165\u6d41\u91cf\u9650\u5236",trigger:"blur"}]});function s(e){"custom"==e?(o.value.perserver=null,o.value.perip=null,o.value.rate=null):n.value.forEach((l=>{l.key===e&&(o.value.perserver=l.values[0],o.value.perip=l.values[1],o.value.rate=l.values[2])}))}function u(e){"custom"!=o.value.plan&&(o.value.plan="custom")}let c=_(null);function p(){c.value.validate((e=>{if(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_ratelimit",id:t.id,cont:o.value};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?A.success(e.msg):A.warning(e.msg)}))}}))}return R((()=>{!function(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="";let e={action:"get_site_ratelimit",id:t.id};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,2e3===e.code?o.value=e.data:A.warning(e.msg)}))}()})),(e,l)=>{const a=h("el-switch"),t=h("el-form-item"),i=h("el-option"),r=h("el-select"),m=h("el-input"),f=h("el-form"),g=h("el-button"),y=h("el-col"),_=h("el-row"),j=P("limitPositiveIntNo0");return v(),S(_,{gutter:20},{default:w((()=>[k(y,{xs:24,sm:18,md:18,lg:18,xl:18},{default:w((()=>[k(f,{inline:!1,model:V(o),rules:V(d),ref_key:"rulesForm",ref:c,"label-position":"right","label-width":"auto",style:{"margin-left":"10px"}},{default:w((()=>[k(t,{prop:"status",label:"\u662f\u5426\u542f\u7528"},{default:w((()=>[k(a,{modelValue:V(o).status,"onUpdate:modelValue":l[0]||(l[0]=e=>V(o).status=e)},null,8,["modelValue"])])),_:1}),k(t,{label:"\u9650\u5236\u65b9\u6848"},{default:w((()=>[k(r,{modelValue:V(o).plan,"onUpdate:modelValue":l[1]||(l[1]=e=>V(o).plan=e),onChange:s},{default:w((()=>[(v(!0),b(C,null,I(V(n),((e,l)=>(v(),S(i,{key:l,label:e.name,value:e.key},null,8,["label","value"])))),128)),(v(),S(i,{key:999,label:"\u81ea\u5b9a\u4e49",value:"custom"}))])),_:1},8,["modelValue"])])),_:1}),k(t,{label:"\u5e76\u53d1\u9650\u5236",prop:"perserver"},{default:w((()=>[M(k(m,{modelValue:V(o).perserver,"onUpdate:modelValue":l[2]||(l[2]=e=>V(o).perserver=e),modelModifiers:{number:!0},maxlength:"15",onChange:u},null,8,["modelValue"]),[[j]]),l[5]||(l[5]=T("span",{class:"right-tips"},"\u9650\u5236\u5f53\u524d\u7ad9\u70b9\u6700\u5927\u5e76\u53d1\u6570",-1))])),_:1}),k(t,{label:"\u5355IP\u9650\u5236",prop:"perip"},{default:w((()=>[M(k(m,{modelValue:V(o).perip,"onUpdate:modelValue":l[3]||(l[3]=e=>V(o).perip=e),modelModifiers:{number:!0},maxlength:"15",onChange:u},null,8,["modelValue"]),[[j]]),l[6]||(l[6]=T("span",{class:"right-tips"},"\u9650\u5236\u5355\u4e2aIP\u8bbf\u95ee\u6700\u5927\u5e76\u53d1\u6570",-1))])),_:1}),k(t,{label:"\u6d41\u91cf\u9650\u5236",prop:"rate"},{default:w((()=>[M(k(m,{modelValue:V(o).rate,"onUpdate:modelValue":l[4]||(l[4]=e=>V(o).rate=e),modelModifiers:{number:!0},maxlength:"15",onChange:u},null,8,["modelValue"]),[[j]]),l[7]||(l[7]=T("span",{class:"right-tips"},"\u9650\u5236\u6bcf\u4e2a\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u4e0b\u8f7d\u901f\u7387(\u5355\u4f4d:KB/s)",-1))])),_:1})])),_:1},8,["model","rules"]),k(g,{type:"primary",onClick:p,style:{float:"right"}},{default:w((()=>l[8]||(l[8]=[x("\u4fdd\u5b58\u5e76\u91cd\u8f7d")]))),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-5d99c573"]]),be=N({__name:"moduleNginxProxy",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=i(),t=e;let o=_(!1),n=_(""),s=_(!1);_(!1),_(!1);let u=_("\u65b0\u589e\u53cd\u5411\u4ee3\u7406"),c=_({name:"",proxyPath:"/",proxyPass:"http://",cache:!1,cacheTime:1,cacheUnit:"m",sniEnable:!1,status:!0,advanced:!1,subFilters:[],proxyHost:"$host",operate:"add"}),p=_([]),m=_(""),g=_(""),y=_({name:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0",trigger:"blur"}],proxyPath:[{required:!0,message:"\u8bf7\u8f93\u5165\u4ee3\u7406\u8def\u5f84",trigger:"blur"}],proxyPass:[{required:!0,message:"\u8bf7\u8f93\u5165\u9700\u8f6c\u53d1\u5230\u7684\u540e\u7aef\u5730\u5740",trigger:"blur"}],proxyHost:[{required:!0,message:"\u8bf7\u586b\u5199\u5fc5\u586b\u9879",trigger:"blur"}]});let U=[{required:!0,trigger:"blur",min:1,type:"number",message:"\u8bf7\u8f93\u5165\u7f13\u5b58\u65f6\u95f4"},(D=1,P=99999,{required:!0,trigger:"blur",min:D,max:P,type:"number",message:`\u6570\u5b57\u53ef\u9009\u8303\u56f4${D}\u5230${P}`})];var D,P;function M(){s.value=!1,u.value="",c.value={name:"",proxyPath:"/",proxyPass:"http://",cache:!1,cacheTime:1,cacheUnit:"m",sniEnable:!1,status:!0,subFilters:[],proxyHost:"$host",operate:"add",advanced:!1}}function F(){c.value.operate="add",u.value="\u65b0\u589e\u53cd\u5411\u4ee3\u7406",s.value=!0}function E(){c.value.subFilters.push({key:"",value:""})}function O(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="",r.sysGetSitesManage({id:t.id,action:"get_site_proxy"}).then((e=>{a.loadingInfo.isLoading=!1,2e3===e.code?p.value=e.data:A.warning(e.msg)}))}function B(e,l){let o=!0,n="\u542f\u52a8";"stop"==e&&(o=!1,n="\u505c\u6b62"),Y.confirm(`\u786e\u5b9a\u8981${n}\u5417\uff1f`,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let i=l;i.operate="edit",i.status=o,i.editStatus=!0;let d={action:"set_site_proxy",id:t.id,cont:i};a.loadingInfo.isLoading=!0,a.loadingInfo.content=`\u6b63\u5728${n}...`,r.sysGetSitesManage(d).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),M(),O()):A.warning(e.msg)}))})).catch((()=>{}))}let q=_(null);function $(){q.value.validate((e=>{if(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_proxy",id:t.id,cont:c.value};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),M(),O()):A.warning(e.msg)}))}}))}function G(){n.value="",o.value=!1,m.value=""}function z(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_proxy_conf",id:t.id,name:g.value,conf:m.value};r.sysGetSitesManage(e).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),G()):A.warning(e.msg)}))}return R((()=>{O()})),(e,l)=>{const i=h("el-button"),_=h("el-table-column"),D=h("el-tag"),P=h("el-table"),R=h("el-switch"),N=h("el-form-item"),W=h("el-col"),K=h("el-row"),J=h("el-option"),Q=h("el-select"),X=h("el-input"),ee=h("el-form");return v(),b("div",null,[k(i,{type:"primary",onClick:F,style:{"margin-bottom":"15px"},icon:"plus"},{default:w((()=>l[13]||(l[13]=[x("\u65b0\u589e")]))),_:1}),k(P,{border:"",data:V(p),"max-height":"500"},{default:w((()=>[k(_,{prop:"name",label:"\u540d\u79f0","min-width":"160","show-overflow-tooltip":""}),k(_,{prop:"proxyPath",label:"\u4ee3\u7406\u8def\u5f84","min-width":"120","show-overflow-tooltip":""}),k(_,{prop:"proxyPass",label:"\u8f6c\u53d1\u5230","min-width":"200","show-overflow-tooltip":""}),k(_,{prop:"cache",label:"\u7f13\u5b58","min-width":"100"},{default:w((({row:e})=>[e.cache?(v(),S(D,{key:1,type:"success"},{default:w((()=>l[15]||(l[15]=[x("\u542f\u7528")]))),_:1})):(v(),S(D,{key:0,type:"danger"},{default:w((()=>l[14]||(l[14]=[x("\u7981\u7528")]))),_:1}))])),_:1}),k(_,{prop:"port",label:"\u72b6\u6001","min-width":"100"},{default:w((({row:e})=>[e.status?(v(),S(i,{key:0,link:"",type:"success",icon:"VideoPlay",onClick:l=>B("stop",e)},{default:w((()=>l[16]||(l[16]=[x(" \u5df2\u5f00\u542f ")]))),_:2},1032,["onClick"])):(v(),S(i,{key:1,link:"",type:"danger",icon:"VideoPause",onClick:l=>B("start",e)},{default:w((()=>l[17]||(l[17]=[x(" \u5df2\u505c\u6b62 ")]))),_:2},1032,["onClick"]))])),_:1}),k(_,{fixed:"right",label:"\u64cd\u4f5c",width:"180"},{default:w((e=>[k(i,{link:"",type:"primary",onClick:l=>function(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="";let l={action:"get_site_proxy_conf",id:t.id,name:e.name};r.sysGetSitesManage(l).then((l=>{a.loadingInfo.isLoading=!1,2e3==l.code?(m.value=l.data,g.value=e.name,n.value=`\u4ee3\u7406\u914d\u7f6e\u4fee\u6539\u3010${e.name}\u3011`,o.value=!0):A.warning(l.msg)}))}(e.row)},{default:w((()=>l[18]||(l[18]=[x("\u914d\u7f6e\u6587\u4ef6")]))),_:2},1032,["onClick"]),k(i,{link:"",type:"primary",onClick:l=>function(e){c.value.operate="edit",u.value="\u7f16\u8f91\u53cd\u5411\u4ee3\u7406",s.value=!0;let l=d(e);c.value.name=l.name,c.value.proxyPath=l.proxyPath,c.value.proxyPass=l.proxyPass,c.value.cache=l.cache,c.value.cacheTime=l.cacheTime,c.value.cacheUnit=l.cacheUnit,c.value.sniEnable=l.sniEnable,c.value.status=l.status,c.value.subFilters=l.subFilters,c.value.proxyHost=l.proxyHost,c.value.advanced=l.advanced}(e.row)},{default:w((()=>l[19]||(l[19]=[x("\u7f16\u8f91")]))),_:2},1032,["onClick"]),k(i,{link:"",type:"primary",onClick:l=>{return o=e.row,void Y.confirm("\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{let l=o;l.operate="del";let n={action:"set_site_proxy",id:t.id,cont:l};a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u5220\u9664...",r.sysGetSitesManage(n).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(A.success(e.msg),M(),O()):A.warning(e.msg)}))})).catch((()=>{}));var o}},{default:w((()=>l[20]||(l[20]=[x("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),k(H,{modelValue:V(s),"onUpdate:modelValue":l[10]||(l[10]=e=>j(s)?s.value=e:s=e),title:V(u),width:"680px","before-close":M},{footer:w((()=>[k(i,{onClick:M},{default:w((()=>l[29]||(l[29]=[x("\u53d6\u6d88")]))),_:1}),k(i,{type:"primary",onClick:$},{default:w((()=>l[30]||(l[30]=[x("\u4fdd\u5b58")]))),_:1})])),default:w((()=>[k(ee,{ref_key:"rulesForm",ref:q,"label-position":"right","label-width":"auto",model:V(c),rules:V(y)},{default:w((()=>[k(K,{gutter:10},{default:w((()=>[k(W,{span:12},{default:w((()=>[k(N,{label:"\u5f00\u542f\u4ee3\u7406",prop:"status"},{default:w((()=>[k(R,{modelValue:V(c).status,"onUpdate:modelValue":l[0]||(l[0]=e=>V(c).status=e)},null,8,["modelValue"])])),_:1})])),_:1}),k(W,{span:12},{default:w((()=>[k(N,{label:"\u9ad8\u7ea7\u6a21\u5f0f",prop:"advanced"},{default:w((()=>[k(R,{modelValue:V(c).advanced,"onUpdate:modelValue":l[1]||(l[1]=e=>V(c).advanced=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),V(c).advanced?(v(),S(N,{key:0,label:"\u5f00\u542f\u7f13\u5b58",prop:"cache"},{default:w((()=>[k(R,{modelValue:V(c).cache,"onUpdate:modelValue":l[2]||(l[2]=e=>V(c).cache=e)},null,8,["modelValue"]),l[21]||(l[21]=T("span",{class:"right-tips"}," \u5f00\u542f\u540e\u5185\u5bb9\u7f13\u5b58\u53ef\u80fd\u5bfc\u81f4\u65b0\u6570\u636e\u4e0d\u80fd\u53ca\u65f6\u53d8\u5316 ",-1))])),_:1})):L("",!0),V(c).advanced&&V(c).cache?(v(),S(N,{key:1,label:"\u7f13\u5b58\u65f6\u95f4",prop:"cacheTime",rules:V(c).cache?V(U):[]},{default:w((()=>[k(X,{modelValue:V(c).cacheTime,"onUpdate:modelValue":l[4]||(l[4]=e=>V(c).cacheTime=e),modelModifiers:{number:!0},maxlength:"15"},{append:w((()=>[k(Q,{modelValue:V(c).cacheUnit,"onUpdate:modelValue":l[3]||(l[3]=e=>V(c).cacheUnit=e),style:{width:"100px"}},{default:w((()=>[(v(!0),b(C,null,I(V(f),((e,l)=>(v(),S(J,{key:l,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1},8,["rules"])):L("",!0),k(N,{label:"\u4ee3\u7406\u540d\u79f0",prop:"name"},{default:w((()=>[k(X,{modelValue:V(c).name,"onUpdate:modelValue":l[5]||(l[5]=e=>V(c).name=e),modelModifiers:{trim:!0},disabled:"edit"===V(c).operate,placeholder:"\u8bf7\u8f93\u5165\u53cd\u5411\u4ee3\u7406\u540d\u79f0"},null,8,["modelValue","disabled"])])),_:1}),k(N,{label:"\u4ee3\u7406\u8def\u5f84",prop:"proxyPath"},{default:w((()=>[k(X,{modelValue:V(c).proxyPath,"onUpdate:modelValue":l[6]||(l[6]=e=>V(c).proxyPath=e),modelModifiers:{trim:!0},placeholder:"\u8bf7\u8f93\u5165\u4ee3\u7406\u8def\u5f84\uff08\u524d\u7aef\u8bf7\u6c42\u8def\u5f84\uff09"},null,8,["modelValue"]),l[22]||(l[22]=T("span",{class:"right-tips"}," /\u8868\u793a\u4ee3\u7406\u6240\u6709\uff0c/api \u8868\u793a\u4ee3\u7406\u6240\u6709\u4ee5 /api \u5f00\u5934\u7684\u8bf7\u6c42 ",-1))])),_:1}),k(N,{label:"\u8f6c\u53d1\u5230",prop:"proxyPass"},{default:w((()=>[k(X,{modelValue:V(c).proxyPass,"onUpdate:modelValue":l[7]||(l[7]=e=>V(c).proxyPass=e),modelModifiers:{trim:!0},placeholder:"\u5982\uff1ahttp://127.0.0.1:8000"},null,8,["modelValue"]),l[23]||(l[23]=T("span",{class:"right-tips"}," \u4ee3\u7406\u7684\u7ad9\u70b9\uff0c\u4e00\u822c\u4e3a\u540e\u7aef\u670d\u52a1\u5730\u5740\uff0c\u5982\uff1ahttp://127.0.0.1:8000 ",-1))])),_:1}),k(N,{label:"\u540e\u7aef\u57df\u540d",prop:"proxyHost"},{default:w((()=>[k(X,{modelValue:V(c).proxyHost,"onUpdate:modelValue":l[8]||(l[8]=e=>V(c).proxyHost=e),modelModifiers:{trim:!0},placeholder:"\u5982\uff1ahttp://127.0.0.1:8000"},null,8,["modelValue"]),l[24]||(l[24]=T("span",{class:"right-tips"}," \u8bbe\u7f6e\u4f20\u9012\u7ed9\u540e\u7aef\u670d\u52a1\u5668\u7684Host\u5934\u90e8\u4fe1\u606f\uff0c$host\u4f1a\u88ab\u66ff\u6362\u4e3a\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e2d\u7684\u4e3b\u673a\u540d ",-1))])),_:1}),V(c).advanced?(v(),S(N,{key:2,label:"\u56de\u6e90SNI",prop:"sniEnable"},{default:w((()=>[k(R,{modelValue:V(c).sniEnable,"onUpdate:modelValue":l[9]||(l[9]=e=>V(c).sniEnable=e)},null,8,["modelValue"]),l[25]||(l[25]=T("span",{class:"right-tips"}," \u540e\u7aef\u4e3ahttps\u65f6\u56de\u6e90SNI\u53ef\u786e\u4fdd\u540e\u7aef\u670d\u52a1\u80fd\u6839\u636e\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6b63\u786e\u5730\u9009\u62e9\u8bc1\u4e66 ",-1))])),_:1})):L("",!0),V(c).advanced&&V(c).subFilters.length>0?(v(),S(N,{key:3,label:"\u5185\u5bb9\u66ff\u6362"},{default:w((()=>[(v(!0),b(C,null,I(V(c).subFilters,((e,a)=>(v(),b("div",{style:{width:"100%"},key:a},[k(K,{gutter:10},{default:w((()=>[k(W,{span:11},{default:w((()=>[k(X,{modelValue:e.key,"onUpdate:modelValue":l=>e.key=l,modelModifiers:{trim:!0},placeholder:"\u539f\u5185\u5bb9"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),k(W,{span:11},{default:w((()=>[k(X,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,modelModifiers:{trim:!0},placeholder:"\u66ff\u6362\u4e3a"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),k(W,{span:2},{default:w((()=>[k(i,{link:"",onClick:e=>function(e){c.value.subFilters.splice(e,1)}(a),type:"danger"},{default:w((()=>l[26]||(l[26]=[x(" \u5220\u9664 ")]))),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)])))),128))])),_:1})):L("",!0),V(c).advanced?(v(),S(N,{key:4,label:V(c).subFilters.length>0?"\xa0":"\u5185\u5bb9\u66ff\u6362"},{default:w((()=>[k(i,{type:"primary",icon:"plus",onClick:E,disabled:V(c).subFilters.length>=3},{default:w((()=>l[27]||(l[27]=[x(" \u6dfb\u52a0\u5185\u5bb9\u66ff\u6362 ")]))),_:1},8,["disabled"]),l[28]||(l[28]=T("span",{class:"right-tips"}," \u8bf7\u6c42\u54cd\u5e94\u5185\u5bb9\u66ff\u6362\uff0c\u6700\u591a\u53ef\u6dfb\u52a03\u6761,\u65e0\u9700\u66ff\u6362\u8bf7\u7f6e\u7a7a ",-1))])),_:1},8,["label"])):L("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),k(H,{modelValue:V(o),"onUpdate:modelValue":l[12]||(l[12]=e=>j(o)?o.value=e:o=e),title:V(n),width:"680px","before-close":G},{default:w((()=>[k(Z,{modelValue:V(m),"onUpdate:modelValue":l[11]||(l[11]=e=>j(m)?m.value=e:m=e),fontSize:"13px",placeholder:V(m)?"":"\u672a\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6",showLineNums:!0,lineWrapping:!0,height:"500px",mode:"javascript","read-only":!1,ref:"lyCodemirrorConf"},null,8,["modelValue","placeholder"]),k(i,{type:"primary",style:{"margin-top":"10px","margin-bottom":"10px"},onClick:z},{default:w((()=>l[31]||(l[31]=[x("\u4fdd\u5b58\u5e76\u91cd\u8f7d")]))),_:1}),l[32]||(l[32]=T("div",{class:"ry-cj-care"},[T("li",null,"\u5feb\u6377\u952e CTRL+F \u67e5\u627e\u548c\u66ff\u6362\u5185\u5bb9")],-1))])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-50a88cf8"]]),ke={class:"ruyi-acme-account"},we={__name:"moduleAddAcmeAccount",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=i(),o=a;let n=_(!1),d=_(!1),s=_("\u521b\u5efaACME\u8d26\u53f7"),u=_({email:"",type:"letsencrypt"}),c=[{id:"letsencrypt",name:"Let's Encrypt"}];let p=_({email:[{required:!0,message:"\u90ae\u7bb1\u5fc5\u586b\u9879",trigger:"blur"},{validator:function(e,l,a){return l?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(l)?a():a(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u5730\u5740")):a(new Error("\u8bf7\u8f93\u5165\u90ae\u7bb1"))},trigger:["blur","change"]}]});function m(){o("closed")}let f=_(null);function g(){f.value.validate((e=>{if(e){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u521b\u5efa...";let e={action:"create_acme_account",email:u.value.email,type:u.value.type};r.sysSSLManage(e).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),m(),o("refreshData")):A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){s.value=l,n.value=!0}}),(e,l)=>{const a=h("el-alert"),t=h("el-input"),o=h("el-form-item"),i=h("el-option"),r=h("el-select"),y=h("el-form"),_=h("el-button");return v(),b("div",ke,[k(H,{modelValue:V(n),"onUpdate:modelValue":l[2]||(l[2]=e=>j(n)?n.value=e:n=e),title:V(s),width:"560px","before-close":m,showFullScreen:!1},{footer:w((()=>[k(_,{onClick:m,loading:V(d)},{default:w((()=>l[4]||(l[4]=[x("\u53d6\u6d88")]))),_:1},8,["loading"]),k(_,{type:"primary",onClick:g,loading:V(d)},{default:w((()=>l[5]||(l[5]=[x("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:w((()=>[k(y,{inline:!1,model:V(u),rules:V(p),ref_key:"rulesForm",ref:f,"label-position":"right","label-width":"auto"},{default:w((()=>[k(a,{style:{"margin-bottom":"15px"}},{default:w((()=>l[3]||(l[3]=[x("\u6b64\u90ae\u7bb1\u8d26\u53f7\u7528\u4e8e\u7533\u8bf7SSL\u8bc1\u4e66")]))),_:1}),k(o,{label:"\u90ae\u7bb1\uff1a",prop:"email"},{default:w((()=>[k(t,{modelValue:V(u).email,"onUpdate:modelValue":l[0]||(l[0]=e=>V(u).email=e),placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1",clearable:""},null,8,["modelValue"])])),_:1}),k(o,{label:"\u670d\u52a1\u5546\uff1a",prop:"type"},{default:w((()=>[k(r,{modelValue:V(u).type,"onUpdate:modelValue":l[1]||(l[1]=e=>V(u).type=e),style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9"},{default:w((()=>[(v(!0),b(C,null,I(V(c),((e,l)=>(v(),S(i,{key:l,value:e.id,label:e.name},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},Ve={class:"lySSLApplyDialog"},xe=N({__name:"sslApplyLog",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=a;let o=_(!1),n=_(!1),i=_("\u65e5\u5fd7\u8be6\u60c5"),s=_({id:"",order_no:""}),u={},c=_(""),p=_("55vh"),m=_("log"),f=_(null),g=_(""),y=_(!1);function h(){x(),t("refreshData"),t("closed")}function x(){clearInterval(f.value),f.value=null}R((()=>{window.addEventListener("resize",T),T()})),F((()=>{window.removeEventListener("resize",T),x()}));let C=_(null);function I(){n.value=!0;let e={id:s.value.id,order_no:s.value.order_no,action:g.value,is_renew:y.value};r.sysGetSSLInfo(e).then((e=>{if(n.value=!1,2e3==e.code){if(c.value=e.data.data,U((()=>{C.value&&C.value.scrollToBottom()})),e.data.done&&(x(),"all"!=g.value)){let l=2e3;e.data.error&&(l=5e3),setTimeout((()=>{h()}),l)}}else A.warning(e.msg),setTimeout((()=>{h()}),2e3)}))}let S=_(null),L=_(!1);function T(){U((()=>{const e=S.value.getRef();if(e.dialogContentRef){const l=e.dialogContentRef.$refs.headerRef.offsetHeight||80,a=document.body.offsetHeight;e.dialogContentRef.fullscreen||L.value?p.value=a-l:p.value="55vh"}}))}function D(e){L.value=e,T()}return l({handleOpen:function(e,l){i.value=l,o.value=!0,e&&(u=d(e),s.value.id=u.site_id,s.value.order_no=u.order_no,y.value=u.is_renew,u.action&&(g.value=u.action),"all"!=g.value?f.value=setInterval((()=>{I()}),1e3):I())}}),(e,l)=>(v(),b("div",Ve,[k(H,{ref_key:"codeMirrorDialogRef",ref:S,modelValue:V(o),"onUpdate:modelValue":l[1]||(l[1]=e=>j(o)?o.value=e:o=e),title:V(i),width:"50%",onOnChangeFullScreen:D,"before-close":h,showClose:!1,showFullScreen:!1},{default:w((()=>[k(Z,{modelValue:V(c),"onUpdate:modelValue":l[0]||(l[0]=e=>j(c)?c.value=e:c=e),fontSize:"15px",placeholder:(V(c),""),showLineNums:!1,lineWrapping:!0,mode:V(m),height:V(p),"read-only":!0,ref_key:"lyCodemirror",ref:C},null,8,["modelValue","placeholder","mode","height"])])),_:1},8,["modelValue","title"])]))}},[["__scopeId","data-v-ddb1aecf"]]),Ce={class:"ruyi-letsencrypt"},Ie={key:0},Se={style:{float:"left"}},je={key:2,style:{"margin-top":"20px"}},Le={key:0,style:{display:"flex","align-items":"center",width:"100%"}},Ue={key:1,style:{display:"flex","align-items":"center",width:"100%"}},Te={key:1},De={key:0},Pe={key:1},Me=N({__name:"moduleLetsEncrypt",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=e,t=i(),o=l;let n=_(!1),d=_(!1),s=_({email:"",status:!1}),u=_({verifyType:"file",checkedDomains:[],dnsAccount:""}),c=_([]),p=_(!1),m=_({}),f=_([]),g=_([{label:"\u963f\u91cc\u4e91DNS",name:"aliyun",status:!1},{label:"\u817e\u8baf\u4e91DNS",name:"tencent",status:!1}]),y=_(!1),F=_(!1);function O(e){u.value.checkedDomains=e?f.value:[],F.value=!1}function B(e){const l=e.length;y.value=l===f.value.length,F.value=l>0&&l<f.value.length}function q(){d.value=!0,r.sysGetSSLInfo({action:"get_acme_account",type:"letsencrypt"}).then((e=>{d.value=!1,2e3==e.code?s.value=e.data:A.warning(e.msg)}))}function $(){n.value=!0,r.sysGetSSLInfo({action:"get_cert_list",type:"letsencrypt",site_id:a.id}).then((e=>{n.value=!1,2e3==e.code?c.value=e.data:A.warning(e.msg)}))}let G=_(null);function H(){G.value.validate((e=>{if(e){if(!s.value.status)return void A.warning("\u8bf7\u5148\u521b\u5efaAcme\u8d26\u53f7");if(u.value.checkedDomains.length<1)return void A.warning("\u8bf7\u9009\u62e9\u9700\u8981\u7533\u8bf7\u7684\u57df\u540d");t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u7533\u8bf7...";let e={action:"apply_cert_letsencrypt",domains:u.value.checkedDomains,site_id:a.id};r.sysSSLManage(e).then((e=>{if(t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code){A({showClose:!1,message:e.msg,type:"success",duration:2e3});let l=e.data;l&&Q(l,!1),o("refreshData")}else A.warning(e.msg)}))}}))}function z(){if(!s.value.status)return void A.warning("\u8bf7\u5148\u521b\u5efaAcme\u8d26\u53f7");t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u7eed\u7b7e...";let e={action:"renew_cert_letsencrypt",site_id:a.id};r.sysSSLManage(e).then((e=>{if(t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code){A({showClose:!1,message:e.msg,type:"success",duration:2e3});let l=e.data;l&&Q(l,!0),o("refreshData")}else A.warning(e.msg)}))}let N=_(!1),Y=_(null);function W(){N.value=!0,U((()=>{Y.value.handleOpen(null,"\u521b\u5efaACME\u8d26\u53f7")}))}let K=_(!1),Z=_(null);function Q(e="",l=!1){K.value=!0;let t={order_no:e,site_id:a.id,action:"get_letsencrypt_log",is_renew:l},o="\u7533\u8bf7SSL\u65e5\u5fd7\u8be6\u60c5";l&&(o="\u7eed\u7b7eSSL\u65e5\u5fd7\u8be6\u60c5"),U((()=>{Z.value.handleOpen(t,o)}))}function X(){$()}return R((()=>{q(),r.sysGetSitesDomainList({site:a.id}).then((e=>{if(2e3==e.code)if(e.data.data.length>0){let l=e.data.data,a=[];l.forEach((e=>{a.push(e.name)})),f.value=[...new Set(a)]}else f.value=[];else A.warning(e.msg)})),$()})),(e,l)=>{const a=h("el-button"),t=h("el-link"),o=h("el-descriptions-item"),i=h("el-tag"),r=h("el-tooltip"),_=h("el-descriptions"),U=h("el-divider"),R=h("el-radio"),$=h("el-radio-group"),A=h("el-form-item"),Q=h("el-option"),ee=h("el-select"),le=h("el-checkbox"),ae=h("el-checkbox-group"),te=h("el-scrollbar"),oe=h("el-form"),ne=h("el-input"),ie=h("el-alert"),de=h("el-col"),re=h("el-row"),se=P("loading");return M((v(),b("div",Ce,[M((v(),S(_,{title:"Acme\u8d26\u6237\u7528\u4e8e\u7533\u8bf7\u514d\u8d39\u8bc1\u4e66(90\u5929)",direction:"vertical",column:3,border:""},{extra:w((()=>[V(s).status?L("",!0):(v(),S(a,{key:0,type:"primary",onClick:W},{default:w((()=>l[11]||(l[11]=[x(D("\u521b\u5efaAcme\u8d26\u6237"))]))),_:1}))])),default:w((()=>[k(o,{label:"\u8d26\u53f7(\u90ae\u7bb1)"},{default:w((()=>[V(s).email?(v(),b("span",Ie,D(V(s).email),1)):(v(),S(t,{key:1,underline:!1,type:"danger",onClick:W},{default:w((()=>l[12]||(l[12]=[x("\u8bf7\u5148\u521b\u5efa")]))),_:1}))])),_:1}),k(o,{label:"\u670d\u52a1\u5546"},{default:w((()=>[k(r,{effect:"dark",content:"Let's Encrypt \u662f\u4e00\u5bb6\u514d\u8d39\u3001\u5f00\u653e\u3001\u81ea\u52a8\u5316\u7684\u8bc1\u4e66\u9881\u53d1\u673a\u6784,\u7531\u975e\u8425\u5229\u7ec4\u7ec7\u4e92\u8054\u7f51\u5b89\u5168\u7814\u7a76\u7ec4(ISRG)\u8fd0\u4f5c",placement:"bottom-end"},{default:w((()=>[k(i,null,{default:w((()=>l[13]||(l[13]=[x("Let's Encrypt")]))),_:1})])),_:1})])),_:1}),k(o,{label:"\u72b6\u6001"},{default:w((()=>[k(i,{type:V(s).email?"success":"info"},{default:w((()=>[x(D(V(s).status?"\u5df2\u521b\u5efa":"\u5f85\u521b\u5efa"),1)])),_:1},8,["type"])])),_:1})])),_:1})),[[se,V(d)]]),V(c).length<1||V(p)?(v(),S(U,{key:0,"content-position":"left"},{default:w((()=>l[14]||(l[14]=[x("\u8bc1\u4e66\u7533\u8bf7\uff08\u9ed8\u8ba4\u81ea\u52a8\u7eed\u7b7e\uff09")]))),_:1})):L("",!0),V(c).length<1||V(p)?(v(),S(oe,{key:1,inline:!1,model:V(u),rules:V(m),ref_key:"rulesForm",ref:G,"label-position":"right","label-width":"auto",style:{padding:"10px 25px 10px 25px"}},{default:w((()=>[k(A,{label:"\u9a8c\u8bc1\u65b9\u6cd5"},{default:w((()=>[k($,{modelValue:V(u).verifyType,"onUpdate:modelValue":l[0]||(l[0]=e=>V(u).verifyType=e)},{default:w((()=>[k(R,{value:"file",label:"\u6587\u4ef6\u9a8c\u8bc1"})])),_:1},8,["modelValue"]),l[15]||(l[15]=T("span",{class:"right-tips"},"\u6587\u4ef6\u9a8c\u8bc1\u65e0\u6cd5\u7533\u8bf7\u6cdb\u57df\u540d\u89e3\u6790",-1))])),_:1}),"dnsAccount"==V(u).verifyType?(v(),S(A,{key:0,label:"DNS\u8d26\u53f7"},{default:w((()=>[k(ee,{modelValue:V(u).dnsAccount,"onUpdate:modelValue":l[1]||(l[1]=e=>V(u).dnsAccount=e),style:{width:"300px"}},{default:w((()=>[(v(!0),b(C,null,I(V(g),((e,l)=>(v(),S(Q,{key:l,label:e.label,value:e.name},{default:w((()=>[T("span",Se,D(e.label),1),T("span",{style:E({float:"right",color:e.status?"var(--el-color-success)":"var(--el-text-color-secondary)","font-size":"13px"})},D(e.status?"\u5df2\u914d\u7f6e":"\u672a\u914d\u7f6e"),5)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"]),k(a,{style:{"margin-left":"10px"}},{default:w((()=>l[16]||(l[16]=[x("\u914d\u7f6e")]))),_:1})])),_:1})):L("",!0),k(A,{label:"\u7533\u8bf7\u57df\u540d"},{default:w((()=>[k(te,{height:"200px",style:{width:"300px",border:"1px solid #f1f1f1",padding:"10px"}},{default:w((()=>[k(le,{modelValue:V(y),"onUpdate:modelValue":l[2]||(l[2]=e=>j(y)?y.value=e:y=e),indeterminate:V(F),onChange:O},{default:w((()=>l[17]||(l[17]=[x("\u5168\u9009")]))),_:1},8,["modelValue","indeterminate"]),k(ae,{modelValue:V(u).checkedDomains,"onUpdate:modelValue":l[3]||(l[3]=e=>V(u).checkedDomains=e),onChange:B,style:{display:"flex","flex-direction":"column","margin-left":"20px"}},{default:w((()=>[(v(!0),b(C,null,I(V(f),((e,l)=>(v(),S(le,{key:l,label:e,value:e},{default:w((()=>[x(D(e),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),k(A,{label:" "},{default:w((()=>[k(a,{type:"primary",onClick:H},{default:w((()=>l[18]||(l[18]=[x("\u7533\u8bf7\u8bc1\u4e66")]))),_:1}),V(p)?(v(),S(a,{key:0,onClick:l[4]||(l[4]=e=>j(p)?p.value=!1:p=!1)},{default:w((()=>l[19]||(l[19]=[x("\u53d6\u6d88\u91cd\u65b0\u7533\u8bf7")]))),_:1})):L("",!0)])),_:1})])),_:1},8,["model","rules"])):L("",!0),V(c).length>0&&!V(p)?(v(),b("div",je,[k(_,{title:"\u8bc1\u4e66\u4fe1\u606f",border:!0,column:2,style:{"margin-bottom":"15px"},class:"rydescriptions"},{extra:w((()=>[k(a,{onClick:l[5]||(l[5]=e=>j(p)?p.value=!0:p=!0)},{default:w((()=>l[20]||(l[20]=[x("\u91cd\u65b0\u7533\u8bf7")]))),_:1}),k(a,{type:"primary",onClick:z},{default:w((()=>l[21]||(l[21]=[x("\u7eed\u7b7e\u8bc1\u4e66")]))),_:1})])),default:w((()=>[k(o,{label:"\u7b7e\u540d"},{default:w((()=>[x(D(V(c)[0].certinfo.organization_name||"-"),1)])),_:1}),k(o,{label:"\u8ba4\u8bc1\u57df\u540d/IP"},{default:w((()=>{return[x(D((e=V(c)[0].certinfo,e?e.san_names&&e.san_names.length>0?e.san_names.join("\u3001"):e.common_name:"-")),1)];var e})),_:1}),k(o,{label:"\u8bc1\u4e66\u7c7b\u578b"},{default:w((()=>[V(c)[0].certinfo.common_name?(v(),b("div",Le,[k(i,null,{default:w((()=>[x(D(V(c)[0].certinfo.type||""),1)])),_:1}),"\u81ea\u7b7e\u8bc1\u4e66"==V(c)[0].certinfo.type?(v(),S(a,{key:0,size:"small",type:"primary",style:{"margin-left":"10px","margin-right":"10px"},onClick:e.downlowdFile},{default:w((()=>l[22]||(l[22]=[x("\u70b9\u51fb\u4e0b\u8f7d\u6839\u8bc1\u4e66")]))),_:1},8,["onClick"])):L("",!0),"\u81ea\u7b7e\u8bc1\u4e66"==V(c)[0].certinfo.type?(v(),b("div",Ue,[l[23]||(l[23]=x(" \u8bc1\u4e66\u5bc6\u7801\uff1a ")),k(ne,{modelValue:V(c)[0].root_password,"onUpdate:modelValue":l[6]||(l[6]=e=>V(c)[0].root_password=e),size:"small",style:{width:"100px"},disabled:!0},null,8,["modelValue"]),k(J,{content:V(c)[0].root_password,size:"small"},null,8,["content"])])):L("",!0)])):(v(),b("span",Te,"-"))])),_:1}),k(o,{label:"\u8fc7\u671f\u65f6\u95f4"},{default:w((()=>[V(c)[0].certinfo.not_valid_after?(v(),b("span",De,[x(D(V(c)[0].certinfo.not_valid_after),1),T("span",{style:E({color:V(c)[0].expire_days>25?"var(--el-color-success)":"var(--el-color-danger)"})},"\uff08\u5269\u4f59\uff1a"+D(V(c)[0].expire_days)+"\u5929\uff09",5)])):(v(),b("span",Pe,D("-")))])),_:1})])),_:1}),"\u81ea\u7b7e\u8bc1\u4e66"==V(c)[0].certinfo.type?(v(),S(ie,{key:0,type:"success"},{default:w((()=>l[24]||(l[24]=[x("\u3010\u81ea\u7b7e\u8bc1\u4e66\u3011\u4e0d\u88ab\u6d4f\u89c8\u5668\u4fe1\u4efb\uff0c\u6d4f\u89c8\u5668\u4f1a\u663e\u793a\u3010\u4e0d\u5b89\u5168...\u3011\u63d0\u793a\uff0c\u4e0b\u8f7d\u6839\u8bc1\u4e66\u6216\u3010\u7ee7\u7eed\u524d\u5f80...\u3011\u5373\u53ef")]))),_:1})):L("",!0),k(re,{gutter:20},{default:w((()=>[k(de,{xs:24,sm:24,md:12,lg:12,xl:12},{default:w((()=>[T("div",null,[l[25]||(l[25]=T("div",null,"\u79c1\u94a5(KEY)\uff1a",-1)),k(ne,{style:{"margin-top":"5px"},modelValue:V(c)[0].key,"onUpdate:modelValue":l[7]||(l[7]=e=>V(c)[0].key=e),autosize:{minRows:6,maxRows:8},type:"textarea",disabled:!0},null,8,["modelValue"])])])),_:1}),k(de,{xs:24,sm:24,md:12,lg:12,xl:12},{default:w((()=>[T("div",null,[l[26]||(l[26]=T("div",null,"\u8bc1\u4e66(PEM\u683c\u5f0f)\uff1a",-1)),k(ne,{style:{"margin-top":"5px"},modelValue:V(c)[0].cert,"onUpdate:modelValue":l[8]||(l[8]=e=>V(c)[0].cert=e),autosize:{minRows:6,maxRows:8},type:"textarea",disabled:!0},null,8,["modelValue"])])])),_:1})])),_:1})])):L("",!0),V(N)?(v(),S(we,{key:3,ref_key:"addAcmeAccountFlag",ref:Y,onClosed:l[9]||(l[9]=e=>j(N)?N.value=!1:N=!1),onRefreshData:q},null,512)):L("",!0),V(K)?(v(),S(xe,{key:4,ref_key:"sslApplyLogFlag",ref:Z,onClosed:l[10]||(l[10]=e=>j(K)?K.value=!1:K=!1),onRefreshData:X},null,512)):L("",!0)])),[[se,V(n)]])}}},[["__scopeId","data-v-aed8afd4"]]),Re={key:0,style:{display:"flex","align-items":"center",width:"100%"}},Fe={key:1,style:{display:"flex","align-items":"center",width:"100%"}},Ee={key:1},Oe={key:0},Be={key:1},qe=N({__name:"moduleCurrentSSL",props:{id:{type:[Number,String],default:""}},emits:["refreshData","jump"],setup(e,{emit:l}){const a=e,t=i(),o=l;let n=_(!1),d=_({key:"",cert:"",certinfo:{},forceHttps:!1,enableHttps:!1,root_password:"",expire_days:0}),s=_({key:[{required:!0,message:"\u79c1\u94a5(KEY)\u5fc5\u586b",trigger:"blur"}],cert:[{required:!0,message:"\u8bc1\u4e66(PEM\u683c\u5f0f)\u5fc5\u586b",trigger:"blur"}]});function u(e){let l=d.value.enableHttps;d.value.enableHttps=!d.value.enableHttps;let o="\u786e\u5b9a\u8981\u5f00\u542fHTTPS\u5417\uff1f",n="\u5f00\u542f";e?(o="\u786e\u5b9a\u8981\u5f00\u542fHTTPS\u5417\uff1f",n="\u5f00\u542f"):(o="\u786e\u5b9a\u8981\u5173\u95edHTTPS\u5417\uff1f",n="\u5173\u95ed"),Y.confirm(o,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content=`\u6b63\u5728${n}HTTPS...`,r.sysGetSitesManage({id:a.id,action:"set_site_ssl_status",cont:{status:l}}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success("\u8bbe\u7f6e\u6210\u529f"),d.value.enableHttps=!d.value.enableHttps):A.warning(e.msg)}))})).catch((()=>{}))}function c(e){let l=d.value.forceHttps;d.value.forceHttps=!d.value.forceHttps;let o="\u786e\u5b9a\u8981\u5f00\u542f\u5f3a\u5236HTTPS\u5417\uff1f",n="\u5f00\u542f";e?(o="\u786e\u5b9a\u8981\u5f00\u542f\u5f3a\u5236HTTPS\u5417\uff1f",n="\u5f00\u542f"):(o="\u786e\u5b9a\u8981\u5173\u95ed\u5f3a\u5236HTTPS\u5417\uff1f",n="\u5173\u95ed"),Y.confirm(o,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content=`\u6b63\u5728${n}\u5f3a\u5236HTTPS...`,r.sysGetSitesManage({id:a.id,action:"set_site_ssl_forcehttps",cont:{status:l}}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success("\u8bbe\u7f6e\u6210\u529f"),d.value.forceHttps=!d.value.forceHttps):A.warning(e.msg)}))})).catch((()=>{}))}let p=_(null);function m(){p.value.validate((e=>{e&&Y.confirm("\u786e\u5b9a\u8981\u4fdd\u5b58\u8bc1\u4e66\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u8bbe\u7f6e\u8bc1\u4e66...",r.sysGetSitesManage({id:a.id,action:"save_site_ssl_cert",cont:{cert:d.value.cert,key:d.value.key}}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?A.success("\u4fdd\u5b58\u6210\u529f"):A.warning(e.msg)}))})).catch((()=>{}))}))}function f(){"Let's Encrypt"==d.value.certinfo.organization_name&&o("jump","letsencrypt")}return R((()=>{n.value=!0,r.sysGetSitesManage({action:"get_site_cert",id:a.id}).then((e=>{n.value=!1,2e3==e.code?d.value=e.data:A.warning(e.msg)}))})),(e,l)=>{const a=h("el-switch"),t=h("el-form-item"),o=h("el-col"),i=h("el-row"),r=h("el-button"),g=h("el-descriptions-item"),y=h("el-tag"),_=h("el-input"),C=h("el-descriptions"),I=h("el-alert"),j=h("el-form"),U=P("loading");return M((v(),S(j,{inline:!1,model:V(d),rules:V(s),ref_key:"rulesForm",ref:p,"label-position":"top","label-width":"auto"},{default:w((()=>[k(i,null,{default:w((()=>[k(o,{span:6},{default:w((()=>[k(t,{label:"\u542f\u7528HTTPS",prop:"enableHttps","label-position":"right"},{default:w((()=>[k(a,{modelValue:V(d).enableHttps,"onUpdate:modelValue":l[0]||(l[0]=e=>V(d).enableHttps=e),onChange:u},null,8,["modelValue"])])),_:1})])),_:1}),k(o,{span:6},{default:w((()=>[k(t,{label:"\u5f3a\u5236HTTPS",prop:"forceHttps","label-position":"right"},{default:w((()=>[k(a,{modelValue:V(d).forceHttps,"onUpdate:modelValue":l[1]||(l[1]=e=>V(d).forceHttps=e),onChange:c},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),k(C,{title:"\u8bc1\u4e66\u4fe1\u606f",border:!0,column:2,style:{"margin-bottom":"15px"},class:"rydescriptions"},{extra:w((()=>{return[(e=V(d).certinfo.organization_name,"Let's Encrypt"==e?(v(),S(r,{key:0,type:"primary",onClick:f},{default:w((()=>l[5]||(l[5]=[x("\u7eed\u7b7e\u8bc1\u4e66")]))),_:1})):L("",!0))];var e})),default:w((()=>[k(g,{label:"\u7b7e\u540d"},{default:w((()=>[x(D(V(d).certinfo.organization_name||"-"),1)])),_:1}),k(g,{label:"\u8ba4\u8bc1\u57df\u540d/IP"},{default:w((()=>{return[x(D((e=V(d).certinfo,e?e.san_names&&e.san_names.length>0?e.san_names.join("\u3001"):e.common_name:"-")),1)];var e})),_:1}),k(g,{label:"\u8bc1\u4e66\u7c7b\u578b"},{default:w((()=>[V(d).certinfo.common_name?(v(),b("div",Re,[k(y,null,{default:w((()=>[x(D(V(d).certinfo.type||""),1)])),_:1}),"\u81ea\u7b7e\u8bc1\u4e66"==V(d).certinfo.type?(v(),S(r,{key:0,size:"small",type:"primary",style:{"margin-left":"10px","margin-right":"10px"},onClick:e.downlowdFile},{default:w((()=>l[6]||(l[6]=[x("\u70b9\u51fb\u4e0b\u8f7d\u6839\u8bc1\u4e66")]))),_:1},8,["onClick"])):L("",!0),"\u81ea\u7b7e\u8bc1\u4e66"==V(d).certinfo.type?(v(),b("div",Fe,[l[7]||(l[7]=x(" \u8bc1\u4e66\u5bc6\u7801\uff1a ")),k(_,{modelValue:V(d).root_password,"onUpdate:modelValue":l[2]||(l[2]=e=>V(d).root_password=e),size:"small",style:{width:"100px"},disabled:!0},null,8,["modelValue"]),k(J,{content:V(d).root_password,size:"small"},null,8,["content"])])):L("",!0)])):(v(),b("span",Ee,"-"))])),_:1}),k(g,{label:"\u8fc7\u671f\u65f6\u95f4"},{default:w((()=>[V(d).certinfo.not_valid_after?(v(),b("span",Oe,[x(D(V(d).certinfo.not_valid_after),1),T("span",{style:E({color:V(d).expire_days>25?"var(--el-color-success)":"var(--el-color-danger)"})},"\uff08\u5269\u4f59\uff1a"+D(V(d).expire_days)+"\u5929\uff09",5)])):(v(),b("span",Be,D("-")))])),_:1})])),_:1}),"\u81ea\u7b7e\u8bc1\u4e66"==V(d).certinfo.type?(v(),S(I,{key:0,type:"success"},{default:w((()=>l[8]||(l[8]=[x("\u3010\u81ea\u7b7e\u8bc1\u4e66\u3011\u4e0d\u88ab\u6d4f\u89c8\u5668\u4fe1\u4efb\uff0c\u6d4f\u89c8\u5668\u4f1a\u663e\u793a\u3010\u4e0d\u5b89\u5168...\u3011\u63d0\u793a\uff0c\u4e0b\u8f7d\u6839\u8bc1\u4e66\u6216\u3010\u7ee7\u7eed\u524d\u5f80...\u3011\u5373\u53ef")]))),_:1})):L("",!0),k(i,{gutter:20},{default:w((()=>[k(o,{xs:24,sm:24,md:12,lg:12,xl:12},{default:w((()=>[k(t,{prop:"key"},{label:w((()=>l[9]||(l[9]=[T("span",null,"\u79c1\u94a5(KEY)\uff1a",-1)]))),default:w((()=>[k(_,{modelValue:V(d).key,"onUpdate:modelValue":l[3]||(l[3]=e=>V(d).key=e),autosize:{minRows:6,maxRows:8},type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1}),k(o,{xs:24,sm:24,md:12,lg:12,xl:12},{default:w((()=>[k(t,{prop:"cert"},{label:w((()=>l[10]||(l[10]=[T("span",null,"\u8bc1\u4e66(PEM\u683c\u5f0f)\uff1a",-1)]))),default:w((()=>[k(_,{modelValue:V(d).cert,"onUpdate:modelValue":l[4]||(l[4]=e=>V(d).cert=e),autosize:{minRows:6,maxRows:8},type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),k(t,null,{default:w((()=>[k(r,{type:"primary",onClick:m},{default:w((()=>l[11]||(l[11]=[x("\u4fdd\u5b58\u8bc1\u4e66")]))),_:1})])),_:1}),l[12]||(l[12]=T("div",{class:"ry-cj-care"},[T("li",null,"\u7c98\u8d34\u60a8\u7684\u8bc1\u4e66\u79d8\u94a5KEY\u548c\u8bc1\u4e66PEM\u5185\u5bb9\uff0c\u7136\u540e\u3010\u4fdd\u5b58\u8bc1\u4e66\u3011\u5373\u53ef"),T("li",null,"\u82e5\u65e0\u8bc1\u4e66\uff0c\u53ef\u4f7f\u7528\u3010Let's Encrypt\u3011\u8bc1\u4e66\uff0c\u6709\u6548\u671f90\u5929\uff0c\u8bf7\u6ce8\u610f\u53ca\u65f6\u7eed\u7b7e"),T("li",null,"\u4f7f\u7528Let's Encrypt\u8bc1\u4e66\u4e14\u5373\u5c06\u8fc7\u671f\u65f6\uff0c\u70b9\u51fb\u3010\u7eed\u7b7e\u8bc1\u4e66\u3011\u5373\u53ef"),T("li",null,"\u5982\u542f\u7528HTTPS\u540e\u65e0\u6cd5\u4f7f\u7528HTTPS\u8bbf\u95ee\uff0c\u8bf7\u68c0\u67e5\u670d\u52a1\u5668\u3010\u9632\u706b\u5899\u3011\u6216\u3010\u5b89\u5168\u7ec4\u3011\u662f\u5426\u653e\u901a443\u7aef\u53e3")],-1))])),_:1},8,["model","rules"])),[[U,V(n)]])}}},[["__scopeId","data-v-850aa927"]]),$e={class:"ruyi-inner-ssl"},Ge=N({__name:"moduleNginxSSL",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){i();const a=e;let t=_("current");function o(e){}function n(e){t.value=e}return(e,l)=>{const i=h("el-tab-pane"),d=h("el-tabs");return v(),b("div",$e,[k(d,{modelValue:V(t),"onUpdate:modelValue":l[0]||(l[0]=e=>j(t)?t.value=e:t=e),onTabClick:o,"tab-position":"top",type:"card"},{default:w((()=>[k(i,{label:"\u5f53\u524d\u8bc1\u4e66",name:"current"},{default:w((()=>["current"==V(t)?(v(),S(qe,{key:0,id:a.id,onJump:n},null,8,["id"])):L("",!0)])),_:1}),k(i,{label:"Let's Encrypt",name:"letsencrypt"},{default:w((()=>["letsencrypt"==V(t)?(v(),S(Me,{key:0,id:a.id},null,8,["id"])):L("",!0)])),_:1})])),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-471e1fb4"]]),He={class:"lyflex"},ze={class:"lyflex"},Ne={class:"lyflex"},Ae=N({__name:"moduleNginxAntiChain",props:{id:{type:[Number,String],default:""}},emits:["refreshData"],setup(e,{emit:l}){const a=i(),t=e;let o=_({status:!1,exts:"js,css,png,jpg,jpeg,gif,ico,bmp,swf,eot,svg,ttf,woff,woff2",noReferer:!0,domains:"",returnCode:"404"}),n=_({exts:[{required:!0,message:"\u8bf7\u8f93\u5165\u6269\u5c55\u540d",trigger:"blur"}],domains:[{required:!0,message:"\u8bf7\u8f93\u5165\u5141\u8bb8\u7684\u57df\u540d",trigger:"change"}],returnCode:[{required:!0,message:"\u8bf7\u8f93\u5165\u54cd\u5e94\u8d44\u6e90",trigger:"blur"}]});let d=_(null);function s(){d.value.validate((e=>{if(e){a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e=o.value;e.domains=e.domains.replace(/\n/g,",");let l={action:"set_site_antichain",id:t.id,cont:e};r.sysGetSitesManage(l).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?A.success(e.msg):A.warning(e.msg)}))}}))}return R((()=>{!function(){a.loadingInfo.isLoading=!0,a.loadingInfo.content="";let e={action:"get_site_antichain",id:t.id};r.sysGetSitesManage(e).then((e=>{if(a.loadingInfo.isLoading=!1,2e3===e.code){let l=e.data;l.domains=l.domains.replace(/,/g,"\n"),o.value=l}else A.warning(e.msg)}))}()})),(e,l)=>{const a=h("el-switch"),t=h("el-form-item"),i=h("InfoFilled"),r=h("el-icon"),u=h("el-tooltip"),c=h("el-input"),p=h("el-form"),m=h("el-button"),f=h("el-col"),g=h("el-row");return v(),S(g,{gutter:20},{default:w((()=>[k(f,{xs:24,sm:20,md:20,lg:20,xl:20},{default:w((()=>[k(p,{model:V(o),rules:V(n),ref_key:"rulesForm",ref:d,"label-position":"right","label-width":"auto",style:{"margin-left":"10px"}},{default:w((()=>[k(t,{label:"\u542f\u7528\u9632\u76d7\u94fe"},{default:w((()=>[k(a,{modelValue:V(o).status,"onUpdate:modelValue":l[0]||(l[0]=e=>V(o).status=e)},null,8,["modelValue"])])),_:1}),k(t,{label:"\u6269\u5c55\u540d",prop:"exts"},{label:w((()=>[T("div",He,[l[5]||(l[5]=T("div",{style:{"margin-right":"3px"}},"\u6269\u5c55\u540d",-1)),k(u,{effect:"dark",content:"\u6587\u4ef6\u540e\u7f00,\u4f7f\u7528','\u5206\u9694,\u5982: png,jpg",placement:"top-start"},{default:w((()=>[k(r,null,{default:w((()=>[k(i)])),_:1})])),_:1})])])),default:w((()=>[k(c,{modelValue:V(o).exts,"onUpdate:modelValue":l[1]||(l[1]=e=>V(o).exts=e),type:"text"},null,8,["modelValue"])])),_:1}),k(t,{label:"\u5141\u8bb8\u7a7a\u6765\u6e90",prop:"noReferer"},{label:w((()=>[T("div",ze,[l[6]||(l[6]=T("div",{style:{"margin-right":"3px"}},"\u5141\u8bb8\u7a7a\u6765\u6e90",-1)),k(u,{effect:"dark",content:"\u5141\u8bb8\u7a7aHTTP_REFERER\u7684header\u8bf7\u6c42",placement:"top-start"},{default:w((()=>[k(r,null,{default:w((()=>[k(i)])),_:1})])),_:1})])])),default:w((()=>[k(a,{modelValue:V(o).noReferer,"onUpdate:modelValue":l[2]||(l[2]=e=>V(o).noReferer=e)},null,8,["modelValue"])])),_:1}),k(t,{label:"\u5141\u8bb8\u57df\u540d",prop:"domains"},{default:w((()=>[k(c,{modelValue:V(o).domains,"onUpdate:modelValue":l[3]||(l[3]=e=>V(o).domains=e),placeholder:"\u4e00\u884c\u4e00\u4e2a\u57df\u540d",type:"textarea",autosize:{minRows:6,maxRows:20}},null,8,["modelValue"])])),_:1}),k(t,{label:"\u54cd\u5e94\u8d44\u6e90",prop:"returnCode"},{label:w((()=>[T("div",Ne,[l[7]||(l[7]=T("div",{style:{"margin-right":"3px"}},"\u54cd\u5e94\u8d44\u6e90",-1)),k(u,{effect:"dark",content:"\u4e00\u822c\u8bbe\u7f6e\u4e3a404/403\u7b49\u72b6\u6001\u7801\uff0c\u4e5f\u53ef\u4e3a\u4e00\u4e2a\u8d44\u6e90(URI\u8def\u5f84\u5982\uff1a/ry.jpg)",placement:"top-start"},{default:w((()=>[k(r,null,{default:w((()=>[k(i)])),_:1})])),_:1})])])),default:w((()=>[k(c,{modelValue:V(o).returnCode,"onUpdate:modelValue":l[4]||(l[4]=e=>V(o).returnCode=e),type:"text",maxlength:35},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),k(m,{type:"primary",onClick:s,style:{float:"right"}},{default:w((()=>l[8]||(l[8]=[x("\u4fdd\u5b58\u5e76\u91cd\u8f7d")]))),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-075ced4a"]]),Ye={class:"lyWebSettingsDialog"},We={style:{display:"flex",width:"100%"}},Ke={style:{display:"flex"}},Ze={style:{"margin-right":"10px","margin-left":"30px"}},Je={style:{"margin-right":"10px","margin-left":"30px"}},Qe=N({__name:"nginxSettings",props:{data:{type:Object}},emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=i(),o=a;let n=_(""),s=_(!1),u=_(!1),c=_(!1),p=_(null),m=_(null),f=_(!1),g=_(null),y=_(!1),C=_(null),I=_({id:null,name:"",path:"",error_log:"",access_log:"",is_error_log:!0,is_access_log:!0,status:!1,conf:"",oldConf:"",tmpDomains:"",defaultDocs:""}),P=_([]);let M=_({tmpDomains:[{required:!0,trigger:"change",validator:function(e,l,a){const t=l.split("\n");let o=!0,n="";t.forEach(((e,l)=>{""!==e&&(function(e){return/^([\w\-\*]{1,150}\.){1,8}([\w\-]{1,30}|[\w\-]{1,30}\.[\w\-]{1,24})(?::\d{1,5})?$/.test(e)}(e)||function(e){return/^(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(?::\d{1,5})?$/.test(e)}(e)||(o=!1,n=`\u7b2c${l+1}\u884c\u683c\u5f0f\u4e0d\u6b63\u786e: ${e}`))})),o?a():a(new Error(n))}}]});function R(){o("closed")}let F=_("baseSettings");let E=_(null);function O(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u9519\u8bef\u65e5\u5fd7...",r.sysGetSitesManage({id:I.value.id,action:"get_site_log",op:"error_log"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(I.value.error_log=e.data,U((()=>{E.value&&E.value.scrollToBottom()}))):A.warning(e.msg)}))}let B=_(null);function q(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u8bbf\u95ee\u65e5\u5fd7...",r.sysGetSitesManage({id:I.value.id,action:"get_site_log",op:"error_log"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(I.value.access_log=e.data,U((()=>{B.value&&B.value.scrollToBottom()}))):A.warning(e.msg)}))}function $(e){let l=I.value.is_error_log;I.value.is_error_log=!I.value.is_error_log;let a="\u786e\u5b9a\u8981\u5173\u95ed\u9519\u8bef\u65e5\u5fd7\u5417\uff1f";a=e?"\u786e\u5b9a\u8981\u5f00\u542f\u9519\u8bef\u65e5\u5fd7\u5417\uff1f":"\u786e\u5b9a\u8981\u5173\u95ed\u9519\u8bef\u65e5\u5fd7\u5417\uff1f",Y.confirm(a,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{r.sysGetSitesManage({id:I.value.id,status:l,action:"site_log_open",op:"error_log"}).then((l=>{2e3==l.code?(A.success("\u4fee\u6539\u6210\u529f"),I.value.is_error_log=e):A.warning(l.msg)}))})).catch((()=>{}))}function G(e){let l=I.value.is_access_log;I.value.is_access_log=!I.value.is_access_log;let a="\u786e\u5b9a\u8981\u5173\u95ed\u8bbf\u95ee\u65e5\u5fd7\u5417\uff1f";a=e?"\u786e\u5b9a\u8981\u5f00\u542f\u8bbf\u95ee\u65e5\u5fd7\u5417\uff1f":"\u786e\u5b9a\u8981\u5173\u95ed\u8bbf\u95ee\u65e5\u5fd7\u5417\uff1f",Y.confirm(a,"\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{r.sysGetSitesManage({id:I.value.id,status:l,action:"site_log_open",op:"access_log"}).then((e=>{2e3==e.code?(A.success("\u4fee\u6539\u6210\u529f"),I.value.is_access_log=!I.value.is_access_log):A.warning(e.msg)}))})).catch((()=>{}))}function N(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u57df\u540d\u5217\u8868...",r.sysGetSitesDomainList({site:I.value.id}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?P.value=e.data.data:A.warning(e.msg)}))}function W(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="",r.sysGetSitesManage({id:I.value.id,action:"get_site_base"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(I.value.path=e.data.path,I.value.defaultDocs=e.data.indexDocs.replace(/,/g,"\n")):A.warning(e.msg)}))}function K(e){"baseSettings"==e.props.name?W():"domainSettings"==e.props.name?N():"error_log"==e.props.name?O():"access_log"==e.props.name?q():"edit_conf"===e.props.name&&(t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6...",r.sysGetSitesManage({id:I.value.id,action:"get_site_conf"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(I.value.conf=e.data,I.value.oldConf=e.data):A.warning(e.msg)})))}function J(){if(I.value.oldConf==I.value.conf)return void A.warning("\u914d\u7f6e\u6587\u4ef6\u672a\u53d8\u52a8\uff0c\u65e0\u9700\u4fdd\u5b58!!!");if(""==I.value.conf||null==I.value.conf)return void A.warning("\u914d\u7f6e\u6587\u4ef6\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u914d\u7f6e");Y.confirm("\u786e\u5b9a\u8981\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\u5417\uff1f","\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6...",r.sysGetSitesManage({id:I.value.id,conf:I.value.conf,action:"save_site_conf"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?A.success("\u4fdd\u5b58\u6210\u529f,\u5e76\u91cd\u8f7d\u914d\u7f6e"):A.warning(e.msg)}))})).catch((()=>{}))}function Q(e){e?(clearInterval(p.value),p.value=setInterval((()=>{O()}),5e3)):(clearInterval(p.value),p.value=null)}function X(e){e?(clearInterval(m.value),m.value=setInterval((()=>{q()}),5e3)):(clearInterval(m.value),m.value=null)}let ee=_(null);function le(){ee.value.validate((e=>{if(e){const e=I.value.tmpDomains.split("\n");let l={action:"add_site_domain",id:I.value.id,domainList:e};t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u6dfb\u52a0\u57df\u540d...",r.sysSitesDomainMg(l).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),I.value.tmpDomains="",ee.value.resetFields(),N()):A.warning(e.msg)}))}}))}function ae(e){f.value=e}function te(){y.value=!0,U((()=>{g.value.handleOpen({path:I.value.path,isDir:!0},"\u76ee\u5f55\u9009\u62e9")}))}function oe(e){I.value.path=e}function ne(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_path",id:I.value.id,path:I.value.path};r.sysGetSitesManage(e).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),C.value.path=I.value.path):A.warning(e.msg)}))}function ie(){t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58...";let e={action:"set_site_indexdoc",id:I.value.id,indexdoc:I.value.defaultDocs.replace(/\n/g,",")};r.sysGetSitesManage(e).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),W()):A.warning(e.msg)}))}return l({handleOpen:function(e,l){n.value=l,s=!0,e&&(C.value=d(e),I.value.id=C.value.id,I.value.name=C.value.name,I.value.status=C.value.status,I.value.path=C.value.path,I.value.is_error_log=C.value.error_log,I.value.is_access_log=C.value.access_log,"baseSettings"==F.value&&W())}}),(e,l)=>{const a=h("el-button"),o=h("el-input"),i=h("el-form-item"),d=h("el-col"),p=h("el-row"),m=h("el-tab-pane"),_=h("el-form"),C=h("el-link"),U=h("el-table-column"),O=h("el-table"),q=h("el-switch"),W=h("InfoFilled"),de=h("el-icon"),re=h("el-tooltip"),se=h("el-tabs"),ue=h("el-main");return v(),b("div",Ye,[k(H,{modelValue:V(s),"onUpdate:modelValue":l[12]||(l[12]=e=>j(s)?s.value=e:s=e),title:V(n),width:"60%","before-close":R,onOnChangeFullScreen:ae},{default:w((()=>[k(ue,null,{default:w((()=>[k(se,{"tab-position":"left",modelValue:V(F),"onUpdate:modelValue":l[10]||(l[10]=e=>j(F)?F.value=e:F=e),onTabClick:K},{default:w((()=>[k(m,{label:"\u57fa\u672c\u8bbe\u7f6e",name:"baseSettings"},{default:w((()=>[k(p,{gutter:20},{default:w((()=>[k(d,{xs:24,sm:20,md:20,lg:20,xl:20,style:{"padding-left":"20px"}},{default:w((()=>[k(i,{label:"\u7f51\u7ad9\u76ee\u5f55\uff1a",class:"is-required"},{default:w((()=>[T("div",We,[k(o,{modelValue:V(I).path,"onUpdate:modelValue":l[0]||(l[0]=e=>V(I).path=e)},{append:w((()=>[k(a,{onClick:te,icon:"Folder",class:"panelsave"},{default:w((()=>l[13]||(l[13]=[x("\u9009\u62e9")]))),_:1})])),_:1},8,["modelValue"]),k(a,{type:"primary",style:{"margin-left":"20px"},onClick:ne},{default:w((()=>l[14]||(l[14]=[x("\u4fdd\u5b58")]))),_:1})])])),_:1}),T("div",Ke,[k(i,{label:"\u9ed8\u8ba4\u6587\u6863\uff1a",prop:"defaultDocs",class:"is-required",style:{width:"100%"}},{default:w((()=>[k(o,{modelValue:V(I).defaultDocs,"onUpdate:modelValue":l[1]||(l[1]=e=>V(I).defaultDocs=e),autosize:{minRows:5,maxRows:8},type:"textarea",placeholder:"\u8bf7\u8f93\u5165\u9ed8\u8ba4\u6587\u6863\u540d\u79f0\uff0c\u4e00\u884c\u4e00\u4e2a\n\u683c\u5f0f\uff1aindex.html",clearable:""},null,8,["modelValue"])])),_:1}),k(i,null,{default:w((()=>[k(a,{type:"primary",onClick:ie,style:{"margin-left":"20px"}},{default:w((()=>l[15]||(l[15]=[x("\u4fdd\u5b58")]))),_:1})])),_:1})])])),_:1})])),_:1})])),_:1}),k(m,{label:"\u57df\u540d\u8bbe\u7f6e",name:"domainSettings"},{default:w((()=>[k(_,{inline:!0,model:V(I),rules:V(M),ref_key:"rulesForm",ref:ee,"label-position":"right","label-width":"auto",style:{"margin-bottom":"20px"}},{default:w((()=>[k(i,{label:"\u57df\u540d\uff1a",prop:"tmpDomains",style:{width:"80%"}},{default:w((()=>[k(o,{modelValue:V(I).tmpDomains,"onUpdate:modelValue":l[2]||(l[2]=e=>V(I).tmpDomains=e),autosize:{minRows:5,maxRows:8},type:"textarea",placeholder:"\u8bf7\u8f93\u5165\u7f51\u7ad9\u57df\u540d\uff0c\u652f\u6301\u591a\u4e2a\uff08\u57df\u540d\u3001IP)+\u7aef\u53e3\uff08\u9ed8\u8ba480\uff09\uff0c\u4e00\u884c\u4e00\u4e2a\n\u57df\u540d\u683c\u5f0f1\uff1awww.lybbn.cn\n\u57df\u540d\u683c\u5f0f2\uff1awww.lybbn.cn:8080\nIP\u683c\u5f0f\uff1a192.168.1.1:8080\n\u6cdb\u89e3\u6790\uff1a*.lybbn.cn",clearable:""},null,8,["modelValue"])])),_:1}),k(i,null,{default:w((()=>[k(a,{type:"primary",onClick:le},{default:w((()=>l[16]||(l[16]=[x("\u4fdd\u5b58")]))),_:1})])),_:1})])),_:1},8,["model","rules"]),k(O,{border:"",data:V(P),"max-height":"500"},{default:w((()=>[k(U,{prop:"name",label:"\u57df\u540d","min-width":"200","show-overflow-tooltip":""},{default:w((e=>[k(C,{type:"primary",href:"http://"+e.row.name,target:"_blank"},{default:w((()=>[x(D(e.row.name),1)])),_:2},1032,["href"])])),_:1}),k(U,{prop:"port",label:"\u7aef\u53e3","min-width":"100"}),k(U,{fixed:"right",label:"\u64cd\u4f5c",width:"100"},{default:w((e=>[k(a,{link:"",type:"primary",onClick:l=>{return a=e.row,void Y.confirm("\u786e\u8ba4\u8981\u5220\u9664\u8be5\u57df\u540d\u5417\uff1f","\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,r.sysSitesDomainMg({sid:I.value.id,id:a.id,domain:a.name,port:a.port,action:"del_site_domain"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),N()):A.warning(e.msg)}))})).catch((()=>{}));var a},disabled:V(P).length<2},{default:w((()=>l[17]||(l[17]=[x("\u5220\u9664")]))),_:2},1032,["onClick","disabled"])])),_:1})])),_:1},8,["data"])])),_:1}),k(m,{label:"SSL\u8bbe\u7f6e",name:"ssl"},{default:w((()=>["ssl"==V(F)?(v(),S(Ge,{key:0,class:"ruyiSSLMg",id:V(I).id},null,8,["id"])):L("",!0)])),_:1}),k(m,{label:"\u53cd\u5411\u4ee3\u7406",name:"proxy"},{default:w((()=>["proxy"==V(F)?(v(),S(be,{key:0,class:"ruyiNginxRedirect",id:V(I).id},null,8,["id"])):L("",!0)])),_:1}),k(m,{label:"\u6d41\u91cf\u9650\u5236",name:"lllimit"},{default:w((()=>["lllimit"==V(F)?(v(),S(ve,{key:0,id:V(I).id},null,8,["id"])):L("",!0)])),_:1}),k(m,{label:"\u9632\u76d7\u94fe",name:"fangdao"},{default:w((()=>["fangdao"==V(F)?(v(),S(Ae,{key:0,id:V(I).id},null,8,["id"])):L("",!0)])),_:1}),k(m,{label:"\u91cd\u5b9a\u5411",name:"redirect"},{default:w((()=>["redirect"==V(F)?(v(),S(he,{key:0,class:"ruyiNginxRedirect",id:V(I).id},null,8,["id"])):L("",!0)])),_:1}),k(m,{label:"\u914d\u7f6e\u6587\u4ef6",name:"edit_conf"},{default:w((()=>[k(Z,{modelValue:V(I).conf,"onUpdate:modelValue":l[3]||(l[3]=e=>V(I).conf=e),fontSize:"13px",placeholder:V(I).conf?"":"\u672a\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6",showLineNums:!0,lineWrapping:!0,mode:"javascript",height:V(f)?"80vh":"60vh","read-only":!1,ref:"lyCodemirrorConf"},null,8,["modelValue","placeholder","height"]),k(a,{type:"primary",style:{"margin-top":"10px","margin-bottom":"10px"},onClick:J},{default:w((()=>l[18]||(l[18]=[x("\u4fdd\u5b58\u5e76\u91cd\u8f7d")]))),_:1}),l[19]||(l[19]=T("div",{class:"ry-cj-care"},[T("li",null,"\u82e5\u60a8\u4e0d\u4e86\u89e3Nginx\u7684\u914d\u7f6e\u6587\u4ef6\u89c4\u5219\uff0c\u8bf7\u52ff\u968f\u610f\u4fee\u6539!!!"),T("li",null,"\u5feb\u6377\u952e CTRL+F \u67e5\u627e\u548c\u66ff\u6362\u5185\u5bb9")],-1))])),_:1}),k(m,{label:"\u9519\u8bef\u65e5\u5fd7",name:"error_log"},{default:w((()=>[T("div",null,[l[21]||(l[21]=T("span",{style:{"margin-right":"10px"}},"\u65e5\u5fd7\u5f00\u5173",-1)),k(q,{modelValue:V(I).is_error_log,"onUpdate:modelValue":l[4]||(l[4]=e=>V(I).is_error_log=e),onChange:$},null,8,["modelValue"]),T("span",Ze,[l[20]||(l[20]=x(" \u5b9a\u65f6\u5237\u65b0 ")),k(re,{effect:"dark",content:"\u9ed8\u8ba45\u79d2\u5237\u65b0\u4e00\u6b21",placement:"top-start"},{default:w((()=>[k(de,null,{default:w((()=>[k(W)])),_:1})])),_:1})]),k(q,{modelValue:V(u),"onUpdate:modelValue":l[5]||(l[5]=e=>j(u)?u.value=e:u=e),onChange:Q},null,8,["modelValue"])]),k(Z,{modelValue:V(I).error_log,"onUpdate:modelValue":l[6]||(l[6]=e=>V(I).error_log=e),fontSize:"13px",placeholder:V(I).error_log?"":"\u5f53\u524d\u6ca1\u6709\u9519\u8bef\u65e5\u5fd7\uff01",showLineNums:!1,lineWrapping:!1,mode:"log",height:V(f)?"86vh":"65vh","read-only":!0,ref_key:"lyCodemirrorErrorLog",ref:E},null,8,["modelValue","placeholder","height"])])),_:1}),k(m,{label:"\u8bbf\u95ee\u65e5\u5fd7",name:"access_log"},{default:w((()=>[T("div",null,[l[23]||(l[23]=T("span",{style:{"margin-right":"10px"}},"\u65e5\u5fd7\u5f00\u5173",-1)),k(q,{modelValue:V(I).is_access_log,"onUpdate:modelValue":l[7]||(l[7]=e=>V(I).is_access_log=e),onChange:G},null,8,["modelValue"]),T("span",Je,[l[22]||(l[22]=x(" \u5b9a\u65f6\u5237\u65b0 ")),k(re,{effect:"dark",content:"\u9ed8\u8ba45\u79d2\u5237\u65b0\u4e00\u6b21",placement:"top-start"},{default:w((()=>[k(de,null,{default:w((()=>[k(W)])),_:1})])),_:1})]),k(q,{modelValue:V(c),"onUpdate:modelValue":l[8]||(l[8]=e=>j(c)?c.value=e:c=e),onChange:X},null,8,["modelValue"])]),k(Z,{modelValue:V(I).access_log,"onUpdate:modelValue":l[9]||(l[9]=e=>V(I).access_log=e),fontSize:"13px",placeholder:V(I).error_log?"":"\u5f53\u524d\u6ca1\u6709\u8bbf\u95ee\u65e5\u5fd7\uff01",showLineNums:!1,lineWrapping:!1,mode:"log",height:V(f)?"86vh":"65vh","read-only":!0,ref_key:"lyCodemirrorAccessLog",ref:B},null,8,["modelValue","placeholder","height"])])),_:1})])),_:1},8,["modelValue"])])),_:1}),V(y)?(v(),S(z,{key:0,class:"ruyidirchoice",ref_key:"choosePathDirFlag",ref:g,onChange:oe,onClosed:l[11]||(l[11]=e=>j(y)?y.value=!1:y=!1)},null,512)):L("",!0)])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-1757eb11"]]),Xe={class:"handle-top"},el={class:"search-sites-input"},ll={class:"lyczj",style:{display:"flex","align-items":"center"}},al=["onClick"],tl={key:0,style:{"font-size":"12px","font-weight":"bold"}},ol={key:0},nl={key:1},il={key:0},dl={key:1},rl={key:0},sl={key:1},ul={key:6,class:"softmask"},cl={key:7,class:"soft-ins-guide-dialog"},pl=N({__name:"index",props:{installed:{type:Boolean,default:!1},status:{type:Boolean,default:!1}},setup(e,{expose:l}){const a=K(),t=i(),o=g();let d=O((()=>o.ismobile)),s=_(!1),u=_(null),c=_(!1),p=_(null),m=_(!1),f=_(null),R=_(!1),F=_([{id:0,name:"\u9ed8\u8ba4\u5206\u7ec4"}]),$=_({page:1,limit:10}),H=_({page:1,limit:10,total:0}),z=_([]);function N(e){$.value.page=e.page,$.value.limit=e.limit,W()}function W(){s.value=!0;let e=n({},$.value);e.module=0,r.sysGetSitesList(e).then((e=>{s.value=!1,2e3===e.code&&(e.data.data.forEach((e=>{e.showEndDate=!1})),z.value=e.data.data,H.value.page=e.data.page,H.value.limit=e.data.limit,H.value.total=e.data.total)}))}function Z(){$.value.page=1,W()}let J=_(!1),Q=_(null);function X(){J.value=!0,U((()=>{Q.value.handleOpen(null,"\u6dfb\u52a0\u7ad9\u70b9")}))}let le=_(null),ae=_(!1);function te(){ae.value=!0,U((()=>{le.value.handleOpen(null,"\u7ad9\u70b9\u5206\u7ec4\u7ba1\u7406")}))}function de(e){c.value=!0,U((()=>{u.value.handleOpen(e,`\u7ad9\u70b9\u3010${e.name}\u3011\u8bbe\u7f6e`)}))}function re(e,l){let a="\u786e\u5b9a\u542f\u52a8\u7ad9\u70b9\u5417\uff1f";"stop"==e&&(a="\u505c\u6b62\u7ad9\u70b9\u540e\uff0c\u8bbf\u95ee\u8be5\u7ad9\u70b9\u4f1a\u663e\u793a\u5f53\u524d\u7ad9\u70b9\u505c\u6b62\u9875\u9762\uff0c\u662f\u5426\u7ee7\u7eed\uff1f"),Y.confirm(`${a}`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{t.loadingInfo.isLoading=!0,r.sysGetSitesManage({id:l,op:e,action:"status_static_site"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),W()):A.warning(e.msg)}))})).catch((()=>{}))}function ue(){R.value=!0,U((()=>{f.value.handleOpen(null,"\u9ed8\u8ba4\u7ad9\u70b9\u8bbe\u7f6e")}))}let ce=_(!1),pe=_(null);function me(){a.push({path:"/appstore"})}return l({RefreshData:function(){U((()=>{r.sysSitegroup({page:1,limit:999}).then((e=>{2e3===e.code&&(F.value=e.data.data)})),W()}))}}),(l,o)=>{const n=h("el-button"),i=h("arrow-down"),g=h("el-icon"),_=h("el-dropdown-item"),O=h("el-dropdown-menu"),K=h("el-dropdown"),fe=h("el-col"),ge=h("el-option"),ye=h("el-select"),_e=h("el-input"),he=h("el-row"),ve=h("el-link"),be=h("el-table-column"),ke=h("el-tooltip"),we=h("el-text"),Ve=h("el-table"),xe=h("InfoFilled"),Ce=P("loading");return v(),b("div",null,[T("div",Xe,[k(he,null,{default:w((()=>[k(fe,{xs:24,sm:16,md:16,lg:16,xl:16},{default:w((()=>[k(n,{type:"primary",onClick:X,disabled:!e.status},{default:w((()=>o[11]||(o[11]=[x("\u6dfb\u52a0\u7ad9\u70b9")]))),_:1},8,["disabled"]),k(n,{type:"primary",plain:"",onClick:te},{default:w((()=>o[12]||(o[12]=[x("\u5206\u7ec4")]))),_:1}),k(n,{icon:"refresh",circle:"",onClick:Z}),k(K,null,{dropdown:w((()=>[k(O,null,{default:w((()=>[k(_,{onClick:ue},{default:w((()=>o[14]||(o[14]=[x("\u9ed8\u8ba4\u7ad9\u70b9")]))),_:1})])),_:1})])),default:w((()=>[k(n,{plain:""},{default:w((()=>[o[13]||(o[13]=x(" \u9ad8\u7ea7\u8bbe\u7f6e")),k(g,{class:"el-icon--right"},{default:w((()=>[k(i)])),_:1})])),_:1})])),_:1})])),_:1}),k(fe,{xs:24,sm:8,md:8,lg:8,xl:8},{default:w((()=>[T("div",el,[k(ye,{modelValue:V($).group,"onUpdate:modelValue":o[0]||(o[0]=e=>V($).group=e),style:{width:"280px","margin-right":"10px"},filterable:"",clearable:""},{prefix:w((()=>o[15]||(o[15]=[x("\u5206\u7ec4")]))),default:w((()=>[(v(!0),b(C,null,I(V(F),(e=>(v(),S(ge,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),k(_e,{modelValue:V($).search,"onUpdate:modelValue":o[1]||(o[1]=e=>V($).search=e),clearable:"",onClear:o[2]||(o[2]=e=>Z()),"suffix-icon":"Search",onKeyup:o[3]||(o[3]=B((e=>Z()),["enter"])),onChange:o[4]||(o[4]=e=>Z()),placeholder:"\u641c\u7d22"},null,8,["modelValue"])])])),_:1})])),_:1})]),M((v(),S(Ve,{data:V(z),style:{width:"100%","border-top":"1px solid var(--el-border-color-lighter)"},"header-cell-class-name":"table-header-style"},{default:w((()=>[k(be,{prop:"name",label:"\u540d\u79f0","min-width":"180"},{default:w((e=>[k(ve,{type:"primary",underline:!1,onClick:q((l=>de(e.row)),["stop"])},{default:w((()=>[x(D(e.row.name),1)])),_:2},1032,["onClick"])])),_:1}),k(be,{prop:"status",label:"\u72b6\u6001",width:"130"},{default:w((({row:e})=>[e.status?(v(),S(n,{key:0,link:"",type:"success",icon:"VideoPlay",onClick:l=>re("stop",e.id)},{default:w((()=>o[16]||(o[16]=[x(" \u5df2\u542f\u52a8 ")]))),_:2},1032,["onClick"])):(v(),S(n,{key:1,link:"",type:"danger",icon:"VideoPause",onClick:l=>re("start",e.id)},{default:w((()=>o[17]||(o[17]=[x(" \u5df2\u505c\u6b62 ")]))),_:2},1032,["onClick"]))])),_:1}),k(be,{prop:"path",label:"\u6839\u76ee\u5f55",width:"90"},{default:w((e=>[T("div",ll,[k(ke,{effect:"dark",content:e.row.path,placement:"bottom"},{default:w((()=>[T("img",{class:"ruyi-fileicons",src:y,onClick:l=>{var o;(o=e.row).path&&(t.fileInfo.currentDir=o.path,a.push({path:"/files"}))}},null,8,al)])),_:2},1032,["content"]),e.row.is_default?(v(),b("span",tl,"(\u9ed8\u8ba4\u7ad9)")):L("",!0)])])),_:1}),k(be,{label:"\u5907\u4efd",width:"100"},{default:w((e=>[k(we,{type:e.row.bakNums<1?"info":"primary",style:{cursor:"pointer"},onClick:l=>{return a=e.row,ce.value=!0,void U((()=>{pe.value.handleOpen(a,"\u3010"+a.name+"\u3011\u7ad9\u70b9\u5907\u4efd")}));var a}},{default:w((()=>[e.row.bakNums<1?(v(),b("span",ol,"\u65e0")):L("",!0),o[18]||(o[18]=x("\u5907\u4efd")),e.row.bakNums>0?(v(),b("span",nl,D("("+e.row.bakNums+")"),1)):L("",!0)])),_:2},1032,["type","onClick"])])),_:1}),k(be,{prop:"endTime",label:"\u5230\u671f\u65f6\u95f4","min-width":"100"},{default:w((({row:e,$index:l})=>[k(ve,{type:"primary",underline:!1,onClick:l=>function(e){m.value=!0,U((()=>{p.value.handleOpen(e,`\u3010${e.name}\u3011\u4fee\u6539\u5230\u671f\u65f6\u95f4`)}))}(e)},{default:w((()=>[e.endTime?(v(),b("span",dl,D(e.endTime),1)):(v(),b("span",il," \u6c38\u4e0d\u8fc7\u671f "))])),_:2},1032,["onClick"])])),_:1}),k(be,{prop:"sslinfo",label:"SSL",width:"100"},{default:w((e=>[e.row.sslinfo.enableHttps?(v(),b("span",rl,[T("span",{style:E({color:e.row.sslinfo.expire_days>25?"var(--el-color-success)":"var(--el-color-danger)"})},"\u5269\u4f59"+D(e.row.sslinfo.expire_days)+"\u5929",5)])):(v(),b("span",sl))])),_:1}),k(be,{prop:"remark",label:"\u5907\u6ce8","min-width":"100","show-overflow-tooltip":""}),k(be,{prop:"create_at",label:"\u521b\u5efa\u65f6\u95f4","min-width":"170"}),k(be,{fixed:!V(d)&&"right",label:"\u64cd\u4f5c",width:"130"},{default:w((e=>[k(n,{link:"",type:"primary",onClick:l=>de(e.row)},{default:w((()=>o[19]||(o[19]=[x("\u914d\u7f6e")]))),_:2},1032,["onClick"]),k(n,{link:"",type:"primary",onClick:l=>{return a=e.row,void Y.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${a.name}\u3011\u7ad9\u70b9\u5417\uff1f\u6b64\u64cd\u4f5c\u4f1a\u5220\u9664\u8be5\u7f51\u7ad9\u7684\u65e5\u5fd7\u3001\u7ad9\u70b9\u76ee\u5f55\u3001\u914d\u7f6e\u4fe1\u606f\u7b49\uff01\uff01\uff01`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,r.sysGetSitesManage({id:a.id,action:"del_static_site"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),W()):A.warning(e.msg)}))})).catch((()=>{}));var a}},{default:w((()=>o[20]||(o[20]=[x("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1},8,["fixed"])])),_:1},8,["data"])),[[Ce,V(s)]]),k(G,{small:!0,"child-msg":V(H),onCallFather:N,border:!1,position:"right"},null,8,["child-msg"]),V(J)?(v(),S(ee,{key:0,ref_key:"moduleAddFlag",ref:Q,onRefreshData:W,onClosed:o[5]||(o[5]=e=>j(J)?J.value=!1:J=!1)},null,512)):L("",!0),V(ae)?(v(),S(oe,{key:1,ref_key:"moduleGroupFlag",ref:le,onClosed:o[6]||(o[6]=e=>j(ae)?ae.value=!1:ae=!1)},null,512)):L("",!0),V(c)?(v(),S(Qe,{key:2,ref_key:"nginxSettingsFlag",ref:u,onClosed:o[7]||(o[7]=e=>j(c)?c.value=!1:c=!1)},null,512)):L("",!0),V(m)?(v(),S(ne,{key:3,ref_key:"endTimeFlag",ref:p,onRefreshData:W,onClosed:o[8]||(o[8]=e=>j(m)?m.value=!1:m=!1)},null,512)):L("",!0),V(R)?(v(),S(ie,{key:4,ref_key:"defaultSiteFlag",ref:f,onRefreshData:W,onClosed:o[9]||(o[9]=e=>j(R)?R.value=!1:R=!1)},null,512)):L("",!0),V(ce)?(v(),S(se,{key:5,ref_key:"moduleBackupFlag",ref:pe,onRefreshData:W,onClosed:o[10]||(o[10]=e=>j(ce)?ce.value=!1:ce=!1)},null,512)):L("",!0),e.installed?L("",!0):(v(),b("div",ul)),e.installed?L("",!0):(v(),b("div",cl,[k(g,{size:20,color:"var(--el-color-danger)",style:{"margin-right":"10px"}},{default:w((()=>[k(xe)])),_:1}),o[22]||(o[22]=x(" \u5f53\u524d\u672a\u5b89\u88c5Web\u670d\u52a1\u5668\u73af\u5883 ")),k(n,{type:"primary",link:"",style:{"margin-left":"10px","font-size":"15px"},onClick:me},{default:w((()=>o[21]||(o[21]=[x("\u53bb\u5546\u5e97\u5b89\u88c5")]))),_:1})]))])}}},[["__scopeId","data-v-db592944"]]),ml={style:{display:"flex","align-items":"center",width:"100%"}},fl={style:{width:"150px","padding-left":"20px"}},gl={style:{display:"flex","align-items":"center",width:"100%"}},yl={style:{display:"flex","align-items":"center",width:"100%"}},_l={style:{display:"flex","align-items":"center",width:"100%"}},hl={style:{width:"150px","padding-left":"20px"}},vl={style:{background:"var(--el-fill-color-darker)",width:"100%","word-break":"break-all"}},bl=N({__name:"moduleAdd",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=K(),o=i(),s=a;let u=O((()=>"windows"==o.sysConfig.currentOs)),c=_(!1),p=_(!1),m=_("\u6dfb\u52a0Python\u9879\u76ee"),f=_({name:"",remark:"",path:"",group:0,type:1,project_cfg:{advanced:!1,version:"",requirements:"",install_reqs:!1,rukou:"",port:"",allowport:!1,start_method:"command",start_user:"root",start_command:"",sgi:"wsgi",framework:"python",application:"",protocol:"http",host:"127.0.0.1",autostart:!0}});$((()=>f.value.project_cfg.sgi),((e,l)=>{const a=f.value.project_cfg;if("django"==a.framework){if(a.application){let t=a.application.replace(l,e);f.value.project_cfg.application=t}if(a.rukou){let l="wsgi"==e?"asgi.py":"wsgi.py",t=a.rukou.replace(l,e+".py");f.value.project_cfg.rukou=t}}}));let g=O((()=>{const e=f.value.project_cfg;if(!f.value.path)return"";if("python"===f.value.framework)return"";{let l=e.port?e.port:"\u7aef\u53e3\u672a\u914d\u7f6e",a=e.application?e.application:"\u5e94\u7528\u672a\u914d\u7f6e";if("daphne"===e.start_method)return`${e.start_method} -b 127.0.0.1 -p ${l} ${a}`;if("uwsgi"===e.start_method)return`${e.start_method} --http 127.0.0.1:${l} --module ${a}`;if("gunicorn"===e.start_method)return"wsgi"==e.sgi?`${e.start_method} --bind 127.0.0.1:${l} ${a}`:"asgi"==e.sgi?`${e.start_method} --bind 127.0.0.1:${l} ${a} -k uvicorn.workers.UvicornWorker`:`${e.start_method} --bind 127.0.0.1:${l} ${a}`}}));_([{id:0,name:"\u9ed8\u8ba4\u5206\u7ec4"}]);let y=_([]),P=_(!1),M=_(null),R=_(null),F=_(!1),E=_(null),B=_(!1);let q=_({name:[{required:!0,message:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u79f0",trigger:"blur"}],path:[{required:!0,message:"\u8bf7\u9009\u62e9\u9879\u76ee\u6839\u76ee\u5f55",trigger:"blur"}],"project_cfg.version":[{required:!0,message:"\u8bf7\u9009\u62e9Python\u7248\u672c",trigger:"blur"}]}),G=_([{required:!0,validator:function(e,l,a){const t=parseInt(l,10);isNaN(t)&&a(new Error("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u7aef\u53e3\u53f7")),t<1||t>65534?a(new Error("\u7aef\u53e3\u53f7\u5fc5\u987b\u57280\u523065535\u4e4b\u95f4")):a()},trigger:"blur"}]),N=_([{required:!0,message:"\u8bf7\u8f93\u5165\u5e94\u7528\u53c2\u6570",trigger:"blur"}]);function Y(){s("closed")}function W(){P.value=!0,U((()=>{M.value.handleOpen({path:f.value.path,isDir:!0},"\u76ee\u5f55\u9009\u62e9")}))}function Z(){F.value=!0,U((()=>{R.value.handleOpen({path:f.value.path,isDir:!1},"\u4f9d\u8d56\u6587\u4ef6\u9009\u62e9")}))}function J(){B.value=!0,U((()=>{E.value.handleOpen({path:f.value.path,isDir:!1},"\u5165\u53e3\u6587\u4ef6\u9009\u62e9")}))}let Q=_(null);function X(e){let l=d(e);f.value.path=l,U((()=>{Q.value&&Q.value.blur()})),ae()}function ee(e){let l=d(e);f.value.project_cfg.requirements=l}function le(e){let l=d(e);f.value.project_cfg.rukou=l,ae()}function ae(){o.loadingInfo.isLoading=!0,o.loadingInfo.content="\u9884\u83b7\u53d6\u73af\u5883\u4e2d...",r.sysGetPythonMg({action:"get_env_info",path:f.value.path,rukou:f.value.project_cfg.rukou}).then((e=>{o.loadingInfo.isLoading=!1,o.loadingInfo.content="",2e3===e.code&&(f.value.project_cfg.framework=e.data.framework,f.value.project_cfg.rukou=e.data.rukou,f.value.project_cfg.requirements=e.data.requirements,f.value.project_cfg.sgi=e.data.sgi,f.value.project_cfg.application=e.data.application,e.data.requirements&&(f.value.project_cfg.install_reqs=!0))}))}function te(e){ae()}function oe(e){"daphne"==e&&(f.value.project_cfg.sgi="asgi")}function ne(){t.push({path:"/appstore"})}let ie=_(null);function de(){ie.value.validate((e=>{if(e){p.value=!0;let e=n({},f.value);e.action="create_site",r.sysPythonSiteMg(e).then((e=>{if(p.value=!1,2e3==e.code){let l=e.data;A.success(e.msg),Y(),s("refreshData",l.id,l.name)}else A.warning(e.msg)}))}}))}return l({handleOpen:function(e,l){m.value=l,c.value=!0,r.sysGetPythonMg({action:"list_version"}).then((e=>{2e3===e.code&&(y.value=e.data)}))}}),(e,l)=>{const a=h("el-input"),t=h("el-checkbox"),o=h("el-form-item"),n=h("el-option"),i=h("el-select"),d=h("el-tooltip"),r=h("el-radio-button"),s=h("el-radio-group"),_=h("QuestionFilled"),U=h("el-icon"),O=h("el-button"),$=h("el-col"),A=h("el-row"),K=h("el-switch"),ae=h("el-form");return v(),b("div",null,[k(H,{modelValue:V(c),"onUpdate:modelValue":l[15]||(l[15]=e=>j(c)?c.value=e:c=e),title:V(m),width:"730px","before-close":Y},{footer:w((()=>[k(O,{onClick:Y,loading:V(p)},{default:w((()=>l[19]||(l[19]=[x("\u53d6\u6d88")]))),_:1},8,["loading"]),k(O,{type:"primary",onClick:de,loading:V(p)},{default:w((()=>l[20]||(l[20]=[x("\u4fdd\u5b58")]))),_:1},8,["loading"])])),default:w((()=>[k(ae,{inline:!1,model:V(f),rules:V(q),ref_key:"rulesForm",ref:ie,"label-position":"right","label-width":"auto"},{default:w((()=>[k(o,{label:"\u9879\u76ee\u540d\u79f0\uff1a",prop:"name"},{default:w((()=>[T("div",ml,[k(a,{modelValue:V(f).name,"onUpdate:modelValue":l[0]||(l[0]=e=>V(f).name=e),placeholder:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u79f0",maxlength:"50"},null,8,["modelValue"]),T("div",fl,[k(t,{modelValue:V(f).project_cfg.advanced,"onUpdate:modelValue":l[1]||(l[1]=e=>V(f).project_cfg.advanced=e),label:"\u9ad8\u7ea7\u6a21\u5f0f"},null,8,["modelValue"])])])])),_:1}),k(o,{label:"Python\u7248\u672c\uff1a",prop:"project_cfg.version"},{default:w((()=>[T("div",gl,[k(i,{modelValue:V(f).project_cfg.version,"onUpdate:modelValue":l[2]||(l[2]=e=>V(f).project_cfg.version=e),placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"},clearable:"",filterable:""},{default:w((()=>[(v(!0),b(C,null,I(V(y),(e=>(v(),S(n,{key:e.version,label:e.version,value:e.version},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),k(d,{content:"\u5982\u679c\u6ca1\u6709Python\u73af\u5883\uff0c\u8bf7\u70b9\u51fb\u524d\u5f80\u3010\u5e94\u7528\u5546\u5e97\u3011\u5b89\u88c5\u6307\u5b9aPython\u7248\u672c"},{default:w((()=>[T("span",{style:{color:"var(--el-color-primary)",width:"150px","padding-left":"20px",cursor:"pointer"},onClick:ne},"\u6ca1\u6709\uff1f\u53bb\u5b89\u88c5")])),_:1})])])),_:1}),k(o,{label:"\u542f\u52a8\u65b9\u5f0f\uff1a",prop:"project_cfg.start_method"},{default:w((()=>[k(s,{modelValue:V(f).project_cfg.start_method,"onUpdate:modelValue":l[3]||(l[3]=e=>V(f).project_cfg.start_method=e),onChange:oe},{default:w((()=>[k(r,{label:"\u547d\u4ee4\u884c",value:"command"}),V(u)?L("",!0):(v(),S(r,{key:0,label:"uwsgi",value:"uwsgi"})),V(u)?L("",!0):(v(),S(r,{key:1,label:"gunicorn",value:"gunicorn"})),k(r,{label:"daphne",value:"daphne"})])),_:1},8,["modelValue"]),k(d,{effect:"dark",content:"\u547d\u4ee4\u884c\uff1a\u9002\u7528\u4e8epython<br/>uwsgi\uff1a\u9002\u7528\u4e8eflask\u3001django<br/>gunicorn\uff1a\u9002\u7528\u4e8eflask\u3001django<br/>daphne\uff1a\u9002\u7528\u4e8edjango","raw-content":!0,placement:"top-start"},{default:w((()=>[k(U,{style:{"margin-left":"5px"}},{default:w((()=>[k(_)])),_:1})])),_:1})])),_:1}),"command"==V(f).project_cfg.start_method?(v(),S(o,{key:0,label:"\u542f\u52a8\u547d\u4ee4\uff1a",prop:"project_cfg.start_command"},{default:w((()=>[k(a,{modelValue:V(f).project_cfg.start_command,"onUpdate:modelValue":l[4]||(l[4]=e=>V(f).project_cfg.start_command=e),placeholder:"\u5982\uff1apip install -r requirements.txt && python manage.py runserver 0.0.0.0:8000",maxlength:"300"},null,8,["modelValue"])])),_:1})):L("",!0),"command"!=V(f).project_cfg.start_method?(v(),S(o,{key:1,label:"\u9879\u76ee\u7aef\u53e3\uff1a",prop:"project_cfg.port",rules:"command"!=V(f).project_cfg.start_method?V(G):[]},{default:w((()=>[T("div",yl,[k(a,{ref_key:"PathInputElement",ref:Q,modelValue:V(f).project_cfg.port,"onUpdate:modelValue":l[5]||(l[5]=e=>V(f).project_cfg.port=e),placeholder:"\u8bf7\u8f93\u5165\u9879\u76ee\u7aef\u53e3",type:"number",min:"1",max:"65534"},null,8,["modelValue"])])])),_:1},8,["rules"])):L("",!0),k(o,{label:"\u9879\u76ee\u76ee\u5f55\uff1a",prop:"path"},{default:w((()=>[k(a,{modelValue:V(f).path,"onUpdate:modelValue":l[6]||(l[6]=e=>V(f).path=e),placeholder:"\u8bf7\u9009\u62e9\u9879\u76ee\u6839\u76ee\u5f55",class:"selectDirs",onChange:te},{prepend:w((()=>[k(O,{onClick:W,icon:"Folder",type:"primary"})])),_:1},8,["modelValue"])])),_:1}),"command"!=V(f).project_cfg.start_method&&V(f).project_cfg.advanced?(v(),S(o,{key:2,label:"\u5165\u53e3\u6587\u4ef6\uff1a",prop:"project_cfg.rukou"},{default:w((()=>[k(a,{modelValue:V(f).project_cfg.rukou,"onUpdate:modelValue":l[7]||(l[7]=e=>V(f).project_cfg.rukou=e),clearable:"",placeholder:"\u9879\u76ee\u5165\u53e3\u6587\u4ef6\u5982\uff1awsgi.py\u3001asgi.py\u3001app.py",class:"selectDirs"},{prepend:w((()=>[k(O,{onClick:J,icon:"Document",type:"primary"})])),_:1},8,["modelValue"])])),_:1})):L("",!0),V(f).project_cfg.advanced?(v(),S(A,{key:3,gutter:20},{default:w((()=>[k($,{span:8},{default:w((()=>[k(o,{label:"\u9879\u76ee\u6846\u67b6\uff1a",prop:"project_cfg.framework"},{default:w((()=>[k(i,{modelValue:V(f).project_cfg.framework,"onUpdate:modelValue":l[8]||(l[8]=e=>V(f).project_cfg.framework=e),placeholder:"\u8bf7\u9009\u62e9\u9879\u76ee\u6846\u67b6",disabled:!0,style:{width:"100%"},filterable:""},{default:w((()=>[k(n,{key:"django",label:"django",value:"django"}),k(n,{key:"flask",label:"flask",value:"flask"}),k(n,{key:"python",label:"python",value:"python"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),k($,{span:16},{default:w((()=>[k(o,{label:"\u5e94\u7528\u53c2\u6570\uff1a",prop:"project_cfg.application",rules:"command"!=V(f).project_cfg.start_method?V(N):[]},{default:w((()=>[k(a,{modelValue:V(f).project_cfg.application,"onUpdate:modelValue":l[9]||(l[9]=e=>V(f).project_cfg.application=e),placeholder:"\u5982\uff1aapplication.asgi:application\u6216app:app",maxlength:"100"},null,8,["modelValue"])])),_:1},8,["rules"])])),_:1})])),_:1})):L("",!0),V(f).project_cfg.advanced?(v(),S(o,{key:4,label:"\u4f9d\u8d56\u6587\u4ef6\uff1a",prop:"project_cfg.requirements"},{default:w((()=>[T("div",_l,[k(a,{modelValue:V(f).project_cfg.requirements,"onUpdate:modelValue":l[10]||(l[10]=e=>V(f).project_cfg.requirements=e),clearable:"",placeholder:"\u8bf7\u9009\u62e9\u4f9d\u8d56\u6587\u4ef6\uff0c\u5982\uff1arequirements.txt",class:"selectDirs"},{prepend:w((()=>[k(O,{onClick:Z,icon:"Document",type:"primary"})])),_:1},8,["modelValue"]),T("div",hl,[k(t,{modelValue:V(f).project_cfg.install_reqs,"onUpdate:modelValue":l[11]||(l[11]=e=>V(f).project_cfg.install_reqs=e),label:"\u5b89\u88c5\u4f9d\u8d56"},null,8,["modelValue"])])])])),_:1})):L("",!0),k(A,{gutter:20},{default:w((()=>["command"!=V(f).project_cfg.start_method?(v(),S($,{key:0,span:12},{default:w((()=>["command"!=V(f).project_cfg.start_method?(v(),S(o,{key:0,label:"\u901a\u8baf\u534f\u8bae\uff1a",prop:"project_cfg.sgi"},{default:w((()=>[k(i,{modelValue:V(f).project_cfg.sgi,"onUpdate:modelValue":l[12]||(l[12]=e=>V(f).project_cfg.sgi=e),placeholder:"\u8bf7\u9009\u62e9\u901a\u8baf\u534f\u8bae",disabled:"daphne"==V(f).project_cfg.start_method,style:{width:"100%"},filterable:""},{default:w((()=>[k(n,{key:"wsgi",label:"wsgi",value:"wsgi",disabled:"daphne"==V(f).project_cfg.start_method},null,8,["disabled"]),k(n,{key:"asgi",label:"asgi",value:"asgi"})])),_:1},8,["modelValue","disabled"])])),_:1})):L("",!0)])),_:1})):L("",!0),k($,{span:12},{default:w((()=>[V(f).project_cfg.advanced&&!V(u)?(v(),S(o,{key:0,label:"\u542f\u52a8\u7528\u6237\uff1a",prop:"project_cfg.start_user"},{default:w((()=>[k(i,{modelValue:V(f).project_cfg.start_user,"onUpdate:modelValue":l[13]||(l[13]=e=>V(f).project_cfg.start_user=e),placeholder:"\u8bf7\u9009\u62e9\u542f\u52a8\u7528\u6237",style:{width:"100%"},clearable:"",filterable:""},{default:w((()=>[k(n,{key:"root",label:"root",value:"root"}),k(n,{key:"www",label:"www",value:"www"})])),_:1},8,["modelValue"])])),_:1})):L("",!0)])),_:1})])),_:1}),V(f).project_cfg.advanced?(v(),S(o,{key:5,label:"\u5f00\u673a\u542f\u52a8\uff1a"},{default:w((()=>[k(K,{modelValue:V(f).project_cfg.autostart,"onUpdate:modelValue":l[14]||(l[14]=e=>V(f).project_cfg.autostart=e),"inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"\u5f00\u542f","inactive-text":"\u5173\u95ed"},null,8,["modelValue"])])),_:1})):L("",!0),V(g)?(v(),S(o,{key:6,label:"\u8f85\u52a9\u9884\u89c8\uff1a"},{default:w((()=>[T("div",vl,D(V(g)),1)])),_:1})):L("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),V(P)?(v(),S(z,{key:0,ref_key:"chooseDirShowFlag",ref:M,onChange:X,onClosed:l[16]||(l[16]=e=>j(P)?P.value=!1:P=!1)},null,512)):L("",!0),V(F)?(v(),S(z,{key:1,ref_key:"chooseFileShowFlag",ref:R,onChange:ee,onClosed:l[17]||(l[17]=e=>j(F)?F.value=!1:F=!1),onlyFileSelect:!0},null,512)):L("",!0),V(B)?(v(),S(z,{key:2,ref_key:"chooseRKFileShowFlag",ref:E,onChange:le,onClosed:l[18]||(l[18]=e=>j(B)?B.value=!1:B=!1),onlyFileSelect:!0},null,512)):L("",!0)])}}},[["__scopeId","data-v-d561cfa7"]]),kl={class:"lySSLApplyDialog"},wl=N({__name:"createSiteLog",emits:["refreshData","closed"],setup(e,{expose:l,emit:a}){const t=a;let o=_(!1),n=_(!1),i=_("\u65e5\u5fd7\u8be6\u60c5"),s=_({id:""}),u={},c=_(""),p=_("55vh"),m=_("log"),f=_(null),g=_("new_lines");function y(){h(),t("refreshData"),t("closed")}function h(){clearInterval(f.value),f.value=null}R((()=>{window.addEventListener("resize",L),L()})),F((()=>{window.removeEventListener("resize",L),h()}));let x=_(null);function C(){n.value=!0;let e={id:s.value.id,action:"get_create_log"};r.sysPythonSiteMg(e).then((e=>{if(n.value=!1,2e3==e.code){if(c.value=e.data.data,U((()=>{x.value&&x.value.scrollToBottom()})),e.data.done&&(h(),"all"!=g.value)){let l=2e3;e.data.error&&(l=5e3),setTimeout((()=>{y()}),l)}}else A.warning(e.msg),setTimeout((()=>{y()}),2e3)}))}let I=_(null),S=_(!1);function L(){U((()=>{const e=I.value.getRef();if(e.dialogContentRef){const l=e.dialogContentRef.$refs.headerRef.offsetHeight||80,a=document.body.offsetHeight;e.dialogContentRef.fullscreen||S.value?p.value=a-l:p.value="55vh"}}))}function T(e){S.value=e,L()}return l({handleOpen:function(e,l){i.value=l,o.value=!0,e&&(u=d(e),s.value.id=u.id,u.action&&(g.value=u.action),"all"!=g.value?f.value=setInterval((()=>{C()}),2e3):C())}}),(e,l)=>(v(),b("div",kl,[k(H,{ref_key:"codeMirrorDialogRef",ref:I,modelValue:V(o),"onUpdate:modelValue":l[1]||(l[1]=e=>j(o)?o.value=e:o=e),title:V(i),width:"50%",onOnChangeFullScreen:T,"before-close":y,showClose:!1,showFullScreen:!1},{default:w((()=>[k(Z,{modelValue:V(c),"onUpdate:modelValue":l[0]||(l[0]=e=>j(c)?c.value=e:c=e),fontSize:"15px",placeholder:(V(c),""),showLineNums:!1,lineWrapping:!0,mode:V(m),height:V(p),"read-only":!0,ref_key:"lyCodemirror",ref:x},null,8,["modelValue","placeholder","mode","height"])])),_:1},8,["modelValue","title"])]))}},[["__scopeId","data-v-7bcdb7c5"]]),Vl={class:"handle-top"},xl={class:"search-sites-input"},Cl={key:0},Il={key:1},Sl={class:"lyczj",style:{display:"flex","align-items":"center"}},jl=["onClick"],Ll={key:0,style:{"font-size":"12px","font-weight":"bold"}},Ul=N({__name:"index",setup(e,{expose:l}){const a=K(),t=i(),o=g();let d=O((()=>o.ismobile)),s=_(!1),u=_({page:1,limit:10}),c=_({page:1,limit:10,total:0}),p=_([]);function m(e){u.value.page=e.page,u.value.limit=e.limit,f()}function f(){s.value=!0;let e=n({},u.value);r.sysGetPythonSiteMg(e).then((e=>{s.value=!1,2e3===e.code&&(e.data.data.forEach((e=>{e.showEndDate=!1})),p.value=e.data.data,c.value.page=e.data.page,c.value.limit=e.data.limit,c.value.total=e.data.total)}))}function C(){u.value.page=1,f()}let I=_(!1),R=_(null);function F(){I.value=!0,U((()=>{R.value.handleOpen(null,"\u6dfb\u52a0Python\u9879\u76ee")}))}let E=_(!1),$=_(null);function H(e,l){E.value=!0,U((()=>{let a={id:e};$.value.handleOpen(a,"\u6dfb\u52a0\u3010"+l+"\u3011\u9879\u76ee\u65e5\u5fd7\u8be6\u60c5")}))}let z=_(!1),N=_(null);function W(e){z.value=!0;let l={id:e.id,installed:!0,version:"",status:e.status,name:"python_project"};U((()=>{N.value.handleOpen(l,"\u3010"+e.name+"\u3011\u7ba1\u7406")}))}let Z=_(!1),J=_(null);function ee(e,l){let a="\u786e\u5b9a\u542f\u52a8\u7ad9\u70b9\u5417\uff1f",o="\u542f\u52a8\u4e2d...";"stop"==e?(a="\u786e\u5b9a\u8981\u505c\u6b62\u7ad9\u70b9\u5417\uff1f",o="\u505c\u6b62\u4e2d..."):"restart"==e&&(a="\u786e\u5b9a\u8981\u91cd\u542f\u5417\uff1f",o="\u91cd\u542f\u4e2d..."),Y.confirm(`${a}`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content=o,r.sysPythonSiteMg({id:l,op:e,action:"set_status"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),f()):A.warning(e.msg)}))})).catch((()=>{}))}function le(){a.push({path:"/appstore"})}function ae(e){p.value.forEach((l=>{l.id==e.id&&(l.status=e.status)}))}return l({RefreshData:function(){U((()=>{f()}))}}),(e,l)=>{const o=h("el-button"),n=h("el-col"),i=h("el-input"),g=h("el-row"),_=h("el-link"),O=h("el-table-column"),K=h("el-tag"),te=h("el-tooltip"),oe=h("el-table"),ne=P("loading");return v(),b("div",null,[T("div",Vl,[k(g,null,{default:w((()=>[k(n,{xs:24,sm:16,md:16,lg:16,xl:16},{default:w((()=>[k(o,{type:"primary",onClick:F},{default:w((()=>l[8]||(l[8]=[x("\u6dfb\u52a0Python\u9879\u76ee")]))),_:1}),k(o,{onClick:le},{default:w((()=>l[9]||(l[9]=[x("\u5b89\u88c5Python\u73af\u5883")]))),_:1}),k(o,{icon:"refresh",circle:"",onClick:C})])),_:1}),k(n,{xs:24,sm:8,md:8,lg:8,xl:8},{default:w((()=>[T("div",xl,[k(i,{modelValue:V(u).search,"onUpdate:modelValue":l[0]||(l[0]=e=>V(u).search=e),clearable:"",onClear:l[1]||(l[1]=e=>C()),"suffix-icon":"Search",onKeyup:l[2]||(l[2]=B((e=>C()),["enter"])),onChange:l[3]||(l[3]=e=>C()),placeholder:"\u641c\u7d22"},null,8,["modelValue"])])])),_:1})])),_:1})]),M((v(),S(oe,{data:V(p),style:{width:"100%","border-top":"1px solid var(--el-border-color-lighter)"},"header-cell-class-name":"table-header-style"},{default:w((()=>[k(O,{prop:"name",label:"\u540d\u79f0","min-width":"180"},{default:w((e=>[k(_,{type:"primary",underline:!1,onClick:q((l=>W(e.row)),["stop"])},{default:w((()=>[x(D(e.row.name),1)])),_:2},1032,["onClick"])])),_:1}),k(O,{prop:"status",label:"\u72b6\u6001","min-width":"100"},{default:w((({row:e})=>[e.status?(v(),S(o,{key:0,link:"",type:"success",icon:"VideoPlay",onClick:l=>ee("stop",e.id)},{default:w((()=>l[10]||(l[10]=[x(" \u5df2\u542f\u52a8 ")]))),_:2},1032,["onClick"])):(v(),S(o,{key:1,link:"",type:"danger",icon:"VideoPause",onClick:l=>ee("start",e.id)},{default:w((()=>l[11]||(l[11]=[x(" \u5df2\u505c\u6b62 ")]))),_:2},1032,["onClick"]))])),_:1}),k(O,{prop:"project_cfg.port",label:"\u7aef\u53e3",width:"90"},{default:w((e=>["command"==e.row.start_method?(v(),b("span",Cl)):(v(),b("span",Il,D(e.row.project_cfg.port),1))])),_:1}),k(O,{prop:"project_cfg.framework",label:"\u9879\u76ee\u6846\u67b6",width:"100"}),k(O,{prop:"project_cfg.start_method",label:"\u542f\u52a8\u7c7b\u578b",width:"100"}),k(O,{prop:"project_cfg.autostart",label:"\u5f00\u673a\u542f\u52a8",width:"100"},{default:w((e=>[e.row.project_cfg.autostart?(v(),S(K,{key:0,type:"primary"},{default:w((()=>l[12]||(l[12]=[x("\u662f")]))),_:1})):(v(),S(K,{key:1},{default:w((()=>l[13]||(l[13]=[x("\u5426")]))),_:1}))])),_:1}),k(O,{prop:"path",label:"\u9879\u76ee\u76ee\u5f55",width:"90"},{default:w((e=>[T("div",Sl,[k(te,{effect:"dark",content:e.row.path,placement:"bottom"},{default:w((()=>[T("img",{class:"ruyi-fileicons",src:y,onClick:l=>{var o;(o=e.row).path&&(t.fileInfo.currentDir=o.path,a.push({path:"/files"}))}},null,8,jl)])),_:2},1032,["content"]),e.row.is_default?(v(),b("span",Ll,"(\u9ed8\u8ba4\u7ad9)")):L("",!0)])])),_:1}),k(O,{prop:"create_at",label:"\u521b\u5efa\u65f6\u95f4","min-width":"170"}),k(O,{fixed:!V(d)&&"right",label:"\u64cd\u4f5c",width:"200"},{default:w((e=>["windows"!=V(t).sysConfig.currentOs?(v(),S(o,{key:0,link:"",type:"primary",onClick:l=>{return a=e.row,Z.value=!0,void U((()=>{J.value.handleOpen({id:0,path:a.path},"\u5982\u610f\u7ec8\u7aef")}));var a}},{default:w((()=>l[14]||(l[14]=[x("\u7ec8\u7aef")]))),_:2},1032,["onClick"])):L("",!0),k(o,{link:"",type:"primary",onClick:l=>ee("restart",e.row.id)},{default:w((()=>l[15]||(l[15]=[x("\u91cd\u542f")]))),_:2},1032,["onClick"]),k(o,{link:"",type:"primary",onClick:l=>W(e.row)},{default:w((()=>l[16]||(l[16]=[x("\u914d\u7f6e")]))),_:2},1032,["onClick"]),k(o,{link:"",type:"primary",onClick:l=>{return a=e.row,void Y.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${a.name}\u3011\u9879\u76ee\u5417\uff1f\u6b64\u64cd\u4f5c\u4f1a\u5220\u9664\u8be5\u9879\u76ee\u7684\u65e5\u5fd7\u3001\u914d\u7f6e\u4fe1\u606f\u7b49\uff01\uff01\uff01`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u5220\u9664\u4e2d...",r.sysPythonSiteMg({id:a.id,action:"del_site"}).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(A.success(e.msg),f()):A.warning(e.msg)}))})).catch((()=>{}));var a}},{default:w((()=>l[17]||(l[17]=[x("\u5220\u9664")]))),_:2},1032,["onClick"])])),_:1},8,["fixed"])])),_:1},8,["data"])),[[ne,V(s)]]),k(G,{small:!0,"child-msg":V(c),onCallFather:m,border:!1,position:"right"},null,8,["child-msg"]),V(I)?(v(),S(bl,{key:0,ref_key:"moduleAddFlag",ref:R,onClosed:l[4]||(l[4]=e=>j(I)?I.value=!1:I=!1),onRefreshData:H},null,512)):L("",!0),V(E)?(v(),S(wl,{key:1,ref_key:"moduleinstallLogFlag",ref:$,onClosed:l[5]||(l[5]=e=>j(E)?E.value=!1:E=!1),onRefreshData:f},null,512)):L("",!0),V(z)?(v(),S(Q,{key:2,ref_key:"softInfoFlag",ref:N,onClosed:l[6]||(l[6]=e=>j(z)?z.value=!1:z=!1),onRefreshStatus:ae,onRefreshData:f},null,512)):L("",!0),V(Z)?(v(),S(X,{key:3,ref_key:"moduleDialogTerminalFlag",ref:J,onClosed:l[7]||(l[7]=e=>j(Z)?Z.value=!1:Z=!1)},null,512)):L("",!0)])}}},[["__scopeId","data-v-37f08d2e"]]),Tl={key:0,style:{"margin-bottom":"20px"},class:"lystatuscard"},Dl={class:"lyflex"},Pl={class:"lyflex"},Ml={key:0,class:"lyflex"},Rl=N({__name:"index",setup(e){const l=i(),a=g();let t=O((()=>a.ismobile)),o=_("Static"),n=_("nginx");function d(e){let a=e.props.name;u.value.id="",u.value.installed=!1,u.value.version="",u.value.status=!1,"Static"==a?(n.value=l.sysConfig.webServer,c(n.value)):(n.value=a,P(a))}function s(){c(n.value)}let u=_({id:"",installed:!1,version:"",status:!1,name:""});function c(e="nginx"){""!=e&&(l.loadingInfo.isLoading=!0,l.loadingInfo.content="\u6b63\u5728\u83b7\u53d6...",r.sysSoftinfoMg({name:e,action:"get_soft_info"}).then((e=>{l.loadingInfo.isLoading=!1,l.loadingInfo.content="",2e3==e.code?(u.value=e.data,u.value.installed&&P(o.value)):A.warning(e.msg)})))}function p(e="stop"){let a="\u786e\u5b9a\u8981\u505c\u6b62\u5417\uff1f",t=!1,o="\u542f\u52a8\u6210\u529f";"stop"==e?(l.loadingInfo.content="\u6b63\u5728\u505c\u6b62\u4e2d...",t=!1,o="\u505c\u6b62\u6210\u529f"):"reload"==e?(l.loadingInfo.content="\u6b63\u5728\u91cd\u8f7d\u914d\u7f6e\u4e2d...",a="\u786e\u5b9a\u8981\u91cd\u8f7d\u914d\u7f6e\u5417\uff1f",t=u.value.status,o="\u91cd\u8f7d\u914d\u7f6e\u6210\u529f"):"restart"==e&&(l.loadingInfo.content=u.value.status?"\u6b63\u5728\u91cd\u542f\u4e2d...":"\u6b63\u5728\u542f\u52a8\u4e2d...",a=u.value.status?"\u786e\u5b9a\u8981\u91cd\u542f\u5417\uff1f":"\u786e\u5b9a\u8981\u542f\u52a8\u5417\uff1f",t=!0,o=u.value.status?"\u91cd\u542f\u6210\u529f":"\u542f\u52a8\u6210\u529f"),Y.confirm(`${a}`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{l.loadingInfo.isLoading=!0,r.sysSoftManage({id:u.value.id,status:e,action:"status"}).then((e=>{l.loadingInfo.isLoading=!1,l.loadingInfo.content="",2e3==e.code?(A.success(o),u.value.status=t):A.warning(e.msg)}))})).catch((()=>{}))}let m=_(!1),f=_(null);function y(){m.value=!0,U((()=>{f.value.handleOpen(u.value,"\u3010"+u.value.name+"("+u.value.version+")\u3011\u7ba1\u7406")}))}let C=_(null),I=_(null);function P(e="Static"){U((()=>{"Static"==e?U((()=>{C.value.RefreshData()})):"Python"==e&&U((()=>{I.value.RefreshData()}))}))}return R((()=>{n.value=l.sysConfig.webServer,c(n.value)})),(e,l)=>{const a=h("el-tag"),i=h("el-button"),r=h("el-divider"),c=h("el-card"),g=h("el-tab-pane"),_=h("el-tabs"),U=h("el-main");return v(),S(U,{class:"ruyi-sites"},{default:w((()=>[k(c,{shadow:"never"},{default:w((()=>[k(_,{modelValue:V(o),"onUpdate:modelValue":l[3]||(l[3]=e=>j(o)?o.value=e:o=e),onTabClick:d},{default:w((()=>[V(n)&&"Static"==V(o)?(v(),b("div",Tl,[k(c,{shadow:"hover",style:E({overflowX:V(t)?"auto":"none"})},{default:w((()=>[T("div",Dl,[k(a,{style:{"margin-right":"20px"},effect:"dark",type:"success"},{default:w((()=>[x(D(V(n)),1)])),_:1}),k(a,{style:{"margin-right":"20px"},type:V(u).installed?"success":"info"},{default:w((()=>[x(D(V(u).installed?"\u5df2\u5b89\u88c5":"\u672a\u5b89\u88c5"),1)])),_:1},8,["type"]),k(a,{style:{"margin-right":"20px"}},{default:w((()=>[x("\u7248\u672c: "+D(V(u).version||"\u672a\u77e5"),1)])),_:1}),k(a,{style:{"margin-right":"20px"},type:V(u).status?"success":"danger"},{default:w((()=>[x("\u72b6\u6001: "+D(V(u).status?"\u5df2\u542f\u52a8":"\u672a\u542f\u52a8"),1)])),_:1},8,["type"]),T("div",Pl,[k(i,{type:"primary",link:"",onClick:l[0]||(l[0]=e=>p("stop")),disabled:!V(u).installed},{default:w((()=>l[5]||(l[5]=[x("\u505c\u6b62")]))),_:1},8,["disabled"]),k(r,{direction:"vertical"}),k(i,{type:"primary",link:"",onClick:l[1]||(l[1]=e=>p("restart")),disabled:!V(u).installed},{default:w((()=>[x(D(V(u).status?"\u91cd\u542f":"\u542f\u52a8"),1)])),_:1},8,["disabled"])]),"Static"==V(o)?(v(),b("div",Ml,[k(r,{direction:"vertical"}),k(i,{type:"primary",link:"",onClick:l[2]||(l[2]=e=>p("reload")),disabled:!V(u).installed},{default:w((()=>l[6]||(l[6]=[x(D("\u91cd\u8f7d"))]))),_:1},8,["disabled"]),k(r,{direction:"vertical"}),k(i,{type:"primary",link:"",onClick:y,disabled:!V(u).installed},{default:w((()=>l[7]||(l[7]=[x(D("\u8bbe\u7f6e"))]))),_:1},8,["disabled"])])):L("",!0)])])),_:1},8,["style"])])):L("",!0),k(g,{label:"\u9759\u6001\u9879\u76ee",name:"Static"},{default:w((()=>["Static"==V(o)?(v(),S(pl,{key:0,installed:V(u).installed,status:V(u).status,ref_key:"staticRef",ref:C},null,8,["installed","status"])):L("",!0)])),_:1}),k(g,{label:"Python\u9879\u76ee",name:"Python"},{default:w((()=>["Python"==V(o)?(v(),S(Ul,{key:0,ref_key:"pythonRef",ref:I},null,512)):L("",!0)])),_:1})])),_:1},8,["modelValue"])])),_:1}),V(m)?(v(),S(Q,{key:0,ref_key:"softInfoFlag",ref:f,onClosed:l[4]||(l[4]=e=>j(m)?m.value=!1:m=!1),onRefreshStatus:s},null,512)):L("",!0)])),_:1})}}},[["__scopeId","data-v-b7248122"]]);export{Rl as default};
