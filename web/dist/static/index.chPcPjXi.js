var e=(e,t,a)=>new Promise(((l,n)=>{var o=e=>{try{s(a.next(e))}catch(t){n(t)}},i=e=>{try{s(a.throw(e))}catch(t){n(t)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,i);s((a=a.apply(e,t)).next())}));import{k as t,ag as a,c as l,o as n,J as o,P as i,O as s,a6 as r,G as u,H as d,a as c,M as f,r as m,h as p,aq as h,I as y,u as g,t as v,L as k,K as _,Q as b,n as C,i as w,D as x,C as I,B as L,W as M,ay as T,T as j}from"./@vue.CQt2tj-6.js";import{S as B,_ as S,u as V,a as R,b as E,c as z,d as H,A as U,f as P,g as D}from"./index.FQhv3U_5.js";import{u as $,b as A}from"./vue-router.BmPBvlxi.js";import{a as O,E as N}from"./element-plus.C3E-FvSa.js";import{i as F}from"./installLog.XAeeFQ3u.js";import{P as W}from"./Pagination.8Er6hDxx.js";import{d as Y}from"./pinia.CWB7oRTw.js";import"./crypto-js.BjUPrIIl.js";import"./js-cookie.Ch5AnFJE.js";import"./clipboard.BBhAuw9K.js";import"./axios.BhTbhqQQ.js";import"./vue-clipboard3.c61pm64N.js";import"./@element-plus.CU4brdXH.js";import"./nprogress.Dzr5m2b3.js";import"./@xterm.C7qPmoRH.js";import"./pinia-plugin-persistedstate.DTf8V5gU.js";import"./destr.ZpApkS-1.js";import"./deep-pick-omit.DP_A4OSP.js";import"./lodash-es.CUM784Py.js";import"./@vueuse.7zPzjEtO.js";import"./@popperjs.DxP-MrnL.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.BpgH7LzR.js";import"./async-validator.BTKOuuO-.js";import"./memoize-one.Ds0C_khL.js";import"./normalize-wheel-es.BhHBPXsK.js";import"./@floating-ui.D1oRyyfp.js";import"./dialog.Bsrh65Nu.js";import"./index.CLtx-Eae.js";import"./vue-codemirror.CkyLiK-7.js";import"./codemirror.Fbop2eii.js";import"./@codemirror.CIOe3mu6.js";import"./@lezer.CQ-BhAmV.js";import"./crelt.DSg10-ms.js";import"./@marijn.Df4efayV.js";import"./style-mod.Dj2YSJ7-.js";import"./w3c-keyname.f-y9tSbI.js";const q={key:0,style:{padding:"20px"}},G={__name:"NavMenu",props:{navMenus:{type:Array,default:[]}},emits:["contextmenuClick"],setup(e,{emit:m}){const p=m,h=t((()=>e=>e.children&&!e.children.every((e=>e.meta.hidden))));function y(e,t){p("contextmenuClick",e,t)}return(t,m)=>{const p=a("el-alert"),g=a("el-menu-item"),v=a("NavMenu",!0),k=a("el-sub-menu");return n(),l(s,null,[e.navMenus.length<=0?(n(),l("div",q,[i(p,{title:"\u65e0\u83dc\u5355",center:"",type:"info",closable:!1})])):o("",!0),(n(!0),l(s,null,r(e.navMenus,(e=>(n(),l(s,{key:e.path},[h.value(e)?(n(),u(k,{key:1,index:e.path,"data-id":e.path,onContextmenu:t=>y(t,e.path)},{title:d((()=>{var t,a;return[(null==(t=e.meta)?void 0:t.icon)?(n(),u(B,{key:0,"icon-class":null==(a=e.meta)?void 0:a.icon,style:{"font-size":"20px !important"}},null,8,["icon-class"])):o("",!0),c("span",null,f(e.meta.title),1)]})),default:d((()=>[i(v,{navMenus:e.children},null,8,["navMenus"])])),_:2},1032,["index","data-id","onContextmenu"])):(n(),u(g,{key:0,index:e.path,"data-id":e.path,onContextmenu:t=>y(t,e.path)},{title:d((()=>[c("span",null,f(e.meta.title),1)])),default:d((()=>{var t,a;return[(null==(t=e.meta)?void 0:t.icon)?(n(),u(B,{key:0,"icon-class":null==(a=e.meta)?void 0:a.icon},null,8,["icon-class"])):o("",!0)]})),_:2},1032,["index","data-id","onContextmenu"]))],64)))),128))],64)}}},K=S({__name:"sideMobile",setup(e){const t=V(),o=$(),r=R();let u=m(!1),f=m([]);function k(e){var t=[];return e&&e.forEach((e=>{if(e.meta=e.meta?e.meta:{},e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&(e.children=k(e.children)),t.push(e)})),t}let _=m(null);function b(){_.value.handleClose()}return p((()=>{f.value=k(r.routesList)})),(e,r)=>{const m=a("Menu"),p=a("el-icon"),k=a("el-header"),C=a("el-menu"),w=a("el-scrollbar"),x=a("el-main"),I=a("el-container"),L=a("el-drawer"),M=h("drag");return n(),l(s,null,[y((n(),l("div",{ref:"",class:"mobile-nav-button",onClick:r[0]||(r[0]=e=>function(e){if("true"==e.currentTarget.getAttribute("drag-flag"))return!1;u.value=!0}(e))},[i(p,null,{default:d((()=>[i(m)])),_:1})])),[[M]]),i(L,{ref_key:"mobileNavMenuBox",ref:_,title:"\u79fb\u52a8\u7aef\u83dc\u5355",size:200,modelValue:g(u),"onUpdate:modelValue":r[1]||(r[1]=e=>v(u)?u.value=e:u=e),direction:"ltr","with-header":!1,"destroy-on-close":""},{default:d((()=>[i(I,{class:"mobile-nav"},{default:d((()=>[i(k,null,{default:d((()=>r[2]||(r[2]=[c("div",{class:"logo-bar"},[c("img",{class:"logo",src:E})],-1)]))),_:1}),i(x,null,{default:d((()=>[i(w,{class:"lyruyimobilenavside"},{default:d((()=>[i(C,{"default-active":g(o).meta.active||g(o).fullPath,onSelect:b,router:"","background-color":"dark"==g(t).siteTheme?"#141414":"#272E39","text-color":"#fff","active-text-color":"#008040"},{default:d((()=>[i(G,{navMenus:g(f)},null,8,["navMenus"])])),_:1},8,["default-active","background-color"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}},[["__scopeId","data-v-f9707cf5"]]),X={class:"lysearch"},J={key:0,class:"lysearch-history"},Q={class:"lysearch-result"},Z={key:0,class:"lysearch-no-result"},ee={key:1},te=["onClick"],ae={class:"title"},le=S({__name:"search",emits:["success"],setup(e,{emit:t}){const h=t,y=A();let b=m(null),C=m(""),w=m([]),x=m([]),I=m([]);function L(e){var t,a,l,n;x.value=e?(t=e,a=[],l=w.value.filter((e=>e.meta.title.toLowerCase().indexOf(t.toLowerCase())>=0||e.name.toLowerCase().indexOf(t.toLowerCase())>=0||void 0)),n=n.getRoutes(),l.map((e=>"link"==e.meta.type?n.find((t=>t.path=="/"+e.path)):n.find((t=>t.path==e.path)))).forEach((e=>{a.push({name:e.name,type:e.meta.type,path:"link"==e.meta.type?e.path.slice(1):e.path,icon:e.meta.icon,title:e.meta.title,breadcrumb:e.meta.breadcrumb.map((e=>e.meta.title)).join(" - ")})})),a):[]}function M(e){e.forEach((e=>{if(e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&!e.component?M(e.children):w.value.push(e)}))}return p((()=>{var e=z.get("SEARCH_HISTORY")||[];I.value=e,M(y.getRoutes()),b.value.focus()})),(e,t)=>{const m=a("el-input"),p=a("el-tag"),w=a("el-icon"),M=a("el-scrollbar");return n(),l("div",X,[i(m,{ref_key:"refInput",ref:b,modelValue:g(C),"onUpdate:modelValue":t[0]||(t[0]=e=>v(C)?C.value=e:C=e),placeholder:"\u641c\u7d22",size:"large",clearable:"","prefix-icon":"search","trigger-on-focus":!1,onInput:L},null,8,["modelValue"]),g(I).length>0?(n(),l("div",J,[(n(!0),l(s,null,r(g(I),((e,t)=>(n(),u(p,{closable:"",effect:"dark",type:"info",key:e,onClick:t=>{return a=e,C.value=a,void L(a);var a},onClose:e=>function(e){I.value.splice(e,1),I.value.length<=0?z.remove("SEARCH_HISTORY"):z.set("SEARCH_HISTORY",this.history)}(t)},{default:d((()=>[k(f(e),1)])),_:2},1032,["onClick","onClose"])))),128))])):o("",!0),c("div",Q,[g(x).length<=0?(n(),l("div",Z,"\u6682\u65e0\u641c\u7d22\u7ed3\u679c")):(n(),l("ul",ee,[i(M,{"max-height":"366px"},{default:d((()=>[(n(!0),l(s,null,r(g(x),(e=>(n(),l("li",{key:e.path,onClick:t=>function(e){I.value.includes(this.input)||(I.value.push(this.input),z.set("SEARCH_HISTORY",this.history)),"link"==e.type?setTimeout((()=>{let t=document.createElement("a");t.style="display: none",t.target="_blank",t.href=e.path,document.body.appendChild(t),t.click(),document.body.removeChild(t)}),10):y.push({path:e.path}),h("success",!0)}(e)},[i(w,null,{default:d((()=>[(n(),u(_(e.icon||"menu")))])),_:2},1024),c("span",ae,f(e.breadcrumb),1)],8,te)))),128))])),_:1})]))])])}}},[["__scopeId","data-v-dcb9c94e"]]),ne={class:"lyshutdown"},oe=S({__name:"shutdown",emits:["success"],setup(e,{expose:t,emit:o}){const s=H();let r=m(!0);function u(){O.confirm("\u5373\u5c06\u91cd\u542f\u670d\u52a1\u5668\uff0c\u786e\u8ba4\u91cd\u542f\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{s.loadingInfo.isLoading=!0,s.loadingInfo.delay=20,s.loadingInfo.content="\u6b63\u5728\u91cd\u542f\u670d\u52a1\u5668...",s.loadingInfo.restartMode=!0;let t=!1;U.sysServmanage({action:"restart",type:"server"}).then((e=>{2e3===e.code||(s.loadingInfo.isLoading=!1,s.loadingInfo.content="",s.loadingInfo.delay=6,t=!0,N.error(e.msg))})),t||setTimeout((()=>{s.loadingInfo.isLoading=!1,s.loadingInfo.content="",s.loadingInfo.restartMode=!1,s.loadingInfo.delay=6,window.location.reload()}),21e3)})).catch((()=>{}))}function c(){O.confirm("\u5373\u5c06\u91cd\u542f\u5982\u610f\u9762\u677f\uff0c\u786e\u8ba4\u91cd\u542f\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{s.loadingInfo.isLoading=!0,s.loadingInfo.content="\u6b63\u5728\u91cd\u542f\u5982\u610f\u9762\u677f...",s.loadingInfo.restartMode=!0,s.loadingInfo.delay=6;let t=!1;U.sysServmanage({action:"restart",type:"panel"}).then((e=>{2e3===e.code||(s.loadingInfo.isLoading=!1,s.loadingInfo.content="",s.loadingInfo.delay=6,t=!0,N.error(e.msg))})),setTimeout((()=>{t||(s.loadingInfo.isLoading=!1,s.loadingInfo.content="",s.loadingInfo.restartMode=!1,s.loadingInfo.delay=6,window.location.reload())}),7e3)})).catch((()=>{}))}return t({onlyRestartPanel:function(){r.value=!1,c()}}),(e,t)=>{const o=a("el-button");return y((n(),l("div",ne,[i(o,{dark:"",size:"large",bg:"",onClick:u},{default:d((()=>t[0]||(t[0]=[k("\u91cd\u542f\u670d\u52a1\u5668")]))),_:1}),i(o,{dark:"",size:"large",bg:"",onClick:c},{default:d((()=>t[1]||(t[1]=[k("\u91cd\u542f\u5982\u610f\u9762\u677f")]))),_:1})],512)),[[b,g(r)]])}}},[["__scopeId","data-v-1031ed68"]]),ie={class:"tasks-item-body"},se={class:"taskMain"},re={class:"title"},ue={class:"bottom"},de={class:"state"},ce={class:"handler"},fe={class:"tasks-item-body"},me={class:"taskMain"},pe={class:"title"},he={style:{"margin-left":"20px"}},ye={class:"bottom"},ge={class:"state"},ve={class:"handler"},ke=S({__name:"tasks",setup(t,{expose:p}){const _=H();let b=m("1"),w=m(!1),x=m([]),I=m({action:"end",page:1,limit:10}),L=m({page:1,limit:10,total:0});function M(t){return e(this,null,(function*(){I.value.page=t.page,I.value.limit=t.limit,yield T()}))}function T(){return e(this,null,(function*(){w.value=!0,x.value=[],U.sysTaskcenter(I.value).then((e=>{w.value=!1,2e3==e.code&&(x.value=e.data.data,L.value.page=e.data.page,L.value.limit=e.data.limit,L.value.total=e.data.total)}))}))}function j(t){return e(this,null,(function*(){"1"==t.props.name?S():yield T()}))}function B(){return e(this,null,(function*(){w.value=!0,yield _.getSystemTaskIngInfo(),w.value=!1}))}function S(){B()}let V=m(!1),R=m(null);function E(e){let t=e.id;V.value=!0;let a=2==e.status||3==e.status?"all":"new_lines";C((()=>{let l={id:t,action:a};R.value.handleOpen(l,e.name+"\u65e5\u5fd7\u8be6\u60c5")}))}return p({refresh:S}),(t,m)=>{const p=a("el-tab-pane"),C=a("el-tabs"),I=a("el-empty"),z=a("el-tag"),H=a("el-button"),$=a("el-card"),A=a("el-main"),Y=a("el-footer"),q=a("el-container"),G=h("loading");return y((n(),u(q,null,{default:d((()=>[i(C,{modelValue:g(b),"onUpdate:modelValue":m[0]||(m[0]=e=>v(b)?b.value=e:b=e),type:"card",style:{width:"100%",padding:"0 15px 0 15px"},onTabClick:j},{default:d((()=>[i(p,{label:"\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1",name:"1"}),i(p,{label:"\u4efb\u52a1\u5386\u53f2\u5217\u8868",name:"2"})])),_:1},8,["modelValue"]),"1"==g(b)?(n(),u(A,{key:0},{default:d((()=>[0==g(_).taskInfo.taskList.length?(n(),u(I,{key:0,"image-size":120},{default:d((()=>m[2]||(m[2]=[c("p",{style:{"font-size":"14px",color:"#999","line-height":"1.5",margin:"0 40px"}},"\u6ca1\u6709\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1",-1)]))),_:1})):o("",!0),(n(!0),l(s,null,r(g(_).taskInfo.taskList,(t=>(n(),u($,{key:t.id,shadow:"hover",class:"tasks-item"},{default:d((()=>[c("div",ie,[c("div",se,[c("div",re,[c("h2",null,f(t.name),1),c("p",null," \u521b\u5efa\u65f6\u95f4\uff1a"+f(t.create_at),1)]),c("div",ue,[c("div",de,[0==t.status?(n(),u(z,{key:0,type:"info"},{default:d((()=>m[3]||(m[3]=[k("\u7b49\u5f85\u4e2d")]))),_:1})):o("",!0),1==t.status?(n(),u(z,{key:1,type:"primary"},{default:d((()=>m[4]||(m[4]=[k("\u6267\u884c\u4e2d")]))),_:1})):o("",!0),2==t.status?(n(),u(z,{key:2,type:"danger"},{default:d((()=>m[5]||(m[5]=[k("\u5df2\u5931\u8d25")]))),_:1})):o("",!0),3==t.status?(n(),u(z,{key:3},{default:d((()=>m[6]||(m[6]=[k("\u5df2\u5b8c\u6210")]))),_:1})):o("",!0)]),c("div",ce,[1==t.status?(n(),u(H,{key:0,plain:"",type:"warning",icon:"VideoPause",onClick:a=>function(t){return e(this,null,(function*(){O.confirm(`\u786e\u5b9a\u8981\u505c\u6b62\u3010${t.name}\u3011\u4efb\u52a1\u5417\uff1f`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{_.loadingInfo.isLoading=!0,_.loadingInfo.content="\u6b63\u5728\u505c\u6b62\u4e2d...";let a={action:"stop_task",id:t.id};U.sysTaskcenterMg(a).then((e=>{_.loadingInfo.isLoading=!1,_.loadingInfo.content="",2e3==e.code?(N.success(e.msg),"1"==b.value?B():T()):N.warning(e.msg)}))})).catch((()=>{}))}))}(t)},{default:d((()=>m[7]||(m[7]=[k("\u505c\u6b62")]))),_:2},1032,["onClick"])):o("",!0),i(H,{plain:"",type:"danger",icon:"delete",onClick:a=>function(t){return e(this,null,(function*(){O.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${t.name}\u3011\u4efb\u52a1\u5417\uff1f`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{_.loadingInfo.isLoading=!0,_.loadingInfo.content="\u6b63\u5728\u5220\u9664\u4e2d...";let a={action:"del_task",id:t.id};U.sysTaskcenterMg(a).then((e=>{_.loadingInfo.isLoading=!1,_.loadingInfo.content="",2e3==e.code?(N.success(e.msg),"1"==b.value?B():T()):N.warning(e.msg)}))})).catch((()=>{}))}))}(t)},{default:d((()=>m[8]||(m[8]=[k("\u5220\u9664")]))),_:2},1032,["onClick"]),i(H,{plain:"",type:"primary",icon:"Document",onClick:e=>E(t)},{default:d((()=>m[9]||(m[9]=[k("\u67e5\u770b\u65e5\u5fd7")]))),_:2},1032,["onClick"])])])])])])),_:2},1024)))),128))])),_:1})):o("",!0),"1"==g(b)?(n(),u(Y,{key:1,style:{padding:"10px","text-align":"left"}},{default:d((()=>[i(H,{circle:"",icon:"refresh",onClick:S})])),_:1})):o("",!0),"2"==g(b)?(n(),u(A,{key:2},{default:d((()=>[0==g(x).length?(n(),u(I,{key:0,"image-size":120},{default:d((()=>m[10]||(m[10]=[c("p",{style:{"font-size":"14px",color:"#999","line-height":"1.5",margin:"0 40px"}},"\u6ca1\u6709\u5386\u53f2\u4efb\u52a1",-1)]))),_:1})):o("",!0),(n(!0),l(s,null,r(g(x),(e=>(n(),u($,{key:e.id,shadow:"hover",class:"tasks-item"},{default:d((()=>[c("div",fe,[c("div",me,[c("div",pe,[c("h2",null,f(e.name),1),c("p",null,[k(" \u521b\u5efa\u65f6\u95f4\uff1a"+f(e.create_at)+" ",1),c("span",he,"\u8017\u65f6\uff1a"+f(g(P)(e.duration)),1)])]),c("div",ye,[c("div",ge,[0==e.status?(n(),u(z,{key:0,type:"info"},{default:d((()=>m[11]||(m[11]=[k("\u7b49\u5f85\u4e2d")]))),_:1})):o("",!0),1==e.status?(n(),u(z,{key:1,type:"primary"},{default:d((()=>m[12]||(m[12]=[k("\u6267\u884c\u4e2d")]))),_:1})):o("",!0),2==e.status?(n(),u(z,{key:2,type:"danger"},{default:d((()=>m[13]||(m[13]=[k("\u5df2\u5931\u8d25")]))),_:1})):o("",!0),3==e.status?(n(),u(z,{key:3,type:"success"},{default:d((()=>m[14]||(m[14]=[k("\u5df2\u5b8c\u6210")]))),_:1})):o("",!0)]),c("div",ve,[i(H,{plain:"",type:"primary",icon:"Document",onClick:t=>E(e)},{default:d((()=>m[15]||(m[15]=[k("\u67e5\u770b\u65e5\u5fd7")]))),_:2},1032,["onClick"]),i(H,{plain:"",icon:"Download",onClick:t=>{D(e.log_path)}},{default:d((()=>m[16]||(m[16]=[k("\u4e0b\u8f7d")]))),_:2},1032,["onClick"])])])])])])),_:2},1024)))),128))])),_:1})):o("",!0),"2"==g(b)?(n(),u(Y,{key:3,style:{padding:"10px","text-align":"left"}},{default:d((()=>[i(W,{small:!0,"child-msg":g(L),onCallFather:M,border:!1},null,8,["child-msg"])])),_:1})):o("",!0),g(V)?(n(),u(F,{key:4,ref_key:"moduleinstallLogFlag",ref:R,onClosed:m[1]||(m[1]=e=>v(V)?V.value=!1:V=!1),onRefreshData:S},null,512)):o("",!0)])),_:1})),[[G,g(w)]])}}},[["__scopeId","data-v-3ef7b0f0"]]),_e=S({__name:"lysettings",setup(e){const t=V();let l=m(["#008040","#536dfe","#722ed1","#009688","#52c41a","#faad14","#ff5c93","#c62f2f","#fd726d"]),o=m(["#272E39","#3C444D","#465161","#222b45","#2c3643","#545c64","#009688","#52c41a","#faad14","#ff5c93"]),s=m(["#fff","#3C444D","#465161","#222b45","#2c3643","#545c64","#009688","#52c41a","#faad14","#ff5c93"]),r=m(t.colorPrimary||"#409EFF");function c(){t.setColorPrimary(r.value)}m(t.pagingLayout),m("light"!=t.siteTheme),m(t.language),m(t.programLayout);let f=m(t.elementSize);function p(e){t.setElementSize(e)}let h=m(t.menuHeaderColor01);function y(e){t.setMenuHeaderColor01(e)}let k=m(t.menuHeaderColor02);function _(e){t.setMenuHeaderColor02(e)}let b=m(t.menuWidth);function C(e){t.setMenuWidth(e)}return(e,t)=>{const m=a("el-divider"),w=a("el-color-picker"),x=a("el-form-item"),I=a("el-input-number"),L=a("el-option"),M=a("el-select"),T=a("el-form");return n(),u(T,{ref:"form","label-width":"120px","label-position":"left",style:{padding:"0 20px"}},{default:d((()=>[i(m),i(x,{label:"\u4e3b\u9898\u989c\u8272"},{default:d((()=>[i(w,{modelValue:g(r),"onUpdate:modelValue":t[0]||(t[0]=e=>v(r)?r.value=e:r=e),predefine:g(l),onChange:c},null,8,["modelValue","predefine"])])),_:1}),i(x,{label:"\u5934\u90e8\u989c\u8272"},{default:d((()=>[i(w,{modelValue:g(h),"onUpdate:modelValue":t[1]||(t[1]=e=>v(h)?h.value=e:h=e),predefine:g(o),onChange:y},null,8,["modelValue","predefine"])])),_:1}),i(x,{label:"\u83dc\u5355\u989c\u8272"},{default:d((()=>[i(w,{modelValue:g(k),"onUpdate:modelValue":t[2]||(t[2]=e=>v(k)?k.value=e:k=e),predefine:g(s),onChange:_},null,8,["modelValue","predefine"])])),_:1}),i(x,{label:"\u83dc\u5355\u5bbd\u5ea6(px)"},{default:d((()=>[i(I,{modelValue:g(b),"onUpdate:modelValue":t[3]||(t[3]=e=>v(b)?b.value=e:b=e),onChange:C,style:{width:"100%"}},null,8,["modelValue"])])),_:1}),i(m),i(x,{label:"\u7ec4\u4ef6\u5927\u5c0f"},{default:d((()=>[i(M,{modelValue:g(f),"onUpdate:modelValue":t[4]||(t[4]=e=>v(f)?f.value=e:f=e),placeholder:"\u8bf7\u9009\u62e9",onChange:p},{default:d((()=>[i(L,{label:"\u9ed8\u8ba4",value:"default"}),i(L,{label:"\u5c0f",value:"small"}),i(L,{label:"\u5927",value:"large"})])),_:1},8,["modelValue"])])),_:1}),i(m)])),_:1},512)}}},[["__scopeId","data-v-613f3064"]]),be={class:"user-bar"},Ce={class:"user-avatar"},we=S({__name:"userbar",setup(e){const t=A(),r=V(),h=H();let y=m(!1),_=m(!1),b=m(!1),w=m(!1);m(!1),m([]);let x=m(!1),I=m(null),L=m(null);function M(){w.value=!0,C((()=>{L.value.refresh()}))}function T(){if("light"==r.siteTheme)r.setSiteTheme("dark");else{r.setSiteTheme("light");const e=r.menuHeaderColor01,t=r.menuHeaderColor02;r.setMenuHeaderColor01(e),r.setMenuHeaderColor02(t)}}function j(){b.value=!0}function B(e){"clearCache"==e||("updateLogs"==e?window.open("https://ruyi.lybbn.cn/doc/ruyi/update.html"):"checkUpdate"==e?(h.loadingInfo.isLoading=!0,h.loadingInfo.content="\u83b7\u53d6\u4e2d...",U.sysGetSysUpdate().then((e=>{h.loadingInfo.isLoading=!1,h.loadingInfo.content="",2e3==e.code?function(e){if(e.can_update){let t=`<div style="font-size:15px;">\u53d1\u73b0\u65b0\u7248\u672c<span style="color:red;">\u3010${e.n_ver}\u3011</span>,\u662f\u5426\u786e\u5b9a\u66f4\u65b0\uff1f<br/><a target="_blank" href="https://ruyi.lybbn.cn/doc/ruyi/update.html" style="color:#008040">\u67e5\u770b\u66f4\u65b0\u65e5\u5fd7</a><div>`;O({title:"\u66f4\u65b0\u63d0\u793a",message:t,dangerouslyUseHTMLString:!0,showCancelButton:!0,confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88",type:"warning",icon:"Download",customClass:"ruyiMessageBoxClass",beforeClose:(e,t,a)=>{"confirm"===e&&function(e="update"){h.loadingInfo.isLoading=!0,h.loadingInfo.content="\u66f4\u65b0\u4e2d...",U.sysStartSysUpdate({action:e}).then((e=>{h.loadingInfo.isLoading=!1,h.loadingInfo.content="",2e3==e.code?(x.value=!0,C((()=>{I.value.onlyRestartPanel()}))):N.warning(e.msg)}))}("update"),a()}}).then((e=>{})).catch((()=>{}))}else N.success("\u5f53\u524d\u5df2\u662f\u6700\u65b0\u7248\u672c")}(e.data):N.warning(e.msg)}))):"fixPanel"==e?O({title:"\u4fee\u590d\u9762\u677f\u63d0\u793a",message:'<div style="font-size:15px;">\u8be5\u64cd\u4f5c\u80fd\u4fee\u590d\u4f7f\u7528\u4e2d\u9047\u5230\u7684\u5f02\u5e38\u95ee\u9898\uff0c\u662f\u5426\u786e\u5b9a\u6267\u884c\u4fee\u590d\u9762\u677f\u64cd\u4f5c\uff1f<div>',dangerouslyUseHTMLString:!0,showCancelButton:!0,confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88",type:"warning",icon:"EditPen",customClass:"ruyiMessageBoxClass",beforeClose:(e,t,a)=>{"confirm"===e&&function(e="fix"){h.loadingInfo.isLoading=!0,h.loadingInfo.content="\u4fee\u590d\u4e2d...",U.sysStartSysUpdate({action:e}).then((e=>{h.loadingInfo.isLoading=!1,h.loadingInfo.content="",2e3==e.code?(x.value=!0,C((()=>{I.value.onlyRestartPanel()}))):N.warning(e.msg)}))}("fix"),a()}}).then((e=>{})).catch((()=>{})):"outLogin"==e&&O.confirm("\u9000\u51fa\u767b\u5f55, \u662f\u5426\u7ee7\u7eed?","\u63d0\u793a",{confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88",type:"warning"}).then((()=>{z.clear(),t.push("/login"),N.success("\u5df2\u9000\u51fa\u767b\u5f55!")})).catch((()=>{})))}function S(){h.isProUserCheck()&&(y.value=!0)}return p((()=>{})),(e,t)=>{const m=a("Notification"),p=a("el-icon"),C=a("el-tooltip"),V=a("el-badge");a("ChatDotRound"),a("el-avatar"),a("el-empty"),a("el-scrollbar"),a("el-main"),a("el-button"),a("el-footer"),a("el-container");const R=a("el-drawer"),E=a("Sunny"),z=a("Moon"),H=a("SwitchButton"),U=a("ArrowDown"),P=a("Share"),D=a("el-dropdown-item"),$=a("StarFilled"),A=a("EditPen"),O=a("Tools"),N=a("CircleCloseFilled"),F=a("el-dropdown-menu"),W=a("el-dropdown"),Y=a("el-dialog");return n(),l(s,null,[c("div",be,[c("div",{class:"tasks panel-item",onClick:M},[i(V,{hidden:0==g(h).taskInfo.taskNumber,value:g(h).taskInfo.taskNumber,class:"badge",type:"danger"},{default:d((()=>[i(C,{effect:"dark",content:"\u4efb\u52a1\u5217\u8868",placement:"bottom"},{default:d((()=>[i(p,null,{default:d((()=>[i(m)])),_:1})])),_:1})])),_:1},8,["hidden","value"])]),o("",!0),c("div",{class:"theme panel-item",onClick:T},["dark"==g(r).siteTheme?(n(),u(p,{key:0},{default:d((()=>[i(E)])),_:1})):(n(),u(p,{key:1},{default:d((()=>[i(z)])),_:1}))]),c("div",{class:"shutdown panel-item",onClick:j},[i(C,{effect:"dark",content:"\u91cd\u542f\uff1a\u5982\u610f\u9762\u677f\u6216\u670d\u52a1\u5668",placement:"bottom"},{default:d((()=>[i(p,null,{default:d((()=>[i(H)])),_:1})])),_:1})]),i(W,{class:"user panel-item",trigger:"click",onCommand:B},{dropdown:d((()=>[i(F,null,{default:d((()=>[i(D,{command:"updateLogs"},{default:d((()=>[i(p,null,{default:d((()=>[i(P)])),_:1}),t[8]||(t[8]=k("\u66f4\u65b0\u65e5\u5fd7"))])),_:1}),i(D,{command:"checkUpdate"},{default:d((()=>[i(p,null,{default:d((()=>[i($)])),_:1}),t[9]||(t[9]=k("\u68c0\u67e5\u66f4\u65b0"))])),_:1}),i(D,{command:"fixPanel"},{default:d((()=>[i(p,null,{default:d((()=>[i(A)])),_:1}),t[10]||(t[10]=k("\u4fee\u590d\u9762\u677f"))])),_:1}),i(D,{onClick:S},{default:d((()=>[i(p,null,{default:d((()=>[i(O)])),_:1}),t[11]||(t[11]=k("\u5e03\u5c40\u8bbe\u7f6e")),i(p,{color:"#f7ba2a"},{default:d((()=>[i($)])),_:1})])),_:1}),i(D,{divided:"",command:"outLogin"},{default:d((()=>[i(p,null,{default:d((()=>[i(N)])),_:1}),t[12]||(t[12]=k("\u9000\u51fa\u767b\u5f55"))])),_:1})])),_:1})])),default:d((()=>[c("div",Ce,[t[7]||(t[7]=c("label",null,f("\u66f4\u591a"),-1)),i(p,{class:"el-icon--right"},{default:d((()=>[i(U)])),_:1})])])),_:1})]),i(Y,{modelValue:g(_),"onUpdate:modelValue":t[2]||(t[2]=e=>v(_)?_.value=e:_=e),width:700,title:"\u641c\u7d22",center:"","destroy-on-close":""},{default:d((()=>[i(le,{onSuccess:t[1]||(t[1]=e=>v(_)?_.value=!1:_=!1)})])),_:1},8,["modelValue"]),i(Y,{modelValue:g(b),"onUpdate:modelValue":t[3]||(t[3]=e=>v(b)?b.value=e:b=e),width:300,title:"\u91cd\u542f\u670d\u52a1\u5668\u6216\u9762\u677f","destroy-on-close":""},{default:d((()=>[i(oe)])),_:1},8,["modelValue"]),g(x)?(n(),u(oe,{key:0,ref_key:"onlyShudownRef",ref:I},null,512)):o("",!0),i(R,{modelValue:g(w),"onUpdate:modelValue":t[4]||(t[4]=e=>v(w)?w.value=e:w=e),size:"50%","append-to-body":"",title:"\u4efb\u52a1\u4e2d\u5fc3","destroy-on-close":"",class:"lytask-drawer"},{default:d((()=>[i(ke,{ref_key:"taskref",ref:L},null,512)])),_:1},8,["modelValue"]),i(R,{title:"\u5e03\u5c40\u8bbe\u7f6e",modelValue:g(y),"onUpdate:modelValue":t[5]||(t[5]=e=>v(y)?y.value=e:y=e),size:400,"append-to-body":"","destroy-on-close":""},{default:d((()=>[i(_e)])),_:1},8,["modelValue"])],64)}}},[["__scopeId","data-v-0b6dd57a"]]),xe=Y("iframeList",{state:()=>({iframeList:[]}),actions:{setIframeList(e){this.iframeList=[],this.iframeList.push(e)},pushIframeList(e){this.iframeList.find((t=>t.path===e.path))||this.iframeList.push(e)},removeIframeList(e){this.iframeList.forEach(((t,a)=>{t.path===e.path&&this.iframeList.splice(a,1)}))},refreshIframe(e){this.iframeList.forEach((t=>{if(t.path==e.path){var a=e.meta.url;t.meta.url="",setTimeout((function(){t.meta.url=a}),200)}}))},clearIframeList(){this.iframeList=[]}}}),Ie={class:"iframe-pages"},Le=["src"],Me=S({__name:"iframeView",setup(e){const a=V(),o=xe(),i=$();w((()=>i),(e=>{f(e)}));const u=t((()=>o.iframeList)),d=t((()=>a.ismobile)),c=t((()=>a.ismultitabs));function f(e){"iframe"==e.meta.type?d.value||!c.value?o.setIframeList(e):o.pushIframeList(e):d.value&&o.clearIframeList()}return p((()=>{f(i)})),(e,t)=>y((n(),l("div",Ie,[(n(!0),l(s,null,r(u.value,(t=>y((n(),l("iframe",{key:t.meta.url,src:t.meta.url,frameborder:"0"},null,8,Le)),[[b,e.$route.meta.url==t.meta.url]]))),128))],512)),[[b,"iframe"==e.$route.meta.type]])}},[["__scopeId","data-v-5d23cb55"]]),Te=Y("keepAlive",{state:()=>({routeShow:!0,keepAliveRoute:[]}),getters:{},actions:{setKeepAliveRoute(e){this.keepAliveRoute=e,z.set("keepAliveRoute",e)},setRouteShow(e){this.routeShow=e,z.set("routeShow",e)}}}),je={emits:["confirm","cancel"],props:{hidden:!0,title:String,width:{type:Number,default:880},height:{type:Number,default:500},showHeader:{type:Boolean,default:!0},showHeaderBg:{type:Boolean,default:!0},hideFooter:{type:Boolean,default:!0},showFooterBg:{type:Boolean,default:!0},showConfrim:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},confirmText:{type:String,default:"\u786e\u5b9a"},cancelText:{type:String,default:"\u53d6\u6d88"},buttonReverse:{type:Boolean,default:!1},borderRadius:!1,showCloseBtn:{type:Boolean,default:!0}},data:()=>({willclose:!1}),methods:{closeDialog(){this.willclose=!0,setTimeout((()=>{this.willclose=!1,this.$emit("close")}),100)}}},Be={key:0,class:"lydialog-wrapper"},Se={class:"title"};const Ve=S(je,[["render",function(e,t,s,r,u,m){const p=a("Close"),h=a("el-icon");return s.hidden?o("",!0):(n(),l("div",Be,[c("div",{class:x(["dialog-wrap",{radius:s.borderRadius},{willclose:u.willclose},{goup:s.buttonReverse}]),style:I({width:s.width+"px"})},[s.showHeader?(n(),l("div",{key:0,class:x(["box-header",{hidden:!s.showHeaderBg}])},[c("div",Se,f(s.title),1),s.showCloseBtn?(n(),l("div",{key:0,class:"btn-close",onClick:t[0]||(t[0]=(...e)=>m.closeDialog&&m.closeDialog(...e))},[i(h,{class:"icon"},{default:d((()=>[i(p)])),_:1})])):o("",!0)],2)):o("",!0),c("div",{class:"box-body",style:I({height:s.height+"px"})},[L(e.$slots,"default")],4),s.hideFooter?o("",!0):(n(),l("div",{key:1,class:x(["box-footer",{hidden:!s.showFooterBg},{reverse:s.buttonReverse}])},[s.showConfrim?(n(),l("button",{key:0,class:"btn btn-primary",onClick:t[1]||(t[1]=t=>e.$emit("confirm"))},f(s.confirmText),1)):o("",!0),s.showCancel?(n(),l("button",{key:1,class:"btn btn-gray",onClick:t[2]||(t[2]=t=>e.$emit("cancel"))},f(s.cancelText),1)):o("",!0)],2))],6)]))}]]),Re={key:0,class:"lyloading-content"},Ee={key:1,class:"lyloading-restart"},ze={style:{"margin-bottom":"5px","font-size":"14px"}},He=S({__name:"lyloading",props:{isLoading:{type:Boolean,default:!0},width:{type:Number,default:300},height:{type:Number,default:200},content:{type:String,default:""},restartMode:{type:Boolean,default:!1},delay:{type:Number,default:6}},emits:["closed"],setup(e,{emit:o}){const s=o,r=e;let h=t((()=>{let e=r.delay-b.value;return e>=0?e:0})),y=t((()=>{let e=b.value>10?10:b.value;return".".repeat(e)}));function v(){s("closed")}let _=m(0),b=m(0),C=m(null);return w((()=>r.restartMode),((e,t)=>{e?(b.value=0,_.value=0,C.value&&clearInterval(C.value),C.value=setInterval((()=>{b.value<=r.delay?(b.value++,_.value+=parseInt(100/r.delay),_.value>100&&(_.value=100),b.value>=r.delay&&(_.value=100)):clearInterval(C.value)}),1e3)):C.value&&clearInterval(C.value)})),p((()=>{})),M((()=>{clearInterval(C.value)})),(t,o)=>{const s=a("Loading"),r=a("el-icon"),m=a("el-text"),p=a("el-progress");return n(),u(Ve,{hidden:!e.isLoading,title:"",width:e.width,height:e.height,showHeader:!1,onClose:v},{default:d((()=>[e.restartMode?(n(),l("div",Ee,[c("div",ze,"\u91cd\u542f\u4e2d("+f(g(h))+"s)"+f(g(y)),1),i(p,{percentage:g(_),"stroke-width":19,status:"success",striped:"","striped-flow":"",duration:2},null,8,["percentage"])])):(n(),l("div",Re,[i(r,{class:"is-loading"},{default:d((()=>[i(s)])),_:1}),i(m,{class:"ldcontent",truncated:""},{default:d((()=>[k(f(e.content),1)])),_:1})]))])),_:1},8,["hidden","width","height"])}}},[["__scopeId","data-v-530fa1aa"]]),Ue={class:"ruyi-panel-header"},Pe={class:"ruyi-panel-header-left"},De={class:"logo-bar"},$e={key:0,class:"ruyi-panel-header-center"},Ae={style:{"margin-left":"10px","margin-right":"10px",display:"flex","align-items":"center"}},Oe={style:{"padding-right":"8px"}},Ne={class:"ruyi-panel-header-right"},Fe={class:"ruyi-panel-wrapper"},We={class:"ruyi-panel-side-scroll"},Ye={class:"ruyi-panel-body el-container"},qe={class:"ruyi-panel-main",id:"ruyi-panel-main"},Ge=S({__name:"index",setup(e){const r=$(),h=A(),w=V(),L=Te(),B=R(),S=H();S.getSystemConfig();let z=m(""),P=m(!1),D=m(!1),N=m(0),F=m(0),W=t((()=>w.ismobile));t((()=>w.ismultitabs));let Y=t((()=>w.isMenuCollapse));function q(e){const t=e.split(".");return 4===t.length?`${t[0]}.${"*".repeat(t[1].length)}.${"*".repeat(t[2].length)}.${t[3]}`:""}function X(){w.setMenuCollapsed(!Y.value),setTimeout((()=>{window.dispatchEvent(new Event("resize"))}),1e3)}function J(){document.getElementById("app").classList.remove("main-maximize")}function Q(){C((()=>{r.meta&&r.meta.activeMenu?z.value=r.meta.activeMenu:z.value=r.path}))}function Z(){C((()=>{w.setIsmobile(document.body.clientWidth<992)}))}function ee(){D.value=!1}let te=m(null);function ae(e){te.value&&!te.value.contains(e.target)&&ee()}let le=m("");function ne(){if(le.value){let e=window.location.origin;window.open(e+"/#"+le.value,"_blank")}ee()}function oe(){le.value&&(r.path==le.value?window.location.reload():h.push({path:le.value})),ee()}function ie(e,t){t&&(e.preventDefault(),e.stopPropagation(),le.value=t,D.value=!0,N.value=e.clientX+1,F.value=e.clientY+1,C((()=>{let t=document.getElementById("lyleftMenuContext");document.body.offsetWidth-e.clientX<t.offsetWidth&&(N.value=document.body.offsetWidth-t.offsetWidth-1,F.value=e.clientY+1)})))}function se(e=""){return"pro"==e?"\u4e13\u4e1a\u7248":"enterprise"==e?"\u4f01\u4e1a\u7248":"\u514d\u8d39\u7248"}let re=m({c_ver:S.sysConfig.sysVersion,can_update:!1,n_ver:""});function ue(){O.alert("\u8bf7\u70b9\u51fb\u53f3\u4e0a\u89d2->\u3010\u66f4\u591a\u3011->\u3010\u68c0\u67e5\u66f4\u65b0\u3011\uff01\uff01\uff01","\u63d0\u793a",{confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88",type:"warning"}).then((()=>{})).catch((()=>{}))}function de(e){var t=[];return e&&e.forEach((e=>{var a;if(e.meta=e.meta?e.meta:{},null==(a=e.meta)?void 0:a.hidden)return!1;e.children&&e.children.length>0&&(e.children=de(e.children),0===e.children.length&&delete e.children),t.push(e)})),t}let ce=t((()=>de(B.routesList)));return p((()=>{Z(),window.addEventListener("resize",Z),Q(),S.getSystemTaskIngInfo(),h.afterEach(Q),document.addEventListener("click",ae),S.getLicenseInfo(),U.sysGetSysUpdate().then((e=>{2e3==e.code&&(re.value=e.data)}))})),M((()=>{window.removeEventListener("resize",Z),document.removeEventListener("click",ae)})),(e,t)=>{const r=a("el-badge"),m=a("el-menu"),p=a("el-scrollbar"),h=a("expand"),C=a("fold"),w=a("el-icon"),M=a("router-view"),B=a("CopyDocument"),V=a("Refresh"),R=a("Close");return n(),l(s,null,[c("header",Ue,[c("div",Pe,[c("div",De,[t[1]||(t[1]=c("img",{class:"logo",src:E},null,-1)),c("span",{onClick:t[0]||(t[0]=e=>v(P)?P.value=!g(P):P=!g(P)),style:{cursor:"pointer"}},f(g(P)?q(g(S).serverInfo.serverIp):g(S).serverInfo.serverIp),1)])]),g(W)?o("",!0):(n(),l("div",$e,[t[2]||(t[2]=c("a",{href:"https://ruyi.lybbn.cn/",target:"_blank"},"Copyright \xa9 lybbn",-1)),c("span",Ae,[k(f(se(g(S).licenseInfo.role))+"\uff1a ",1),g(re).can_update?(n(),u(r,{key:0,"is-dot":"",style:{cursor:"pointer"},onClick:ue},{default:d((()=>[c("span",Oe,f(g(S).sysConfig.sysVersion),1)])),_:1})):(n(),l("span",{key:1,onClick:ue,style:{cursor:"pointer"}},f(g(S).sysConfig.sysVersion),1))]),g(S).licenseInfo.username?(n(),l("span",{key:0,style:I({background:"1"==g(S).licenseInfo.active_state?"green":"#484040",padding:"3px"})},"\u6388\u6743\uff1a"+f(g(S).licenseInfo.username),5)):o("",!0)])),c("div",Ne,[i(we)])]),c("section",Fe,[g(W)?o("",!0):(n(),l("div",{key:0,class:x(g(Y)?"ruyi-panel-side isCollapse":"ruyi-panel-side")},[c("div",We,[i(p,null,{default:d((()=>[i(m,{class:"rymenu","default-active":g(z),router:"",collapse:g(Y),"unique-opened":!0,"collapse-transition":!1},{default:d((()=>[i(G,{navMenus:g(ce),onContextmenuClick:ie},null,8,["navMenus"])])),_:1},8,["default-active","collapse"])])),_:1})]),c("div",{class:"ruyi-panel-side-bottom",onClick:X},[i(w,null,{default:d((()=>[g(Y)?(n(),u(h,{key:0})):(n(),u(C,{key:1}))])),_:1})])],2)),g(W)?(n(),u(K,{key:1})):o("",!0),c("div",Ye,[c("div",qe,[i(M,null,{default:d((({Component:e,route:t})=>[(n(),u(T,{include:g(L).keepAliveRoute},[g(L).routeShow?(n(),u(_(e),{key:t.path})):o("",!0)],1032,["include"]))])),_:1}),i(Me)])])]),i(j,{name:"el-zoom-in-top"},{default:d((()=>[y(c("ul",{style:I({left:g(N)+"px",top:g(F)+"px"}),class:"contextmenu",id:"lyleftMenuContext",ref_key:"lyleftMenuContext",ref:te},[c("li",{onClick:ne},[i(w,null,{default:d((()=>[i(B)])),_:1}),t[3]||(t[3]=c("span",{class:"contextmenu-text"},"\u65b0\u6807\u7b7e\u6253\u5f00",-1))]),c("li",{onClick:oe},[i(w,null,{default:d((()=>[i(V)])),_:1}),t[4]||(t[4]=c("span",{class:"contextmenu-text"},"\u5237\u65b0\u672c\u9875",-1))]),c("li",{onClick:ee},[i(w,null,{default:d((()=>[i(R)])),_:1}),t[5]||(t[5]=c("span",{class:"contextmenu-text"},"\u53d6\u6d88\u64cd\u4f5c",-1))])],4),[[b,g(D)]])])),_:1}),c("div",{class:"main-maximize-exit",onClick:J},[i(w,null,{default:d((()=>[i(R)])),_:1})]),i(He,{isLoading:g(S).loadingInfo.isLoading,content:g(S).loadingInfo.content,restartMode:g(S).loadingInfo.restartMode,width:300,height:100,delay:g(S).loadingInfo.delay},null,8,["isLoading","content","restartMode","delay"])],64)}}},[["__scopeId","data-v-437a623e"]]);export{Ge as default};
