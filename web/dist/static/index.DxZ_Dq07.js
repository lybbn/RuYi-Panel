var e=Object.defineProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(l,t,a)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a;import{b as i,ag as s,o as r,c as n,P as d,H as u,u as p,O as c,a4 as m,I as f,G as v,a as y,M as g,Q as h,L as w,K as _,t as b,k as j,j as k,aq as x,a5 as C,n as I}from"./@vue.BluSRtaz.js";import{i as O,A as z,c as V,u as S,H as L,m as D}from"./index.CzVJI0jJ.js";import{P}from"./Pagination.DhOoI1te.js";import{L as F}from"./dialog.BvK2-1BY.js";import{_ as R}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as M,a as T}from"./element-plus.CMBwCou9.js";import{i as U}from"./installLog.COPpm_5l.js";import{b as q}from"./vue-router.CjawWhbh.js";import{s as B}from"./softInfo.BejlUjrw.js";import"./axios.3Xbkft1r.js";import"./crypto-js.CCePG2on.js";import"./@xterm.8vZnc5Va.js";import"./js-cookie.Ch5AnFJE.js";import"./vue-clipboard3.CjTOZN0C.js";import"./clipboard.55ERAcYO.js";import"./pinia.DhJalR8o.js";import"./@element-plus.sBVz1STF.js";import"./nprogress.B5M_jmCc.js";import"./pinia-plugin-persistedstate.DTf8V5gU.js";import"./destr.ZpApkS-1.js";import"./deep-pick-omit.DP_A4OSP.js";import"./lodash-es.BccSst5e.js";import"./@vueuse.l0Dx-5Bl.js";import"./@popperjs.CpAfbxx4.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.9DdhAVak.js";import"./async-validator.Cuo4gI4y.js";import"./memoize-one.Ds0C_khL.js";import"./normalize-wheel-es.CUoAWVRo.js";import"./@floating-ui.yzr8CaSr.js";import"./index.GhyFdw6y.js";import"./vue-codemirror.DFdUdG36.js";import"./codemirror.BJSsQESG.js";import"./@codemirror.BkM7iGym.js";import"./@lezer.CzslrRCj.js";import"./crelt.DSg10-ms.js";import"./style-mod.Dj2YSJ7-.js";import"./w3c-keyname.f-y9tSbI.js";const E={style:{float:"left"}},A={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}},H={class:"ry-cj-title"},K={class:"ry-cj-desc"},Q={key:0,class:"ry-sp-tips"},W=R({__name:"moduleInstall",emits:["refreshData","closed"],setup(e,{expose:j,emit:k}){const x=k;let C=i(!1),I=i(!1),V=i("\u8be6\u60c5"),S=i({id:"",name:"",version_id:1}),L={},D=i([]),P=i(!1),R=i({});function T(){x("closed")}let U=i(null);function q(e=1){U.value.validate((i=>{if(i){I.value=!0;let i=((e,i)=>{for(var s in i||(i={}))t.call(i,s)&&o(e,s,i[s]);if(l)for(var s of l(i))a.call(i,s)&&o(e,s,i[s]);return e})({},S.value);i.action="install",i.type=e,z.sysSoftManage(i).then((e=>{I.value=!1,2e3==e.code?(T(),x("refreshData",e.data.id,S.value.name)):M.warning(e.msg)}))}}))}return j({handleOpen:function(e,l){V.value=l,C.value=!0,e&&(L=O(e),S.value.id=L.id,S.value.name=L.name,D.value=L.versions,P.value=L.is_windows)}}),(e,l)=>{const t=s("el-option"),a=s("el-select"),o=s("el-form-item"),i=s("el-button"),j=s("el-col"),k=s("el-divider"),x=s("Warning"),O=s("el-icon"),z=s("el-text"),M=s("el-row"),B=s("el-form");return r(),n("div",null,[d(F,{modelValue:p(C),"onUpdate:modelValue":l[2]||(l[2]=e=>b(C)?C.value=e:C=e),title:p(V),width:"50%","before-close":T},{default:u((()=>[d(B,{inline:!1,model:p(S),rules:p(R),ref_key:"rulesForm",ref:U,"label-position":"right","label-width":"auto"},{default:u((()=>[d(M,{gutter:20},{default:u((()=>[d(j,{span:24,style:{display:"flex"}},{default:u((()=>[d(o,{label:"",prop:"version_id",style:{"margin-right":"15px"}},{default:u((()=>[d(a,{modelValue:p(S).version_id,"onUpdate:modelValue":l[0]||(l[0]=e=>p(S).version_id=e),placeholder:"\u8bf7\u9009\u62e9",style:{width:"240px"}},{default:u((()=>[(r(!0),n(c,null,m(p(D),(e=>f((r(),v(t,{key:e.id,label:p(L).name+" "+e.version,value:e.id},{default:u((()=>[y("span",E,g(p(L).name+" "+e.version),1),y("span",A,g(e.c_version),1)])),_:2},1032,["label","value"])),[[h,!e.hide]]))),128))])),_:1},8,["modelValue"])])),_:1}),d(o,{label:"",prop:""},{default:u((()=>[p(P)?_("",!0):(r(),v(i,{key:0,type:"primary",onClick:l[1]||(l[1]=e=>q(1)),disabled:p(I)},{default:u((()=>l[3]||(l[3]=[w("\u5b89\u88c5")]))),_:1},8,["disabled"]))])),_:1})])),_:1}),d(k),d(j,{span:24},{default:u((()=>[y("div",H,[d(O,{size:"22"},{default:u((()=>[d(x)])),_:1}),l[4]||(l[4]=y("h1",null,"\u5e94\u7528\u8bf4\u660e",-1))]),y("div",K,[d(z,null,{default:u((()=>[w(g(p(L).desc),1)])),_:1})]),"go"==p(L).name?(r(),n("div",Q," \u7279\u522b\u63d0\u793a\uff1a\u5982\u679c\u5b89\u88c5\u4e86\u591a\u4e2a\u7248\u672c\u7684"+g(p(L).name)+"\uff0c\u9ed8\u8ba4\u65b0\u5b89\u88c5\u7684"+g(p(L).name)+"\u4e3a\u9ed8\u8ba4\u7248\u672c\uff0c\u60f3\u5207\u6362\uff0c\u70b9\u51fb\u3010\u8bbe\u7f6e\u3011\u5207\u6362\u4e3a\u60f3\u8981\u7684\u7248\u672c\u5373\u53ef ",1)):_("",!0),l[5]||(l[5]=y("div",{class:"ry-cj-care"},[y("li",null,"\u8bf7\u5148\u786e\u4fdd\u5728\u5b89\u88c5\u6b64\u5e94\u7528\u524d\uff0c\u5df2\u624b\u52a8\u5b89\u88c5\u597d\u6b64\u5e94\u7528\u6240\u9700\u7684\u73af\u5883\uff01"),y("li",null,"\u5982\u679c\u5df2\u5b58\u5728\u6b64\u5e94\u7528\u6216\u76ee\u5f55\u6587\u4ef6\uff0c\u5b89\u88c5\u65f6\u4f1a\u8986\u76d6\u539f\u6587\u4ef6\uff01"),y("li",null,"\u5b89\u88c5\u5e94\u7528\u4e3a\u8017\u65f6\u64cd\u4f5c\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u5b89\u88c5\u5b8c\u6bd5\uff01")],-1))])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-ed8fffb8"]]),$={class:"filter-button"},G={style:{display:"flex","align-items":"center"}},Y={style:{display:"flex","align-items":"center"}},J={key:0,class:"ryellipsis"},N={key:1},X={key:2},Z={key:0,class:"lyczj"},ee=["onClick"],le={key:1},te={key:3},ae=R({__name:"index",setup(e){const l=q(),t=V(),a=S();let o=j((()=>a.ismobile)),h=i(!1),O=i([{label:"\u5168\u90e8",value:"0",icon:"",type:"primary"},{label:"\u5df2\u5b89\u88c5",value:"1",icon:"",type:"success"},{label:"\u6570\u636e\u5e93",value:"2",icon:"",type:"success"},{label:"Web\u670d\u52a1\u5668",value:"3",icon:"",type:"success"},{label:"\u8fd0\u884c\u73af\u5883",value:"4",icon:"",type:"danger"},{label:"\u5b89\u5168\u9632\u62a4",value:"5",icon:"",type:"danger"}]),F=i({type:"0",page:1,limit:10}),R=i({page:1,limit:10,total:0});let E=i(!1),A=i([]);function H(e){F.value.page=e.page,F.value.limit=e.limit,K()}function K(){E.value=!0,z.sysSoftList(F.value).then((e=>{E.value=!1,2e3==e.code&&(h.value=e.data.is_windows,A.value=e.data.soft.list,R.value.page=e.data.soft.page,R.value.limit=e.data.soft.limit,R.value.total=e.data.soft.total)}))}function Q(e){if(e.installed&&e.version){let l="";for(let t=0;t<e.versions.length;t++)if(e.version===e.versions[t].c_version&&"openresty"==e.versions[t].version){l=` ${e.versions[t].version} `;break}return l}return""}function ae(){F.value.type="0",F.value.page=1,F.value.limit=10,K()}let oe=i(!1),ie=i(null);let se=i(!1),re=i(null);function ne(e,l){t.getSystemTaskIngInfo(),se.value=!0,I((()=>{let t={id:e};re.value.handleOpen(t,"\u5b89\u88c5\u3010"+l+"\u3011\u65e5\u5fd7\u8be6\u60c5")}))}function de(){window.location.reload()}let ue=i(!1),pe=i(null);function ce(e){"supervisor"==e.name?l.push({path:"/tools",query:{tabs:"supervisor"}}):(ue.value=!0,I((()=>{pe.value.handleOpen(e,"\u3010"+e.name+"("+e.version+")\u3011\u7ba1\u7406")})))}function me(e){A.value.forEach((l=>{l.id==e.id&&(l.status=e.status)}))}return k((()=>{K()})),(e,a)=>{const i=s("el-button"),j=s("el-input"),k=s("el-col"),V=s("el-row"),S=s("el-card"),q=s("el-image"),fe=s("el-tag"),ve=s("el-table-column"),ye=s("el-tooltip"),ge=s("el-table"),he=s("el-main"),we=x("loading");return r(),v(he,{class:"lycontainer"},{default:u((()=>[d(S,{shadow:"never",header:"\u5206\u7c7b\u7b5b\u9009"},{default:u((()=>[d(V,{style:{"margin-bottom":"15px"}},{default:u((()=>[d(k,{xs:24,sm:20,md:15,lg:8,xl:8},{default:u((()=>[d(j,{modelValue:p(F).searchContent,"onUpdate:modelValue":a[0]||(a[0]=e=>p(F).searchContent=e),clearable:"",placeholder:"\u8bf7\u8f93\u5165\u8981\u641c\u7d22\u7684\u5e94\u7528\u540d\u79f0",onChange:ae,onKeyup:C(ae,["enter"])},{append:u((()=>[d(i,{onClick:ae,icon:"search",class:"search-content"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),y("div",$,[(r(!0),n(c,null,m(p(O),(e=>(r(),v(i,{key:e.value,round:!1,circle:!1,icon:e.icon?e.icon:"",onClick:l=>function(e){F.value.type=e.value,F.value.page=1,F.value.limit=10,K()}(e),type:p(F).type===e.value?"primary":""},{default:u((()=>[w(g(e.label),1)])),_:2},1032,["icon","onClick","type"])))),128))])])),_:1}),d(S,{shadow:"never",header:"\u5e94\u7528\u5217\u8868",style:{"margin-top":"10px"}},{header:u((()=>[y("div",G,[a[4]||(a[4]=y("div",{style:{"margin-right":"15px"}},"\u5e94\u7528\u5217\u8868",-1)),d(i,{icon:"refresh",circle:"",onClick:ae,size:"small"})])])),default:u((()=>[f((r(),v(ge,{data:p(A),style:{width:"100%","border-top":"1px solid var(--el-border-color-lighter)"},"header-cell-class-name":"table-header-style"},{default:u((()=>[d(ve,{prop:"title",label:"\u8f6f\u4ef6\u540d\u79f0","min-width":"180","show-overflow-tooltip":""},{default:u((e=>[y("div",Y,[d(q,{src:p(L)(e.row.icon,"fileicons"),style:{width:"25px",height:"25px","margin-right":"5px"}},null,8,["src"]),"nginx"==e.row.name?(r(),n("div",J,g(e.row.installed?e.row.title+Q(e.row)+e.row.version:e.row.title),1)):"python"==e.row.name||"go"==e.row.name?(r(),n("div",N,[w(g(e.row.title)+" ",1),"go"==e.row.name&&e.row.is_default?(r(),v(fe,{key:0,type:"primary",effect:"light",round:"",size:"small"},{default:u((()=>a[5]||(a[5]=[w("\u9ed8\u8ba4")]))),_:1})):_("",!0)])):(r(),n("div",X,g(e.row.installed?e.row.title+e.row.version:e.row.title),1))])])),_:1}),d(ve,{prop:"desc",label:"\u8bf4\u660e","min-width":"300","show-overflow-tooltip":""}),d(ve,{prop:"price",label:"\u7c7b\u578b",width:"115"},{default:u((e=>[y("span",null,g(0==e.row.price?"\u514d\u8d39":e.row.price.toString()+"\u5143/\u5e74"),1)])),_:1}),d(ve,{prop:"typename",label:"\u5206\u7c7b",width:"130"},{default:u((e=>[d(fe,null,{default:u((()=>[w(g(e.row.typename),1)])),_:2},1024)])),_:1}),d(ve,{label:"\u4f4d\u7f6e",width:"80"},{default:u((e=>[e.row.installed?(r(),n("div",Z,[d(ye,{effect:"dark",content:"\u70b9\u51fb\u6253\u5f00\u5b89\u88c5\u76ee\u5f55",placement:"bottom"},{default:u((()=>[y("img",{class:"ruyi-fileicons",src:D,onClick:a=>{var o;(o=e.row).install_path&&(t.fileInfo.currentDir=o.install_path,l.push({path:"/files"}))}},null,8,ee)])),_:2},1024)])):(r(),n("span",le))])),_:1}),d(ve,{prop:"status",label:"\u72b6\u6001",width:"112"},{default:u((e=>[e.row.installed&&e.row.status&&4==e.row.type?(r(),v(fe,{key:0,type:"success"},{default:u((()=>a[6]||(a[6]=[w("\u5df2\u5b89\u88c5")]))),_:1})):e.row.installed&&e.row.status?(r(),v(fe,{key:1,type:"success"},{default:u((()=>a[7]||(a[7]=[w("\u5df2\u542f\u52a8")]))),_:1})):e.row.installed&&!e.row.status?(r(),v(fe,{key:2,type:"danger"},{default:u((()=>a[8]||(a[8]=[w("\u5df2\u505c\u6b62")]))),_:1})):(r(),n("span",te))])),_:1}),d(ve,{fixed:!p(o)&&"right",label:"\u64cd\u4f5c",width:"150"},{default:u((e=>[e.row.installed?_("",!0):(r(),v(i,{key:0,link:"",type:"primary",onClick:l=>{return t=e.row,oe.value=!0,void I((()=>{let e={desc:t.desc,is_windows:h.value,versions:t.versions,name:t.name,title:t.title,id:t.id};ie.value.handleOpen(e,t.title)}));var t}},{default:u((()=>a[9]||(a[9]=[w("\u5b89\u88c5")]))),_:2},1032,["onClick"])),e.row.installed&&"python"!=e.row.name?(r(),v(i,{key:1,link:"",type:"primary",onClick:l=>ce(e.row)},{default:u((()=>a[10]||(a[10]=[w("\u8bbe\u7f6e")]))),_:2},1032,["onClick"])):_("",!0),e.row.installed?(r(),v(i,{key:2,link:"",type:"primary",onClick:l=>{return a=e.row,void T.confirm(`\u786e\u5b9a\u8981\u5378\u8f7d\u3010${a.name+" "+a.version}\u3011\u5417\uff1f`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a\u5378\u8f7d",type:"warning"}).then((e=>{t.loadingInfo.isLoading=!0,t.loadingInfo.content="\u6b63\u5728\u5378\u8f7d\u4e2d...";let l={action:"uninstall",id:a.id};z.sysSoftManage(l).then((e=>{t.loadingInfo.isLoading=!1,t.loadingInfo.content="",2e3==e.code?(M.success(e.msg),K()):M.warning(e.msg)}))})).catch((()=>{}));var a}},{default:u((()=>a[11]||(a[11]=[w("\u5378\u8f7d")]))),_:2},1032,["onClick"])):_("",!0)])),_:1},8,["fixed"])])),_:1},8,["data"])),[[we,p(E)]]),d(P,{small:!0,"child-msg":p(R),onCallFather:H,border:!1,position:"right"},null,8,["child-msg"])])),_:1}),p(se)?(r(),v(U,{key:0,ref_key:"moduleinstallLogFlag",ref:re,onClosed:a[1]||(a[1]=e=>b(se)?se.value=!1:se=!1),onRefreshData:de},null,512)):_("",!0),p(oe)?(r(),v(W,{key:1,ref_key:"moduleInstallFlag",ref:ie,onClosed:a[2]||(a[2]=e=>b(oe)?oe.value=!1:oe=!1),onRefreshData:ne},null,512)):_("",!0),p(ue)?(r(),v(B,{key:2,ref_key:"softInfoFlag",ref:pe,onClosed:a[3]||(a[3]=e=>b(ue)?ue.value=!1:ue=!1),onRefreshData:K,onRefreshStatus:me},null,512)):_("",!0)])),_:1})}}},[["__scopeId","data-v-e4d7e52c"]]);export{ae as default};
