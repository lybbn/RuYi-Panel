var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t;import{b as i,ai as s,o as n,c as r,U as d,O as u,u as p,F as c,a8 as m,M as f,a as v,T as y,S as g,R as h,D as w,k as _,j as b,aq as j,a9 as k,P as x,n as C}from"./@vue.BMBj57q3.js";import{j as I,A as O,c as z,u as S,I as V,n as D}from"./index.D1mG68-9.js";import{P as F}from"./Pagination.AJTPZh6u.js";import{L}from"./dialog.DfP35yxJ.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as R,a as T}from"./element-plus.WT5mSVn7.js";import{i as U}from"./installLog.CeAyKd6A.js";import{b as M}from"./vue-router.CzFCPhwq.js";import{s as q}from"./softInfo.DQsZI5_b.js";import"./axios.3Xbkft1r.js";import"./crypto-js.CCePG2on.js";import"./@xterm.8vZnc5Va.js";import"./js-cookie.Ch5AnFJE.js";import"./vue-clipboard3.CjTOZN0C.js";import"./clipboard.55ERAcYO.js";import"./pinia.CfJUVU3l.js";import"./@element-plus.BcDOhvuq.js";import"./nprogress.B5M_jmCc.js";import"./pinia-plugin-persistedstate.DTf8V5gU.js";import"./destr.ZpApkS-1.js";import"./deep-pick-omit.DP_A4OSP.js";import"./lodash-es.CjrOehCd.js";import"./@vueuse.B2CPJC1D.js";import"./@popperjs.CpAfbxx4.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.VYhIaz1R.js";import"./async-validator.Cuo4gI4y.js";import"./memoize-one.Ds0C_khL.js";import"./normalize-wheel-es.CUoAWVRo.js";import"./@floating-ui.yzr8CaSr.js";import"./index.BNOrQDSs.js";import"./vue-codemirror.BiWnDJmD.js";import"./codemirror.BJSsQESG.js";import"./@codemirror.BkM7iGym.js";import"./@lezer.CzslrRCj.js";import"./crelt.DSg10-ms.js";import"./style-mod.Dj2YSJ7-.js";import"./w3c-keyname.f-y9tSbI.js";const B={style:{float:"left"}},E={style:{float:"right",color:"var(--el-text-color-secondary)","font-size":"13px"}},A={class:"ry-cj-title"},W={class:"ry-cj-desc"},K={key:0,class:"ry-sp-tips"},Q=P({__name:"moduleInstall",emits:["refreshData","closed"],setup(e,{expose:_,emit:b}){const j=b;let k=i(!1),x=i(!1),C=i("\u8be6\u60c5"),z=i({id:"",name:"",version_id:1}),S={},V=i([]),D=i(!1),F=i({});function P(){j("closed")}let T=i(null);function U(e=1){T.value.validate((i=>{if(i){x.value=!0;let i=((e,i)=>{for(var s in i||(i={}))a.call(i,s)&&o(e,s,i[s]);if(l)for(var s of l(i))t.call(i,s)&&o(e,s,i[s]);return e})({},z.value);i.action="install",i.type=e,O.sysSoftManage(i).then((e=>{x.value=!1,2e3==e.code?(P(),j("refreshData",e.data.id,z.value.name)):R.warning(e.msg)}))}}))}return _({handleOpen:function(e,l){C.value=l,k.value=!0,e&&(S=I(e),z.value.id=S.id,z.value.name=S.name,V.value=S.versions,D.value=S.is_windows)}}),(e,l)=>{const a=s("el-option"),t=s("el-select"),o=s("el-form-item"),i=s("el-button"),_=s("el-col"),b=s("el-divider"),j=s("Warning"),I=s("el-icon"),O=s("el-text"),R=s("el-row"),M=s("el-form");return n(),r("div",null,[d(L,{modelValue:p(k),"onUpdate:modelValue":l[2]||(l[2]=e=>w(k)?k.value=e:k=e),title:p(C),width:"50%","before-close":P},{default:u((()=>[d(M,{inline:!1,model:p(z),rules:p(F),ref_key:"rulesForm",ref:T,"label-position":"right","label-width":"auto"},{default:u((()=>[d(R,{gutter:20},{default:u((()=>[d(_,{span:24,style:{display:"flex"}},{default:u((()=>[d(o,{label:"",prop:"version_id",style:{"margin-right":"15px"}},{default:u((()=>[d(t,{modelValue:p(z).version_id,"onUpdate:modelValue":l[0]||(l[0]=e=>p(z).version_id=e),placeholder:"\u8bf7\u9009\u62e9",style:{width:"240px"}},{default:u((()=>[(n(!0),r(c,null,m(p(V),(e=>(n(),f(a,{key:e.id,label:p(S).name+" "+e.version,value:e.id},{default:u((()=>[v("span",B,y(p(S).name+" "+e.version),1),v("span",E,y(e.c_version),1)])),_:2},1032,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(o,{label:"",prop:""},{default:u((()=>[p(D)?h("",!0):(n(),f(i,{key:0,type:"primary",onClick:l[1]||(l[1]=e=>U(1)),disabled:p(x)},{default:u((()=>l[3]||(l[3]=[g("\u5b89\u88c5")]))),_:1},8,["disabled"]))])),_:1})])),_:1}),d(b),d(_,{span:24},{default:u((()=>[v("div",A,[d(I,{size:"22"},{default:u((()=>[d(j)])),_:1}),l[4]||(l[4]=v("h1",null,"\u5e94\u7528\u8bf4\u660e",-1))]),v("div",W,[d(O,null,{default:u((()=>[g(y(p(S).desc),1)])),_:1})]),"go"==p(S).name?(n(),r("div",K," \u7279\u522b\u63d0\u793a\uff1a\u5982\u679c\u5b89\u88c5\u4e86\u591a\u4e2a\u7248\u672c\u7684"+y(p(S).name)+"\uff0c\u9ed8\u8ba4\u65b0\u5b89\u88c5\u7684"+y(p(S).name)+"\u4e3a\u9ed8\u8ba4\u7248\u672c\uff0c\u60f3\u5207\u6362\uff0c\u70b9\u51fb\u3010\u8bbe\u7f6e\u3011\u5207\u6362\u4e3a\u60f3\u8981\u7684\u7248\u672c\u5373\u53ef ",1)):h("",!0),l[5]||(l[5]=v("div",{class:"ry-cj-care"},[v("li",null,"\u8bf7\u5148\u786e\u4fdd\u5728\u5b89\u88c5\u6b64\u5e94\u7528\u524d\uff0c\u5df2\u624b\u52a8\u5b89\u88c5\u597d\u6b64\u5e94\u7528\u6240\u9700\u7684\u73af\u5883\uff01"),v("li",null,"\u5982\u679c\u5df2\u5b58\u5728\u6b64\u5e94\u7528\u6216\u76ee\u5f55\u6587\u4ef6\uff0c\u5b89\u88c5\u65f6\u4f1a\u8986\u76d6\u539f\u6587\u4ef6\uff01"),v("li",null,"\u5b89\u88c5\u5e94\u7528\u4e3a\u8017\u65f6\u64cd\u4f5c\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u5b89\u88c5\u5b8c\u6bd5\uff01")],-1))])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}},[["__scopeId","data-v-f3441118"]]),Y={class:"filter-button"},$={style:{display:"flex","align-items":"center"}},G={style:{display:"flex","align-items":"center"}},H={key:0},J={key:1},N={key:2},X={key:0,class:"lyczj"},Z=["onClick"],ee={key:1},le={key:3},ae=P({__name:"index",setup(e){const l=M(),a=z(),t=S();let o=_((()=>t.ismobile)),I=i(!1),L=i([{label:"\u5168\u90e8",value:"0",icon:"",type:"primary"},{label:"\u5df2\u5b89\u88c5",value:"1",icon:"",type:"success"},{label:"\u6570\u636e\u5e93",value:"2",icon:"",type:"success"},{label:"Web\u670d\u52a1\u5668",value:"3",icon:"",type:"success"},{label:"\u8fd0\u884c\u73af\u5883",value:"4",icon:"",type:"danger"},{label:"\u5b89\u5168\u9632\u62a4",value:"5",icon:"",type:"danger"}]),P=i({type:"0",page:1,limit:10}),B=i({page:1,limit:10,total:0});let E=i(!1),A=i([]);function W(e){P.value.page=e.page,P.value.limit=e.limit,K()}function K(){E.value=!0,O.sysSoftList(P.value).then((e=>{E.value=!1,2e3==e.code&&(I.value=e.data.is_windows,A.value=e.data.soft.list,B.value.page=e.data.soft.page,B.value.limit=e.data.soft.limit,B.value.total=e.data.soft.total)}))}function ae(e){if(e.installed&&e.version){let l="";for(let a=0;a<e.versions.length;a++)if(e.version===e.versions[a].c_version&&"openresty"==e.versions[a].version){l="&nbsp;"+e.versions[a].version+"&nbsp;";break}return l}return""}function te(){P.value.type="0",P.value.page=1,P.value.limit=10,K()}let oe=i(!1),ie=i(null);let se=i(!1),ne=i(null);function re(e,l){a.getSystemTaskIngInfo(),se.value=!0,C((()=>{let a={id:e};ne.value.handleOpen(a,"\u5b89\u88c5\u3010"+l+"\u3011\u65e5\u5fd7\u8be6\u60c5")}))}function de(){window.location.reload()}let ue=i(!1),pe=i(null);function ce(e){"supervisor"==e.name?l.push({path:"/tools",query:{tabs:"supervisor"}}):(ue.value=!0,C((()=>{pe.value.handleOpen(e,"\u3010"+e.name+"("+e.version+")\u3011\u7ba1\u7406")})))}function me(e){A.value.forEach((l=>{l.id==e.id&&(l.status=e.status)}))}return b((()=>{K()})),(e,t)=>{const i=s("el-button"),_=s("el-input"),b=s("el-col"),z=s("el-row"),S=s("el-card"),M=s("el-image"),fe=s("el-tag"),ve=s("el-table-column"),ye=s("el-tooltip"),ge=s("el-table"),he=s("el-main"),we=j("loading");return n(),f(he,{class:"lycontainer"},{default:u((()=>[d(S,{shadow:"never",header:"\u5206\u7c7b\u7b5b\u9009"},{default:u((()=>[d(z,{style:{"margin-bottom":"15px"}},{default:u((()=>[d(b,{xs:24,sm:20,md:15,lg:8,xl:8},{default:u((()=>[d(_,{modelValue:p(P).searchContent,"onUpdate:modelValue":t[0]||(t[0]=e=>p(P).searchContent=e),clearable:"",placeholder:"\u8bf7\u8f93\u5165\u8981\u641c\u7d22\u7684\u5e94\u7528\u540d\u79f0",onChange:te,onKeyup:k(te,["enter"])},{append:u((()=>[d(i,{onClick:te,icon:"search",class:"search-content"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),v("div",Y,[(n(!0),r(c,null,m(p(L),(e=>(n(),f(i,{key:e.value,round:!1,circle:!1,icon:e.icon?e.icon:"",onClick:l=>function(e){P.value.type=e.value,P.value.page=1,P.value.limit=10,K()}(e),type:p(P).type===e.value?"primary":""},{default:u((()=>[g(y(e.label),1)])),_:2},1032,["icon","onClick","type"])))),128))])])),_:1}),d(S,{shadow:"never",header:"\u5e94\u7528\u5217\u8868",style:{"margin-top":"10px"}},{header:u((()=>[v("div",$,[t[4]||(t[4]=v("div",{style:{"margin-right":"15px"}},"\u5e94\u7528\u5217\u8868",-1)),d(i,{icon:"refresh",circle:"",onClick:te,size:"small"})])])),default:u((()=>[x((n(),f(ge,{data:p(A),style:{width:"100%","border-top":"1px solid var(--el-border-color-lighter)"},"header-cell-class-name":"table-header-style"},{default:u((()=>[d(ve,{prop:"title",label:"\u8f6f\u4ef6\u540d\u79f0",width:"200"},{default:u((e=>[v("div",G,[d(M,{src:p(V)(e.row.icon,"fileicons"),style:{width:"25px",height:"25px","margin-right":"5px"}},null,8,["src"]),"nginx"==e.row.name?(n(),r("div",H,y(e.row.installed?e.row.title+ae(e.row)+e.row.version:e.row.title),1)):"python"==e.row.name||"go"==e.row.name?(n(),r("div",J,[g(y(e.row.title)+" ",1),"go"==e.row.name&&e.row.is_default?(n(),f(fe,{key:0,type:"primary",effect:"light",round:"",size:"small"},{default:u((()=>t[5]||(t[5]=[g("\u9ed8\u8ba4")]))),_:1})):h("",!0)])):(n(),r("div",N,y(e.row.installed?e.row.title+e.row.version:e.row.title),1))])])),_:1}),d(ve,{prop:"desc",label:"\u8bf4\u660e","min-width":"300","show-overflow-tooltip":""}),d(ve,{prop:"price",label:"\u7c7b\u578b",width:"130"},{default:u((e=>[v("span",null,y(0==e.row.price?"\u514d\u8d39":e.row.price.toString()+"\u5143/\u5e74"),1)])),_:1}),d(ve,{prop:"typename",label:"\u5206\u7c7b",width:"130"},{default:u((e=>[d(fe,null,{default:u((()=>[g(y(e.row.typename),1)])),_:2},1024)])),_:1}),d(ve,{label:"\u4f4d\u7f6e",width:"80"},{default:u((e=>[e.row.installed?(n(),r("div",X,[d(ye,{effect:"dark",content:"\u70b9\u51fb\u6253\u5f00\u5b89\u88c5\u76ee\u5f55",placement:"bottom"},{default:u((()=>[v("img",{class:"ruyi-fileicons",src:D,onClick:t=>{var o;(o=e.row).install_path&&(a.fileInfo.currentDir=o.install_path,l.push({path:"/files"}))}},null,8,Z)])),_:2},1024)])):(n(),r("span",ee))])),_:1}),d(ve,{prop:"status",label:"\u72b6\u6001",width:"130"},{default:u((e=>[e.row.installed&&e.row.status&&4==e.row.type?(n(),f(fe,{key:0,type:"success"},{default:u((()=>t[6]||(t[6]=[g("\u5df2\u5b89\u88c5")]))),_:1})):e.row.installed&&e.row.status?(n(),f(fe,{key:1,type:"success"},{default:u((()=>t[7]||(t[7]=[g("\u5df2\u542f\u52a8")]))),_:1})):e.row.installed&&!e.row.status?(n(),f(fe,{key:2,type:"danger"},{default:u((()=>t[8]||(t[8]=[g("\u5df2\u505c\u6b62")]))),_:1})):(n(),r("span",le))])),_:1}),d(ve,{fixed:!p(o)&&"right",label:"\u64cd\u4f5c",width:"150"},{default:u((e=>[e.row.installed?h("",!0):(n(),f(i,{key:0,link:"",type:"primary",onClick:l=>{return a=e.row,oe.value=!0,void C((()=>{let e={desc:a.desc,is_windows:I.value,versions:a.versions,name:a.name,title:a.title,id:a.id};ie.value.handleOpen(e,a.title)}));var a}},{default:u((()=>t[9]||(t[9]=[g("\u5b89\u88c5")]))),_:2},1032,["onClick"])),e.row.installed&&"python"!=e.row.name?(n(),f(i,{key:1,link:"",type:"primary",onClick:l=>ce(e.row)},{default:u((()=>t[10]||(t[10]=[g("\u8bbe\u7f6e")]))),_:2},1032,["onClick"])):h("",!0),e.row.installed?(n(),f(i,{key:2,link:"",type:"primary",onClick:l=>{return t=e.row,void T.confirm(`\u786e\u5b9a\u8981\u5378\u8f7d\u3010${t.name+" "+t.version}\u3011\u5417\uff1f`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a\u5378\u8f7d",type:"warning"}).then((e=>{a.loadingInfo.isLoading=!0,a.loadingInfo.content="\u6b63\u5728\u5378\u8f7d\u4e2d...";let l={action:"uninstall",id:t.id};O.sysSoftManage(l).then((e=>{a.loadingInfo.isLoading=!1,a.loadingInfo.content="",2e3==e.code?(R.success(e.msg),K()):R.warning(e.msg)}))})).catch((()=>{}));var t}},{default:u((()=>t[11]||(t[11]=[g("\u5378\u8f7d")]))),_:2},1032,["onClick"])):h("",!0)])),_:1},8,["fixed"])])),_:1},8,["data"])),[[we,p(E)]]),d(F,{small:!0,"child-msg":p(B),onCallFather:W,border:!1,position:"right"},null,8,["child-msg"])])),_:1}),p(se)?(n(),f(U,{key:0,ref_key:"moduleinstallLogFlag",ref:ne,onClosed:t[1]||(t[1]=e=>w(se)?se.value=!1:se=!1),onRefreshData:de},null,512)):h("",!0),p(oe)?(n(),f(Q,{key:1,ref_key:"moduleInstallFlag",ref:ie,onClosed:t[2]||(t[2]=e=>w(oe)?oe.value=!1:oe=!1),onRefreshData:re},null,512)):h("",!0),p(ue)?(n(),f(q,{key:2,ref_key:"softInfoFlag",ref:pe,onClosed:t[3]||(t[3]=e=>w(ue)?ue.value=!1:ue=!1),onRefreshData:K,onRefreshStatus:me},null,512)):h("",!0)])),_:1})}}},[["__scopeId","data-v-b90f63a0"]]);export{ae as default};
