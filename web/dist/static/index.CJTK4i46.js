var e=(e,t,a)=>new Promise(((l,n)=>{var o=e=>{try{s(a.next(e))}catch(t){n(t)}},i=e=>{try{s(a.throw(e))}catch(t){n(t)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,i);s((a=a.apply(e,t)).next())}));import{ag as t,o as a,c as l,P as n,K as o,O as i,a4 as s,G as r,H as u,a as d,M as c,V as f,J as m,b as p,j as h,aq as y,I as g,u as v,t as k,L as _,Q as b,n as C,e as w,k as x,C as I,D as L,B as j,W as M,ay as T,T as V}from"./@vue.BluSRtaz.js";import{u as S,a as B,_ as R,b as E,c as z,A as H,f as U,g as A,d as P}from"./index.DdU3pFbI.js";import{u as D,b as $}from"./vue-router.CjawWhbh.js";import{_ as N}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{a as O,E as F}from"./element-plus.CMBwCou9.js";import{i as W}from"./installLog.BNxGstQl.js";import{P as Y}from"./Pagination.DhOoI1te.js";import{d as q}from"./pinia.DhJalR8o.js";import"./crypto-js.CCePG2on.js";import"./js-cookie.Ch5AnFJE.js";import"./clipboard.55ERAcYO.js";import"./axios.3Xbkft1r.js";import"./vue-clipboard3.CjTOZN0C.js";import"./@element-plus.sBVz1STF.js";import"./nprogress.B5M_jmCc.js";import"./@xterm.8vZnc5Va.js";import"./pinia-plugin-persistedstate.DTf8V5gU.js";import"./destr.ZpApkS-1.js";import"./deep-pick-omit.DP_A4OSP.js";import"./lodash-es.BccSst5e.js";import"./@vueuse.l0Dx-5Bl.js";import"./@popperjs.CpAfbxx4.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.9DdhAVak.js";import"./async-validator.Cuo4gI4y.js";import"./memoize-one.Ds0C_khL.js";import"./normalize-wheel-es.CUoAWVRo.js";import"./@floating-ui.yzr8CaSr.js";import"./dialog.BvK2-1BY.js";import"./index.GhyFdw6y.js";import"./vue-codemirror.DFdUdG36.js";import"./codemirror.BJSsQESG.js";import"./@codemirror.BkM7iGym.js";import"./@lezer.CzslrRCj.js";import"./crelt.DSg10-ms.js";import"./style-mod.Dj2YSJ7-.js";import"./w3c-keyname.f-y9tSbI.js";const G={key:0,style:{padding:"20px"}},K=["href"],Q={__name:"NavMenu",props:{navMenus:{type:Array,default:[]}},emits:["contextmenuClick"],setup(e,{emit:p}){const h=p;function y(e,t){h("contextmenuClick",e,t)}return(p,h)=>{const g=t("el-alert"),v=t("el-icon"),k=t("el-menu-item"),_=t("NavMenu",!0),b=t("el-sub-menu");return a(),l(i,null,[e.navMenus.length<=0?(a(),l("div",G,[n(g,{title:"\u65e0\u83dc\u5355",center:"",type:"info",closable:!1})])):o("",!0),(a(!0),l(i,null,s(e.navMenus,(e=>{return a(),l(i,{key:e},[(t=e,!t.children||t.children.every((e=>e.meta.hidden))?(a(),r(k,{key:0,index:e.path,"data-id":e.path,onContextmenu:t=>y(t,e.path)},{title:u((()=>[d("span",null,c(e.meta.title),1)])),default:u((()=>[e.meta&&"link"==e.meta.type?(a(),l("a",{key:0,href:e.path,target:"_blank",onClick:f((()=>{}),["stop"])},null,8,K)):o("",!0),e.meta&&e.meta.icon?(a(),r(v,{key:1},{default:u((()=>[(a(),r(m(e.meta.icon||"menu")))])),_:2},1024)):o("",!0)])),_:2},1032,["index","data-id","onContextmenu"])):(a(),r(b,{key:1,index:e.path,"data-id":e.path,onContextmenu:t=>y(t,e.path)},{title:u((()=>[e.meta&&e.meta.icon?(a(),r(v,{key:0},{default:u((()=>[(a(),r(m(e.meta.icon||"menu")))])),_:2},1024)):o("",!0),d("span",null,c(e.meta.title),1)])),default:u((()=>[n(_,{navMenus:e.children},null,8,["navMenus"])])),_:2},1032,["index","data-id","onContextmenu"])))],64);var t})),128))],64)}}},X=N({__name:"sideMobile",setup(e){const o=S(),s=D(),r=B();let c=p(!1),f=p([]);let m=p(null);function _(){m.value.handleClose()}return h((()=>{f.value=function(e){var t=[];return e&&e.forEach((e=>{if(e.meta=e.meta?e.meta:{},e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&(e.children=this.filterUrl(e.children)),t.push(e)})),t}(r.routesList)})),(e,r)=>{const p=t("Menu"),h=t("el-icon"),b=t("el-header"),C=t("el-menu"),w=t("el-scrollbar"),x=t("el-main"),I=t("el-container"),L=t("el-drawer"),j=y("drag");return a(),l(i,null,[g((a(),l("div",{ref:"",class:"mobile-nav-button",onClick:r[0]||(r[0]=e=>function(e){if("true"==e.currentTarget.getAttribute("drag-flag"))return!1;c.value=!0}(e))},[n(h,null,{default:u((()=>[n(p)])),_:1})])),[[j]]),n(L,{ref_key:"mobileNavMenuBox",ref:m,title:"\u79fb\u52a8\u7aef\u83dc\u5355",size:200,modelValue:v(c),"onUpdate:modelValue":r[1]||(r[1]=e=>k(c)?c.value=e:c=e),direction:"ltr","with-header":!1,"destroy-on-close":""},{default:u((()=>[n(I,{class:"mobile-nav"},{default:u((()=>[n(b,null,{default:u((()=>r[2]||(r[2]=[d("div",{class:"logo-bar"},[d("img",{class:"logo",src:R})],-1)]))),_:1}),n(x,null,{default:u((()=>[n(w,{class:"lyruyimobilenavside"},{default:u((()=>[n(C,{"default-active":v(s).meta.active||v(s).fullPath,onSelect:_,router:"","background-color":"dark"==v(o).siteTheme?"#141414":"#272E39","text-color":"#fff","active-text-color":"#008040"},{default:u((()=>[n(Q,{navMenus:v(f)},null,8,["navMenus"])])),_:1},8,["default-active","background-color"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}}},[["__scopeId","data-v-e06ce1fc"]]),J={class:"lysearch"},Z={key:0,class:"lysearch-history"},ee={class:"lysearch-result"},te={key:0,class:"lysearch-no-result"},ae={key:1},le=["onClick"],ne={class:"title"},oe=N({__name:"search",emits:["success"],setup(e,{emit:f}){const y=f,g=$();let b=p(null),C=p(""),w=p([]),x=p([]),I=p([]);function L(e){var t,a,l,n;x.value=e?(t=e,a=[],l=w.value.filter((e=>e.meta.title.toLowerCase().indexOf(t.toLowerCase())>=0||e.name.toLowerCase().indexOf(t.toLowerCase())>=0||void 0)),n=n.getRoutes(),l.map((e=>"link"==e.meta.type?n.find((t=>t.path=="/"+e.path)):n.find((t=>t.path==e.path)))).forEach((e=>{a.push({name:e.name,type:e.meta.type,path:"link"==e.meta.type?e.path.slice(1):e.path,icon:e.meta.icon,title:e.meta.title,breadcrumb:e.meta.breadcrumb.map((e=>e.meta.title)).join(" - ")})})),a):[]}function j(e){e.forEach((e=>{if(e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&!e.component?j(e.children):w.value.push(e)}))}return h((()=>{var e=E.get("SEARCH_HISTORY")||[];I.value=e,j(g.getRoutes()),b.value.focus()})),(e,f)=>{const p=t("el-input"),h=t("el-tag"),w=t("el-icon"),j=t("el-scrollbar");return a(),l("div",J,[n(p,{ref_key:"refInput",ref:b,modelValue:v(C),"onUpdate:modelValue":f[0]||(f[0]=e=>k(C)?C.value=e:C=e),placeholder:"\u641c\u7d22",size:"large",clearable:"","prefix-icon":"search","trigger-on-focus":!1,onInput:L},null,8,["modelValue"]),v(I).length>0?(a(),l("div",Z,[(a(!0),l(i,null,s(v(I),((e,t)=>(a(),r(h,{closable:"",effect:"dark",type:"info",key:e,onClick:t=>{return a=e,C.value=a,void L(a);var a},onClose:e=>function(e){I.value.splice(e,1),I.value.length<=0?E.remove("SEARCH_HISTORY"):E.set("SEARCH_HISTORY",this.history)}(t)},{default:u((()=>[_(c(e),1)])),_:2},1032,["onClick","onClose"])))),128))])):o("",!0),d("div",ee,[v(x).length<=0?(a(),l("div",te,"\u6682\u65e0\u641c\u7d22\u7ed3\u679c")):(a(),l("ul",ae,[n(j,{"max-height":"366px"},{default:u((()=>[(a(!0),l(i,null,s(v(x),(e=>(a(),l("li",{key:e.path,onClick:t=>function(e){I.value.includes(this.input)||(I.value.push(this.input),E.set("SEARCH_HISTORY",this.history)),"link"==e.type?setTimeout((()=>{let t=document.createElement("a");t.style="display: none",t.target="_blank",t.href=e.path,document.body.appendChild(t),t.click(),document.body.removeChild(t)}),10):g.push({path:e.path}),y("success",!0)}(e)},[n(w,null,{default:u((()=>[(a(),r(m(e.icon||"menu")))])),_:2},1024),d("span",ne,c(e.breadcrumb),1)],8,le)))),128))])),_:1})]))])])}}},[["__scopeId","data-v-dcb9c94e"]]),ie={class:"lyshutdown"},se=N({__name:"shutdown",emits:["success"],setup(e,{expose:o,emit:i}){const s=z();let r=p(!0);function d(){O.confirm("\u5373\u5c06\u91cd\u542f\u670d\u52a1\u5668\uff0c\u786e\u8ba4\u91cd\u542f\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{s.loadingInfo.isLoading=!0,s.loadingInfo.delay=20,s.loadingInfo.content="\u6b63\u5728\u91cd\u542f\u670d\u52a1\u5668...",s.loadingInfo.restartMode=!0;let t=!1;H.sysServmanage({action:"restart",type:"server"}).then((e=>{2e3===e.code||(s.loadingInfo.isLoading=!1,s.loadingInfo.content="",s.loadingInfo.delay=6,t=!0,F.error(e.msg))})),t||setTimeout((()=>{s.loadingInfo.isLoading=!1,s.loadingInfo.content="",s.loadingInfo.restartMode=!1,s.loadingInfo.delay=6,window.location.reload()}),21e3)})).catch((()=>{}))}function c(){O.confirm("\u5373\u5c06\u91cd\u542f\u5982\u610f\u9762\u677f\uff0c\u786e\u8ba4\u91cd\u542f\u5417\uff1f","\u63d0\u9192",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{s.loadingInfo.isLoading=!0,s.loadingInfo.content="\u6b63\u5728\u91cd\u542f\u5982\u610f\u9762\u677f...",s.loadingInfo.restartMode=!0,s.loadingInfo.delay=6;let t=!1;H.sysServmanage({action:"restart",type:"panel"}).then((e=>{2e3===e.code||(s.loadingInfo.isLoading=!1,s.loadingInfo.content="",s.loadingInfo.delay=6,t=!0,F.error(e.msg))})),setTimeout((()=>{t||(s.loadingInfo.isLoading=!1,s.loadingInfo.content="",s.loadingInfo.restartMode=!1,s.loadingInfo.delay=6,window.location.reload())}),7e3)})).catch((()=>{}))}return o({onlyRestartPanel:function(){r.value=!1,c()}}),(e,o)=>{const i=t("el-button");return g((a(),l("div",ie,[n(i,{dark:"",size:"large",bg:"",onClick:d},{default:u((()=>o[0]||(o[0]=[_("\u91cd\u542f\u670d\u52a1\u5668")]))),_:1}),n(i,{dark:"",size:"large",bg:"",onClick:c},{default:u((()=>o[1]||(o[1]=[_("\u91cd\u542f\u5982\u610f\u9762\u677f")]))),_:1})],512)),[[b,v(r)]])}}},[["__scopeId","data-v-1031ed68"]]),re={class:"tasks-item-body"},ue={class:"taskMain"},de={class:"title"},ce={class:"bottom"},fe={class:"state"},me={class:"handler"},pe={class:"tasks-item-body"},he={class:"taskMain"},ye={class:"title"},ge={style:{"margin-left":"20px"}},ve={class:"bottom"},ke={class:"state"},_e={class:"handler"},be=N({__name:"tasks",setup(f,{expose:m}){const h=z();let b=p("1"),w=p(!1),x=p([]),I=p({action:"end",page:1,limit:10}),L=p({page:1,limit:10,total:0});function j(t){return e(this,null,(function*(){I.value.page=t.page,I.value.limit=t.limit,yield M()}))}function M(){return e(this,null,(function*(){w.value=!0,x.value=[],H.sysTaskcenter(I.value).then((e=>{w.value=!1,2e3==e.code&&(x.value=e.data.data,L.value.page=e.data.page,L.value.limit=e.data.limit,L.value.total=e.data.total)}))}))}function T(t){return e(this,null,(function*(){"1"==t.props.name?S():yield M()}))}function V(){return e(this,null,(function*(){w.value=!0,yield h.getSystemTaskIngInfo(),w.value=!1}))}function S(){V()}let B=p(!1),R=p(null);function E(e){let t=e.id;B.value=!0;let a=2==e.status||3==e.status?"all":"new_lines";C((()=>{let l={id:t,action:a};R.value.handleOpen(l,e.name+"\u65e5\u5fd7\u8be6\u60c5")}))}return m({refresh:S}),(f,m)=>{const p=t("el-tab-pane"),C=t("el-tabs"),I=t("el-empty"),z=t("el-tag"),P=t("el-button"),D=t("el-card"),$=t("el-main"),N=t("el-footer"),q=t("el-container"),G=y("loading");return g((a(),r(q,null,{default:u((()=>[n(C,{modelValue:v(b),"onUpdate:modelValue":m[0]||(m[0]=e=>k(b)?b.value=e:b=e),type:"card",style:{width:"100%",padding:"0 15px 0 15px"},onTabClick:T},{default:u((()=>[n(p,{label:"\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1",name:"1"}),n(p,{label:"\u4efb\u52a1\u5386\u53f2\u5217\u8868",name:"2"})])),_:1},8,["modelValue"]),"1"==v(b)?(a(),r($,{key:0},{default:u((()=>[0==v(h).taskInfo.taskList.length?(a(),r(I,{key:0,"image-size":120},{default:u((()=>m[2]||(m[2]=[d("p",{style:{"font-size":"14px",color:"#999","line-height":"1.5",margin:"0 40px"}},"\u6ca1\u6709\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1",-1)]))),_:1})):o("",!0),(a(!0),l(i,null,s(v(h).taskInfo.taskList,(t=>(a(),r(D,{key:t.id,shadow:"hover",class:"tasks-item"},{default:u((()=>[d("div",re,[d("div",ue,[d("div",de,[d("h2",null,c(t.name),1),d("p",null," \u521b\u5efa\u65f6\u95f4\uff1a"+c(t.create_at),1)]),d("div",ce,[d("div",fe,[0==t.status?(a(),r(z,{key:0,type:"info"},{default:u((()=>m[3]||(m[3]=[_("\u7b49\u5f85\u4e2d")]))),_:1})):o("",!0),1==t.status?(a(),r(z,{key:1,type:"primary"},{default:u((()=>m[4]||(m[4]=[_("\u6267\u884c\u4e2d")]))),_:1})):o("",!0),2==t.status?(a(),r(z,{key:2,type:"danger"},{default:u((()=>m[5]||(m[5]=[_("\u5df2\u5931\u8d25")]))),_:1})):o("",!0),3==t.status?(a(),r(z,{key:3},{default:u((()=>m[6]||(m[6]=[_("\u5df2\u5b8c\u6210")]))),_:1})):o("",!0)]),d("div",me,[n(P,{plain:"",type:"danger",icon:"delete",onClick:a=>function(t){return e(this,null,(function*(){O.confirm(`\u786e\u5b9a\u8981\u5220\u9664\u3010${t.name}\u3011\u4efb\u52a1\u5417\uff1f`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((e=>{h.loadingInfo.isLoading=!0,h.loadingInfo.content="\u6b63\u5728\u5220\u9664\u4e2d...";let a={action:"del_task",id:t.id};H.sysTaskcenterMg(a).then((e=>{h.loadingInfo.isLoading=!1,h.loadingInfo.content="",2e3==e.code?(F.success(e.msg),"1"==b.value?V():M()):F.warning(e.msg)}))})).catch((()=>{}))}))}(t)},{default:u((()=>m[7]||(m[7]=[_("\u5220\u9664\u4efb\u52a1")]))),_:2},1032,["onClick"]),n(P,{plain:"",type:"primary",icon:"Document",onClick:e=>E(t)},{default:u((()=>m[8]||(m[8]=[_("\u67e5\u770b\u65e5\u5fd7")]))),_:2},1032,["onClick"])])])])])])),_:2},1024)))),128))])),_:1})):o("",!0),"1"==v(b)?(a(),r(N,{key:1,style:{padding:"10px","text-align":"left"}},{default:u((()=>[n(P,{circle:"",icon:"refresh",onClick:S})])),_:1})):o("",!0),"2"==v(b)?(a(),r($,{key:2},{default:u((()=>[0==v(x).length?(a(),r(I,{key:0,"image-size":120},{default:u((()=>m[9]||(m[9]=[d("p",{style:{"font-size":"14px",color:"#999","line-height":"1.5",margin:"0 40px"}},"\u6ca1\u6709\u5386\u53f2\u4efb\u52a1",-1)]))),_:1})):o("",!0),(a(!0),l(i,null,s(v(x),(e=>(a(),r(D,{key:e.id,shadow:"hover",class:"tasks-item"},{default:u((()=>[d("div",pe,[d("div",he,[d("div",ye,[d("h2",null,c(e.name),1),d("p",null,[_(" \u521b\u5efa\u65f6\u95f4\uff1a"+c(e.create_at)+" ",1),d("span",ge,"\u8017\u65f6\uff1a"+c(v(U)(e.duration)),1)])]),d("div",ve,[d("div",ke,[0==e.status?(a(),r(z,{key:0,type:"info"},{default:u((()=>m[10]||(m[10]=[_("\u7b49\u5f85\u4e2d")]))),_:1})):o("",!0),1==e.status?(a(),r(z,{key:1,type:"primary"},{default:u((()=>m[11]||(m[11]=[_("\u6267\u884c\u4e2d")]))),_:1})):o("",!0),2==e.status?(a(),r(z,{key:2,type:"danger"},{default:u((()=>m[12]||(m[12]=[_("\u5df2\u5931\u8d25")]))),_:1})):o("",!0),3==e.status?(a(),r(z,{key:3,type:"success"},{default:u((()=>m[13]||(m[13]=[_("\u5df2\u5b8c\u6210")]))),_:1})):o("",!0)]),d("div",_e,[n(P,{plain:"",type:"primary",icon:"Document",onClick:t=>E(e)},{default:u((()=>m[14]||(m[14]=[_("\u67e5\u770b\u65e5\u5fd7")]))),_:2},1032,["onClick"]),n(P,{plain:"",icon:"Download",onClick:t=>{A(e.log_path)}},{default:u((()=>m[15]||(m[15]=[_("\u4e0b\u8f7d")]))),_:2},1032,["onClick"])])])])])])),_:2},1024)))),128))])),_:1})):o("",!0),"2"==v(b)?(a(),r(N,{key:3,style:{padding:"10px","text-align":"left"}},{default:u((()=>[n(Y,{small:!0,"child-msg":v(L),onCallFather:j,border:!1},null,8,["child-msg"])])),_:1})):o("",!0),v(B)?(a(),r(W,{key:4,ref_key:"moduleinstallLogFlag",ref:R,onClosed:m[1]||(m[1]=e=>k(B)?B.value=!1:B=!1),onRefreshData:S},null,512)):o("",!0)])),_:1})),[[G,v(w)]])}}},[["__scopeId","data-v-86efa96d"]]),Ce=N({__name:"lysettings",setup(e){const l=S();let o=p(["#008040","#536dfe","#722ed1","#009688","#52c41a","#faad14","#ff5c93","#c62f2f","#fd726d"]),i=p(["#272E39","#3C444D","#465161","#222b45","#2c3643","#545c64","#009688","#52c41a","#faad14","#ff5c93"]),s=p(["#fff","#3C444D","#465161","#222b45","#2c3643","#545c64","#009688","#52c41a","#faad14","#ff5c93"]),d=p(l.colorPrimary||"#409EFF");function c(){l.setColorPrimary(d.value)}p(l.pagingLayout),p("light"!=l.siteTheme),p(l.language),p(l.programLayout);let f=p(l.elementSize);function m(e){l.setElementSize(e)}let h=p(l.menuHeaderColor01);function y(e){l.setMenuHeaderColor01(e)}let g=p(l.menuHeaderColor02);function _(e){l.setMenuHeaderColor02(e)}let b=p(l.menuWidth);function C(e){l.setMenuWidth(e)}return(e,l)=>{const p=t("el-divider"),w=t("el-color-picker"),x=t("el-form-item"),I=t("el-input-number"),L=t("el-option"),j=t("el-select"),M=t("el-form");return a(),r(M,{ref:"form","label-width":"120px","label-position":"left",style:{padding:"0 20px"}},{default:u((()=>[n(p),n(x,{label:"\u4e3b\u9898\u989c\u8272"},{default:u((()=>[n(w,{modelValue:v(d),"onUpdate:modelValue":l[0]||(l[0]=e=>k(d)?d.value=e:d=e),predefine:v(o),onChange:c},null,8,["modelValue","predefine"])])),_:1}),n(x,{label:"\u5934\u90e8\u989c\u8272"},{default:u((()=>[n(w,{modelValue:v(h),"onUpdate:modelValue":l[1]||(l[1]=e=>k(h)?h.value=e:h=e),predefine:v(i),onChange:y},null,8,["modelValue","predefine"])])),_:1}),n(x,{label:"\u83dc\u5355\u989c\u8272"},{default:u((()=>[n(w,{modelValue:v(g),"onUpdate:modelValue":l[2]||(l[2]=e=>k(g)?g.value=e:g=e),predefine:v(s),onChange:_},null,8,["modelValue","predefine"])])),_:1}),n(x,{label:"\u83dc\u5355\u5bbd\u5ea6(px)"},{default:u((()=>[n(I,{modelValue:v(b),"onUpdate:modelValue":l[3]||(l[3]=e=>k(b)?b.value=e:b=e),onChange:C,style:{width:"100%"}},null,8,["modelValue"])])),_:1}),n(p),n(x,{label:"\u7ec4\u4ef6\u5927\u5c0f"},{default:u((()=>[n(j,{modelValue:v(f),"onUpdate:modelValue":l[4]||(l[4]=e=>k(f)?f.value=e:f=e),placeholder:"\u8bf7\u9009\u62e9",onChange:m},{default:u((()=>[n(L,{label:"\u9ed8\u8ba4",value:"default"}),n(L,{label:"\u5c0f",value:"small"}),n(L,{label:"\u5927",value:"large"})])),_:1},8,["modelValue"])])),_:1}),n(p)])),_:1},512)}}},[["__scopeId","data-v-613f3064"]]),we={class:"user-bar"},xe={class:"user-avatar"},Ie=N({__name:"userbar",setup(e){const s=$(),f=S(),m=z();let y=p(!1),g=p(!1),b=p(!1),w=p(!1);p(!1),p([]);let x=p(!1),I=p(null),L=p(null);function j(){w.value=!0,C((()=>{L.value.refresh()}))}function M(){if("light"==f.siteTheme)f.setSiteTheme("dark");else{f.setSiteTheme("light");const e=f.menuHeaderColor01,t=f.menuHeaderColor02;f.setMenuHeaderColor01(e),f.setMenuHeaderColor02(t)}}function T(){b.value=!0}function V(e){"clearCache"==e||("updateLogs"==e?window.open("https://ruyi.lybbn.cn/doc/ruyi/update.html"):"checkUpdate"==e?(m.loadingInfo.isLoading=!0,m.loadingInfo.content="\u83b7\u53d6\u4e2d...",H.sysGetSysUpdate().then((e=>{m.loadingInfo.isLoading=!1,m.loadingInfo.content="",2e3==e.code?function(e){if(e.can_update){let t=`<div style="font-size:15px;">\u53d1\u73b0\u65b0\u7248\u672c<span style="color:red;">\u3010${e.n_ver}\u3011</span>,\u662f\u5426\u786e\u5b9a\u66f4\u65b0\uff1f<br/><a target="_blank" href="https://ruyi.lybbn.cn/doc/ruyi/update.html" style="color:#008040">\u67e5\u770b\u66f4\u65b0\u65e5\u5fd7</a><div>`;O({title:"\u66f4\u65b0\u63d0\u793a",message:t,dangerouslyUseHTMLString:!0,showCancelButton:!0,confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88",type:"warning",icon:"Download",customClass:"ruyiMessageBoxClass",beforeClose:(e,t,a)=>{"confirm"===e&&function(e="update"){m.loadingInfo.isLoading=!0,m.loadingInfo.content="\u66f4\u65b0\u4e2d...",H.sysStartSysUpdate({action:e}).then((e=>{m.loadingInfo.isLoading=!1,m.loadingInfo.content="",2e3==e.code?(x.value=!0,C((()=>{I.value.onlyRestartPanel()}))):F.warning(e.msg)}))}("update"),a()}}).then((e=>{})).catch((()=>{}))}else F.success("\u5f53\u524d\u5df2\u662f\u6700\u65b0\u7248\u672c")}(e.data):F.warning(e.msg)}))):"fixPanel"==e||"outLogin"==e&&O.confirm("\u9000\u51fa\u767b\u5f55, \u662f\u5426\u7ee7\u7eed?","\u63d0\u793a",{confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88",type:"warning"}).then((()=>{E.clear(),s.push("/login"),F.success("\u5df2\u9000\u51fa\u767b\u5f55!")})).catch((()=>{})))}function B(){m.isProUserCheck()&&(y.value=!0)}return h((()=>{})),(e,s)=>{const p=t("Notification"),h=t("el-icon"),C=t("el-tooltip"),S=t("el-badge");t("ChatDotRound"),t("el-avatar"),t("el-empty"),t("el-scrollbar"),t("el-main"),t("el-button"),t("el-footer"),t("el-container");const R=t("el-drawer"),E=t("Sunny"),z=t("Moon"),H=t("SwitchButton"),U=t("ArrowDown"),A=t("Share"),P=t("el-dropdown-item"),D=t("StarFilled"),$=t("Tools"),N=t("CircleCloseFilled"),O=t("el-dropdown-menu"),F=t("el-dropdown"),W=t("el-dialog");return a(),l(i,null,[d("div",we,[d("div",{class:"tasks panel-item",onClick:j},[n(S,{hidden:0==v(m).taskInfo.taskNumber,value:v(m).taskInfo.taskNumber,class:"badge",type:"danger"},{default:u((()=>[n(C,{effect:"dark",content:"\u4efb\u52a1\u5217\u8868",placement:"bottom"},{default:u((()=>[n(h,null,{default:u((()=>[n(p)])),_:1})])),_:1})])),_:1},8,["hidden","value"])]),o("",!0),d("div",{class:"theme panel-item",onClick:M},["dark"==v(f).siteTheme?(a(),r(h,{key:0},{default:u((()=>[n(E)])),_:1})):(a(),r(h,{key:1},{default:u((()=>[n(z)])),_:1}))]),d("div",{class:"shutdown panel-item",onClick:T},[n(C,{effect:"dark",content:"\u91cd\u542f\uff1a\u5982\u610f\u9762\u677f\u6216\u670d\u52a1\u5668",placement:"bottom"},{default:u((()=>[n(h,null,{default:u((()=>[n(H)])),_:1})])),_:1})]),n(F,{class:"user panel-item",trigger:"click",onCommand:V},{dropdown:u((()=>[n(O,null,{default:u((()=>[n(P,{command:"updateLogs"},{default:u((()=>[n(h,null,{default:u((()=>[n(A)])),_:1}),s[8]||(s[8]=_("\u66f4\u65b0\u65e5\u5fd7"))])),_:1}),n(P,{command:"checkUpdate"},{default:u((()=>[n(h,null,{default:u((()=>[n(D)])),_:1}),s[9]||(s[9]=_("\u68c0\u67e5\u66f4\u65b0"))])),_:1}),n(P,{onClick:B},{default:u((()=>[n(h,null,{default:u((()=>[n($)])),_:1}),s[10]||(s[10]=_("\u5e03\u5c40\u8bbe\u7f6e")),n(h,{color:"#f7ba2a"},{default:u((()=>[n(D)])),_:1})])),_:1}),n(P,{divided:"",command:"outLogin"},{default:u((()=>[n(h,null,{default:u((()=>[n(N)])),_:1}),s[11]||(s[11]=_("\u9000\u51fa\u767b\u5f55"))])),_:1})])),_:1})])),default:u((()=>[d("div",xe,[s[7]||(s[7]=d("label",null,c("\u66f4\u591a"),-1)),n(h,{class:"el-icon--right"},{default:u((()=>[n(U)])),_:1})])])),_:1})]),n(W,{modelValue:v(g),"onUpdate:modelValue":s[2]||(s[2]=e=>k(g)?g.value=e:g=e),width:700,title:"\u641c\u7d22",center:"","destroy-on-close":""},{default:u((()=>[n(oe,{onSuccess:s[1]||(s[1]=e=>k(g)?g.value=!1:g=!1)})])),_:1},8,["modelValue"]),n(W,{modelValue:v(b),"onUpdate:modelValue":s[3]||(s[3]=e=>k(b)?b.value=e:b=e),width:300,title:"\u91cd\u542f\u670d\u52a1\u5668\u6216\u9762\u677f","destroy-on-close":""},{default:u((()=>[n(se)])),_:1},8,["modelValue"]),v(x)?(a(),r(se,{key:0,ref_key:"onlyShudownRef",ref:I},null,512)):o("",!0),n(R,{modelValue:v(w),"onUpdate:modelValue":s[4]||(s[4]=e=>k(w)?w.value=e:w=e),size:"50%","append-to-body":"",title:"\u4efb\u52a1\u4e2d\u5fc3","destroy-on-close":"",class:"lytask-drawer"},{default:u((()=>[n(be,{ref_key:"taskref",ref:L},null,512)])),_:1},8,["modelValue"]),n(R,{title:"\u5e03\u5c40\u8bbe\u7f6e",modelValue:v(y),"onUpdate:modelValue":s[5]||(s[5]=e=>k(y)?y.value=e:y=e),size:400,"append-to-body":"","destroy-on-close":""},{default:u((()=>[n(Ce)])),_:1},8,["modelValue"])],64)}}},[["__scopeId","data-v-0db9f591"]]),Le=q("iframeList",{state:()=>({iframeList:[]}),actions:{setIframeList(e){this.iframeList=[],this.iframeList.push(e)},pushIframeList(e){this.iframeList.find((t=>t.path===e.path))||this.iframeList.push(e)},removeIframeList(e){this.iframeList.forEach(((t,a)=>{t.path===e.path&&this.iframeList.splice(a,1)}))},refreshIframe(e){this.iframeList.forEach((t=>{if(t.path==e.path){var a=e.meta.url;t.meta.url="",setTimeout((function(){t.meta.url=a}),200)}}))},clearIframeList(){this.iframeList=[]}}}),je={class:"iframe-pages"},Me=["src"],Te=N({__name:"iframeView",setup(e){const t=S(),n=Le(),o=D();w((()=>o),(e=>{c(e)}));const r=x((()=>n.iframeList)),u=x((()=>t.ismobile)),d=x((()=>t.ismultitabs));function c(e){"iframe"==e.meta.type?u.value||!d.value?n.setIframeList(e):n.pushIframeList(e):u.value&&n.clearIframeList()}return h((()=>{c(o)})),(e,t)=>g((a(),l("div",je,[(a(!0),l(i,null,s(r.value,(t=>g((a(),l("iframe",{key:t.meta.url,src:t.meta.url,frameborder:"0"},null,8,Me)),[[b,e.$route.meta.url==t.meta.url]]))),128))],512)),[[b,"iframe"==e.$route.meta.type]])}},[["__scopeId","data-v-5d23cb55"]]),Ve=q("keepAlive",{state:()=>({routeShow:!0,keepAliveRoute:[]}),getters:{},actions:{setKeepAliveRoute(e){this.keepAliveRoute=e,E.set("keepAliveRoute",e)},setRouteShow(e){this.routeShow=e,E.set("routeShow",e)}}}),Se={emits:["confirm","cancel"],props:{hidden:!0,title:String,width:{type:Number,default:880},height:{type:Number,default:500},showHeader:{type:Boolean,default:!0},showHeaderBg:{type:Boolean,default:!0},hideFooter:{type:Boolean,default:!0},showFooterBg:{type:Boolean,default:!0},showConfrim:{type:Boolean,default:!0},showCancel:{type:Boolean,default:!0},confirmText:{type:String,default:"\u786e\u5b9a"},cancelText:{type:String,default:"\u53d6\u6d88"},buttonReverse:{type:Boolean,default:!1},borderRadius:!1,showCloseBtn:{type:Boolean,default:!0}},data:()=>({willclose:!1}),methods:{closeDialog(){this.willclose=!0,setTimeout((()=>{this.willclose=!1,this.$emit("close")}),100)}}},Be={key:0,class:"lydialog-wrapper"},Re={class:"title"};const Ee=N(Se,[["render",function(e,i,s,r,f,m){const p=t("Close"),h=t("el-icon");return s.hidden?o("",!0):(a(),l("div",Be,[d("div",{class:I(["dialog-wrap",{radius:s.borderRadius},{willclose:f.willclose},{goup:s.buttonReverse}]),style:L({width:s.width+"px"})},[s.showHeader?(a(),l("div",{key:0,class:I(["box-header",{hidden:!s.showHeaderBg}])},[d("div",Re,c(s.title),1),s.showCloseBtn?(a(),l("div",{key:0,class:"btn-close",onClick:i[0]||(i[0]=(...e)=>m.closeDialog&&m.closeDialog(...e))},[n(h,{class:"icon"},{default:u((()=>[n(p)])),_:1})])):o("",!0)],2)):o("",!0),d("div",{class:"box-body",style:L({height:s.height+"px"})},[j(e.$slots,"default")],4),s.hideFooter?o("",!0):(a(),l("div",{key:1,class:I(["box-footer",{hidden:!s.showFooterBg},{reverse:s.buttonReverse}])},[s.showConfrim?(a(),l("button",{key:0,class:"btn btn-primary",onClick:i[1]||(i[1]=t=>e.$emit("confirm"))},c(s.confirmText),1)):o("",!0),s.showCancel?(a(),l("button",{key:1,class:"btn btn-gray",onClick:i[2]||(i[2]=t=>e.$emit("cancel"))},c(s.cancelText),1)):o("",!0)],2))],6)]))}]]),ze={key:0,class:"lyloading-content"},He={key:1,class:"lyloading-restart"},Ue={style:{"margin-bottom":"5px","font-size":"14px"}},Ae=N({__name:"lyloading",props:{isLoading:{type:Boolean,default:!0},width:{type:Number,default:300},height:{type:Number,default:200},content:{type:String,default:""},restartMode:{type:Boolean,default:!1},delay:{type:Number,default:6}},emits:["closed"],setup(e,{emit:o}){const i=o,s=e;let f=x((()=>{let e=s.delay-k.value;return e>=0?e:0})),m=x((()=>{let e=k.value>10?10:k.value;return".".repeat(e)}));function y(){i("closed")}let g=p(0),k=p(0),b=p(null);return w((()=>s.restartMode),((e,t)=>{e?(k.value=0,g.value=0,b.value&&clearInterval(b.value),b.value=setInterval((()=>{k.value<=s.delay?(k.value++,g.value+=parseInt(100/s.delay),g.value>100&&(g.value=100)):clearInterval(b.value)}),1e3)):b.value&&clearInterval(b.value)})),h((()=>{})),M((()=>{clearInterval(b.value)})),(o,i)=>{const s=t("Loading"),p=t("el-icon"),h=t("el-text"),k=t("el-progress");return a(),r(Ee,{hidden:!e.isLoading,title:"",width:e.width,height:e.height,showHeader:!1,onClose:y},{default:u((()=>[e.restartMode?(a(),l("div",He,[d("div",Ue,"\u91cd\u542f\u4e2d("+c(v(f))+"s)"+c(v(m)),1),n(k,{percentage:v(g),"stroke-width":19,status:"success",striped:"","striped-flow":"",duration:2},null,8,["percentage"])])):(a(),l("div",ze,[n(p,{class:"is-loading"},{default:u((()=>[n(s)])),_:1}),n(h,{class:"ldcontent",truncated:""},{default:u((()=>[_(c(e.content),1)])),_:1})]))])),_:1},8,["hidden","width","height"])}}},[["__scopeId","data-v-a2f259bc"]]),Pe={class:"ruyi-panel-header"},De={class:"ruyi-panel-header-left"},$e={class:"logo-bar"},Ne={key:0,class:"ruyi-panel-header-center"},Oe={style:{"margin-left":"10px","margin-right":"10px",display:"flex","align-items":"center"}},Fe={style:{"padding-right":"8px"}},We={class:"ruyi-panel-header-right"},Ye={class:"ruyi-panel-wrapper"},qe={class:"ruyi-panel-side-scroll"},Ge={class:"ruyi-panel-body el-container"},Ke={class:"ruyi-panel-main",id:"ruyi-panel-main"},Qe=N({__name:"index",setup(e){const s=D(),f=$(),y=S(),w=Ve(),j=B(),E=z();E.getSystemConfig();let U=p([]),A=p(""),N=p(!1),F=p(!1),W=p(0),Y=p(0),q=x((()=>y.ismobile));x((()=>y.ismultitabs));let G=x((()=>y.isMenuCollapse));function K(e){const t=e.split(".");return 4===t.length?`${t[0]}.${"*".repeat(t[1].length)}.${"*".repeat(t[2].length)}.${t[3]}`:""}function J(){y.setMenuCollapsed(!G.value),setTimeout((()=>{window.dispatchEvent(new Event("resize"))}),1e3)}function Z(){document.getElementById("app").classList.remove("main-maximize")}function ee(e){var t=[];return e&&e.forEach((e=>{if(e.meta=e.meta?e.meta:{},e.meta.hidden||"button"==e.meta.type)return!1;"iframe"==e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&(e.children=ee(e.children)),t.push(e)})),t}function te(){C((()=>{A.value=s.path}))}function ae(){C((()=>{y.setIsmobile(document.body.clientWidth<992)}))}function le(){F.value=!1}let ne=p(null);function oe(e){ne.value&&!ne.value.contains(e.target)&&le()}let ie=p("");function se(){if(ie.value){let e=window.location.origin;window.open(e+"/#"+ie.value,"_blank")}le()}function re(){ie.value&&(s.path==ie.value?window.location.reload():f.push({path:ie.value})),le()}function ue(e,t){e.preventDefault(),e.stopPropagation(),ie.value=t,F.value=!0,W.value=e.clientX+1,Y.value=e.clientY+1,C((()=>{let t=document.getElementById("lyleftMenuContext");document.body.offsetWidth-e.clientX<t.offsetWidth&&(W.value=document.body.offsetWidth-t.offsetWidth-1,Y.value=e.clientY+1)}))}function de(e=""){return"pro"==e?"\u4e13\u4e1a\u7248":"enterprise"==e?"\u4f01\u4e1a\u7248":"\u514d\u8d39\u7248"}let ce=p({c_ver:E.sysConfig.sysVersion,can_update:!1,n_ver:""});function fe(){O.alert("\u8bf7\u70b9\u51fb\u53f3\u4e0a\u89d2->\u3010\u66f4\u591a\u3011->\u3010\u68c0\u67e5\u66f4\u65b0\u3011\uff01\uff01\uff01","\u63d0\u793a",{confirmButtonText:"\u786e\u5b9a",cancelButtonText:"\u53d6\u6d88",type:"warning"}).then((()=>{})).catch((()=>{}))}return h((()=>{ae(),window.addEventListener("resize",ae),U.value=ee(j.routesList),te(),E.getSystemTaskIngInfo(),f.afterEach(te),document.addEventListener("click",oe),E.getLicenseInfo(),H.sysGetSysUpdate().then((e=>{2e3==e.code&&(ce.value=e.data)}))})),M((()=>{window.removeEventListener("resize",ae),document.removeEventListener("click",oe)})),(e,s)=>{const f=t("el-badge"),p=t("el-menu"),h=t("el-scrollbar"),y=t("expand"),C=t("fold"),x=t("el-icon"),j=t("router-view"),M=t("CopyDocument"),S=t("Refresh"),B=t("Close");return a(),l(i,null,[d("header",Pe,[d("div",De,[d("div",$e,[s[1]||(s[1]=d("img",{class:"logo",src:R},null,-1)),d("span",{onClick:s[0]||(s[0]=e=>k(N)?N.value=!v(N):N=!v(N)),style:{cursor:"pointer"}},c(v(N)?K(v(E).serverInfo.serverIp):v(E).serverInfo.serverIp),1)])]),v(q)?o("",!0):(a(),l("div",Ne,[s[2]||(s[2]=d("a",{href:"https://ruyi.lybbn.cn/",target:"_blank"},"Copyright \xa9 lybbn",-1)),d("span",Oe,[_(c(de(v(E).licenseInfo.role))+"\uff1a ",1),v(ce).can_update?(a(),r(f,{key:0,"is-dot":"",style:{cursor:"pointer"},onClick:fe},{default:u((()=>[d("span",Fe,c(v(P).APP_VER),1)])),_:1})):(a(),l("span",{key:1,onClick:fe,style:{cursor:"pointer"}},c(v(P).APP_VER),1))]),v(E).licenseInfo.username?(a(),l("span",{key:0,style:L({background:"1"==v(E).licenseInfo.active_state?"green":"#484040",padding:"3px"})},"\u6388\u6743\uff1a"+c(v(E).licenseInfo.username),5)):o("",!0)])),d("div",We,[n(Ie)])]),d("section",Ye,[v(q)?o("",!0):(a(),l("div",{key:0,class:I(v(G)?"ruyi-panel-side isCollapse":"ruyi-panel-side")},[d("div",qe,[n(h,null,{default:u((()=>[n(p,{class:"rymenu","default-active":v(A),router:"",collapse:v(G),"unique-opened":!0,"collapse-transition":""},{default:u((()=>[n(Q,{navMenus:v(U),onContextmenuClick:ue},null,8,["navMenus"])])),_:1},8,["default-active","collapse"])])),_:1})]),d("div",{class:"ruyi-panel-side-bottom",onClick:J},[n(x,null,{default:u((()=>[v(G)?(a(),r(y,{key:0})):(a(),r(C,{key:1}))])),_:1})])],2)),v(q)?(a(),r(X,{key:1})):o("",!0),d("div",Ge,[d("div",Ke,[n(j,null,{default:u((({Component:e,route:t})=>[(a(),r(T,{include:v(w).keepAliveRoute},[v(w).routeShow?(a(),r(m(e),{key:t.path})):o("",!0)],1032,["include"]))])),_:1}),n(Te)])])]),n(V,{name:"el-zoom-in-top"},{default:u((()=>[g(d("ul",{style:L({left:v(W)+"px",top:v(Y)+"px"}),class:"contextmenu",id:"lyleftMenuContext",ref_key:"lyleftMenuContext",ref:ne},[d("li",{onClick:se},[n(x,null,{default:u((()=>[n(M)])),_:1}),s[3]||(s[3]=d("span",{class:"contextmenu-text"},"\u65b0\u6807\u7b7e\u6253\u5f00",-1))]),d("li",{onClick:re},[n(x,null,{default:u((()=>[n(S)])),_:1}),s[4]||(s[4]=d("span",{class:"contextmenu-text"},"\u5237\u65b0\u672c\u9875",-1))]),d("li",{onClick:le},[n(x,null,{default:u((()=>[n(B)])),_:1}),s[5]||(s[5]=d("span",{class:"contextmenu-text"},"\u53d6\u6d88\u64cd\u4f5c",-1))])],4),[[b,v(F)]])])),_:1}),d("div",{class:"main-maximize-exit",onClick:Z},[n(x,null,{default:u((()=>[n(B)])),_:1})]),n(Ae,{isLoading:v(E).loadingInfo.isLoading,content:v(E).loadingInfo.content,restartMode:v(E).loadingInfo.restartMode,width:300,height:100,delay:v(E).loadingInfo.delay},null,8,["isLoading","content","restartMode","delay"])],64)}}},[["__scopeId","data-v-80c4a904"]]);export{Qe as default};
