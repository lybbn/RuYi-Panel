import{_ as a,d as t,e,A as s}from"./index.FQhv3U_5.js";import{l as o}from"./index.CLtx-Eae.js";import{a as l,E as n}from"./element-plus.C3E-FvSa.js";import{r as i,h as d,ag as u,G as r,o as c,H as m,P as p,a as f,M as _,u as g,D as j,L as v,t as b}from"./@vue.CQt2tj-6.js";import"./axios.BhTbhqQQ.js";import"./crypto-js.BjUPrIIl.js";import"./@xterm.C7qPmoRH.js";import"./js-cookie.Ch5AnFJE.js";import"./vue-clipboard3.c61pm64N.js";import"./clipboard.BBhAuw9K.js";import"./pinia.CWB7oRTw.js";import"./@element-plus.CU4brdXH.js";import"./vue-router.BmPBvlxi.js";import"./nprogress.Dzr5m2b3.js";import"./pinia-plugin-persistedstate.DTf8V5gU.js";import"./destr.ZpApkS-1.js";import"./deep-pick-omit.DP_A4OSP.js";import"./lodash-es.CUM784Py.js";import"./@vueuse.7zPzjEtO.js";import"./@popperjs.DxP-MrnL.js";import"./@ctrl.D-8vaqgC.js";import"./dayjs.BpgH7LzR.js";import"./async-validator.BTKOuuO-.js";import"./memoize-one.Ds0C_khL.js";import"./normalize-wheel-es.BhHBPXsK.js";import"./@floating-ui.D1oRyyfp.js";import"./vue-codemirror.CkyLiK-7.js";import"./codemirror.Fbop2eii.js";import"./@codemirror.CIOe3mu6.js";import"./@lezer.CQ-BhAmV.js";import"./crelt.DSg10-ms.js";import"./@marijn.Df4efayV.js";import"./style-mod.Dj2YSJ7-.js";import"./w3c-keyname.f-y9tSbI.js";const y={class:"statusc"},h={class:"lyflex status"},I={class:"lyflex opbtn"},k=a({__name:"redis",props:{data:{type:Object}},emits:["refreshStatus"],setup(a,{emit:k}){const x=t(),C=k,w=a;let L=i({id:null,name:"",error_log:"",status:!1,loadstatus:{},conf:"",oldConf:""}),M=i("status");function S(a="stop"){let t="\u786e\u5b9a\u8981\u505c\u6b62\u5417\uff1f",e=!1,o="\u542f\u52a8\u6210\u529f";"stop"==a?(x.loadingInfo.content="\u6b63\u5728\u505c\u6b62\u4e2d...",e=!1,o="\u505c\u6b62\u6210\u529f"):"reload"==a?(x.loadingInfo.content="\u6b63\u5728\u91cd\u8f7d\u914d\u7f6e\u4e2d...",t="\u786e\u5b9a\u8981\u91cd\u8f7d\u914d\u7f6e\u5417\uff1f",e=!0,o="\u91cd\u8f7d\u914d\u7f6e\u6210\u529f"):"restart"==a&&(x.loadingInfo.content=L.value.status?"\u6b63\u5728\u91cd\u542f\u4e2d...":"\u6b63\u5728\u542f\u52a8\u4e2d...",t=L.value.status?"\u786e\u5b9a\u8981\u91cd\u542f\u5417\uff1f":"\u786e\u5b9a\u8981\u542f\u52a8\u5417\uff1f",e=!0,o=L.value.status?"\u91cd\u542f\u6210\u529f":"\u542f\u52a8\u6210\u529f"),l.confirm(`${t}`,"\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((t=>{x.loadingInfo.isLoading=!0,s.sysSoftManage({id:L.value.id,status:a,action:"status"}).then((a=>{x.loadingInfo.isLoading=!1,x.loadingInfo.content="",2e3==a.code?(n.success(o),L.value.status=e,C("refreshStatus",{id:L.value.id,status:e})):n.warning(a.msg)}))})).catch((()=>{}))}function F(a){"error_log"==a.props.name?(x.loadingInfo.isLoading=!0,x.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u9519\u8bef\u65e5\u5fd7...",s.sysSoftManage({id:L.value.id,action:"get_error_log"}).then((a=>{x.loadingInfo.isLoading=!1,x.loadingInfo.content="",2e3==a.code?L.value.error_log=a.data:n.warning(a.msg)}))):"loadstatus"===a.props.name?(x.loadingInfo.isLoading=!0,x.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u8d1f\u8f7d\u72b6\u6001...",s.sysSoftManage({id:L.value.id,action:"get_loadstatus"}).then((a=>{x.loadingInfo.isLoading=!1,x.loadingInfo.content="",L.value.loadstatus={},2e3==a.code?L.value.loadstatus=a.data:n.warning(a.msg)}))):"edit_conf"===a.props.name&&(x.loadingInfo.isLoading=!0,x.loadingInfo.content="\u6b63\u5728\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6...",s.sysSoftManage({id:L.value.id,action:"get_conf"}).then((a=>{x.loadingInfo.isLoading=!1,x.loadingInfo.content="",2e3==a.code?(L.value.conf=a.data,L.value.oldConf=a.data):n.warning(a.msg)})))}function T(){if(L.value.oldConf==L.value.conf)return void n.warning("\u914d\u7f6e\u6587\u4ef6\u672a\u53d8\u52a8\uff0c\u65e0\u9700\u4fdd\u5b58!!!");if(""==L.value.conf||null==L.value.conf)return void n.warning("\u914d\u7f6e\u6587\u4ef6\u9519\u8bef\uff0c\u8bf7\u68c0\u67e5\u914d\u7f6e");l.confirm("\u786e\u5b9a\u8981\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6\u5417\uff1f","\u8b66\u544a",{closeOnClickModal:!1,cancelButtonText:"\u53d6\u6d88",confirmButtonText:"\u786e\u5b9a",type:"warning"}).then((a=>{x.loadingInfo.isLoading=!0,x.loadingInfo.content="\u6b63\u5728\u4fdd\u5b58\u914d\u7f6e\u6587\u4ef6...",s.sysSoftManage({id:L.value.id,conf:L.value.conf,action:"save_conf"}).then((a=>{x.loadingInfo.isLoading=!1,x.loadingInfo.content="",2e3==a.code?n.success("\u4fdd\u5b58\u6210\u529f"):n.warning(a.msg)}))})).catch((()=>{}))}return d((()=>{L.value.id=w.data.id,L.value.name=w.data.name,L.value.status=w.data.status})),(a,t)=>{const s=u("CaretRight"),l=u("el-icon"),n=u("el-button"),i=u("el-tab-pane"),d=u("el-descriptions-item"),k=u("el-descriptions"),x=u("el-tabs");return c(),r(x,{"tab-position":"left",modelValue:g(M),"onUpdate:modelValue":t[3]||(t[3]=a=>b(M)?M.value=a:M=a),onTabClick:F},{default:m((()=>[p(i,{label:"\u670d\u52a1\u72b6\u6001",name:"status"},{default:m((()=>[f("div",y,[f("div",h,[f("div",null,"\u5f53\u524d\u72b6\u6001\uff1a"+_(g(L).status?"\u542f\u52a8":"\u505c\u6b62"),1),p(l,{class:j(g(L).status?"on":"off")},{default:m((()=>[p(s)])),_:1},8,["class"])]),f("div",I,[p(n,{onClick:t[0]||(t[0]=a=>S("restart"))},{default:m((()=>[v(_(g(L).status?"\u91cd\u542f":"\u542f\u52a8"),1)])),_:1}),p(n,{onClick:t[1]||(t[1]=a=>S("stop")),disabled:!g(L).status},{default:m((()=>t[4]||(t[4]=[v("\u505c\u6b62")]))),_:1},8,["disabled"])])])])),_:1}),p(i,{label:"\u914d\u7f6e\u4fee\u6539",name:"edit_conf"},{default:m((()=>[p(o,{modelValue:g(L).conf,"onUpdate:modelValue":t[2]||(t[2]=a=>g(L).conf=a),fontSize:"13px",placeholder:g(L).conf?"":"\u672a\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6",showLineNums:!0,lineWrapping:!0,mode:"properties",height:"60vh","read-only":!1,ref:"lyCodemirrorConf"},null,8,["modelValue","placeholder"]),p(n,{type:"primary",style:{"margin-top":"10px","margin-bottom":"10px"},onClick:T},{default:m((()=>t[5]||(t[5]=[v("\u4fdd\u5b58")]))),_:1}),t[6]||(t[6]=f("div",{class:"ry-cj-care"},[f("li",null,"\u82e5\u60a8\u4e0d\u4e86\u89e3Redis\u7684\u914d\u7f6e\u6587\u4ef6\u89c4\u5219\uff0c\u8bf7\u52ff\u968f\u610f\u4fee\u6539!!!"),f("li",null,"\u5feb\u6377\u952e CTRL+F \u67e5\u627e\u548c\u66ff\u6362\u5185\u5bb9")],-1))])),_:1}),p(i,{label:"\u8d1f\u8f7d\u72b6\u6001",name:"loadstatus"},{default:m((()=>[p(k,{border:!0,column:2},{default:m((()=>[p(d,{label:"\u89d2\u8272\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.role||""),1)])),_:1}),p(d,{label:"\u8fd0\u884c\u65f6\u95f4(\u5929)\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.uptime_in_days||0),1)])),_:1}),p(d,{label:"\u8fd0\u884c\u7aef\u53e3\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.tcp_port||""),1)])),_:1}),p(d,{label:"\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u6570\u91cf\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.connected_clients||0),1)])),_:1}),p(d,{label:"\u5df2\u4f7f\u7528\u5185\u5b58(used_memory)\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.used_memory_human||0),1)])),_:1}),p(d,{label:"\u5df2\u4f7f\u7528\u7269\u7406\u5185\u5b58(used_memory_rss)\uff1a"},{default:m((()=>[v(_(g(e)(g(L).loadstatus.used_memory_rss)||""),1)])),_:1}),p(d,{label:"\u5386\u53f2\u5206\u914d\u5185\u5b58\u7684\u5cf0\u503c\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.used_memory_peak_human||""),1)])),_:1}),p(d,{label:"\u5185\u5b58\u788e\u7247\u6bd4\u7387\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.mem_fragmentation_ratio||""),1)])),_:1}),p(d,{label:"\u4f7f\u7528CPU(used_cpu_sys)\uff1a"},{default:m((()=>[v(_(parseFloat(g(L).loadstatus.used_cpu_sys).toFixed(2)||"")+"s",1)])),_:1}),p(d,{label:"AOF\u662f\u5426\u5f00\u542f\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.aof_enabled||""),1)])),_:1}),p(d,{label:"\u67e5\u627e\u6570\u636e\u5e93\u952e\u6210\u529f\u7684\u6b21\u6570\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.keyspace_hits||0),1)])),_:1}),p(d,{label:"\u67e5\u627e\u6570\u636e\u5e93\u952e\u5931\u8d25\u7684\u6b21\u6570\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.keyspace_misses||0),1)])),_:1}),p(d,{label:"\u67e5\u627e\u6570\u636e\u5e93\u952e\u547d\u4e2d\u7387\uff1a"},{default:m((()=>[v(_(100*parseFloat(g(L).loadstatus.keyspace_hits/(g(L).loadstatus.keyspace_hits+g(L).loadstatus.keyspace_misses)).toFixed(4)||""),1)])),_:1}),p(d,{label:"\u81ea\u8fd0\u884c\u8fde\u63a5\u8fc7\u7684\u5ba2\u6237\u7aef\u7684\u603b\u6570\u91cf\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.total_connections_received||0),1)])),_:1}),p(d,{label:"\u81ea\u8fd0\u884c\u6267\u884c\u8fc7\u7684\u547d\u4ee4\u7684\u603b\u6570\u91cf\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.total_commands_processed||0),1)])),_:1}),p(d,{label:"\u670d\u52a1\u5668\u6bcf\u79d2\u949f\u6267\u884c\u7684\u547d\u4ee4\u6570\u91cf\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.instantaneous_ops_per_sec||0),1)])),_:1}),p(d,{label:"\u6700\u540e\u4e00\u6b21fork\u64cd\u4f5c\u8017\u8d39\u7684\u5fae\u79d2\u6570\uff1a"},{default:m((()=>[v(_(g(L).loadstatus.latest_fork_usec||0),1)])),_:1}),p(d,{label:"\u7f51\u7edc\u5165\u53e3/\u51fa\u53e3\uff1a"},{default:m((()=>[v(_((g(L).loadstatus.instantaneous_input_kbps||0)+"kps/"+(g(L).loadstatus.instantaneous_output_kbps||0)+"kps"),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}},[["__scopeId","data-v-df887137"]]);export{k as default};
